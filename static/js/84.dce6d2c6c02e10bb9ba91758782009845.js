webpackJsonp([84],{GnIS:function(e,t){},ZA77:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("fdz6"),i=a.n(s),o=a("HkQL"),l=a.n(o),r=a("vvmr"),n=a.n(r),c=a("NpYV"),d=a("UJbh"),m=a("Gwi0"),h=a("nVSy"),u={data:function(){return{activeCard:null,allLoaded:!1,isAutoFill:!1,offset:100,params:{pageNum:1,pageSize:10,hotelId:"",searchValue:""},info:[],price:"",num:"",digit:"",date:"",showCalendar:!1,showReceive:!1,message:"",memSet:[],result:[],memLevel:[],AllChecked:!1,isChecked:!1,selectedData:[],selectedData_ordertype:[],memName:"",memCondition:"",memDiscount:"",memDeposit:"",bbb:!1,value1:0,doble:[],ordertTypeAll:[]}},created:function(){this.$store.commit("setHeader","门店会员"),this.params.hotelId=this.$route.query.hotelId,this.activeCard=this.$store.state.hotelMemberNav,this.getMember()},methods:n()({},Object(h.b)(["HOTELMEMBERBERNAV"]),{onClick:function(e){this.activeCard=e,this.HOTELMEMBERBERNAV(e)},getMember:function(){var e=this;Object(m.r)(this.params).done(function(t){if(t.data=t.data.filter(function(e){return e.sysUser}),e.info=t.data,null==e.info||0==e.info.length)return e.isAutoFill=!0,void(e.allLoaded=!0);e.info.length<t.total?e.allLoaded=!1:e.info.length==t.total&&(e.allLoaded=!0)})},loadTop:function(){this.info=[],this.params.pageNum=1,this.getMember(),this.$refs.loadmore.onTopLoaded()},loadBottom:function(){this.params.pageNum+=1,this.loadMore()},loadMore:function(){var e=this;Object(m.r)(this.params).done(function(t){e.info=e.info.concat(t.data),e.info.length==t.total&&(e.allLoaded=!0)})},getDetails:function(e,t){this.$router.push({path:"/memberDetail",query:{memberDetail_info:e}}),localStorage.setItem("memberDetail_info",l()(e))},onConfirm:function(e){var t=i()(e,2),a=t[0],s=t[1];this.showCalendar=!1,this.date=this.formatDate(a)+" 至 "+this.formatDate(s)},formatDate:function(e){var t=e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate());return this.doble.push(t),this.startTime=this.doble[0],this.endTime=this.doble[1],e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},getBatchCoupons:function(){var e=this;Object(m.q)(this.params.hotelId).done(function(t){e.memLevel=t.data}),Object(d.a)({dictType:"business_order_type"}).done(function(t){e.ordertTypeAll=t.data})},chooseChange:function(e){this.selectedData.indexOf(e)>-1?this.removeByValue(this.selectedData,e):this.selectedData.push(e),this.hotelMemberLevelId=this.selectedData.toString()},removeByValue:function(e,t){for(var a=0;a<e.length;a++)if(e[a]==t){e.splice(a,1);break}},chooseChange_ordertype:function(e){this.selectedData_ordertype.indexOf(e)>-1?this.removeByValue(this.selectedData_ordertype,e):this.selectedData_ordertype.push(e),this.selectedData_ordertype.length<this.ordertTypeAll.total?this.AllChecked=!0:this.AllChecked=!1,this.orderType=this.selectedData_ordertype.toString()},release:function(){var e=this;return this.price?this.digit?this.startTime?this.hotelMemberLevelId?this.orderType?void c.MessageBox.confirm("",{message:"是否发劵？",title:"提示",cancelButtonText:"否",confirmButtonText:"是"}).then(function(t){if("confirm"==t){var a={couponSource:"2",hotelId:e.params.hotelId,couponAmount:e.price,fullAmount:e.digit,startTime:e.startTime,endTime:e.endTime,hotelMemberLevelIds:e.hotelMemberLevelId,orderType:e.orderType};Object(m._85)(a).done(function(e){Object(c.Toast)({message:e.msg,duration:900})}),e.price="",e.digit="",e.date="",e.getBatchCoupons(),e.selectedData_ordertype=[],e.selectedData=[]}}).catch(function(e){console.log(e)}):(Object(c.Toast)({message:"请选择使用范围",duration:900}),!1):(Object(c.Toast)({message:"请选择领取范围",duration:900}),!1):(Object(c.Toast)({message:"请输入可用日期",duration:900}),!1):(Object(c.Toast)({message:"请输入满多少金额可使用",duration:900}),!1):(Object(c.Toast)({message:"请输入面额",duration:900}),!1)},memberEdit:function(e){this.$router.push({path:"/memberSet",query:{memberSet_info:e}}),localStorage.setItem("memberSet_info",l()(e))},memberAdd:function(){this.$router.push({path:"/memberSet",query:{memberSet_info:""}}),localStorage.setItem("memberSet_info",l()(""))},memberAddAll:function(){var e=this;Object(m._28)(this.params.hotelId).done(function(t){e.getLevel()})},getLevel:function(){var e=this;Object(m.q)(this.params.hotelId).done(function(t){e.memSet=t.data})}}),computed:{searchValue:function(){return this.params.searchValue}},watch:{activeCard:function(e){0==e?(this.params.searchValue="",this.params.pageNum=1,this.getMember()):1==e?this.getBatchCoupons():this.getLevel()},searchValue:function(e,t){this.params.searchValue=e,this.getMember()}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"-border":"1px solid red","-margin-top":"20px",background:"#fff"}},[a("van-tabs",{attrs:{type:"card"},on:{click:e.onClick},model:{value:e.activeCard,callback:function(t){e.activeCard=t},expression:"activeCard"}},[a("van-tab",{attrs:{title:"会员列表"}},[a("van-search",{attrs:{placeholder:"搜索会员名称/手机号"},model:{value:e.params.searchValue,callback:function(t){e.$set(e.params,"searchValue",t)},expression:"params.searchValue"}}),e._v(" "),0!=e.info.length?a("div",{staticStyle:{position:"fixed",top:"175px",bottom:"0px",left:"0",right:"0","overflow-y":"scroll"},attrs:{id:"left_tab"}},[a("mt-loadmore",{ref:"loadmore",attrs:{"top-method":e.loadTop,"bottom-method":e.loadBottom,"bottom-all-loaded":e.allLoaded,autoFill:e.isAutoFill}},e._l(e.info,function(t,s){return a("div",{key:s},[t.sysUser?a("div",{staticClass:"members",on:{click:function(a){return e.getDetails(t)}}},[t.sysUser.headUrl?a("img",{attrs:{src:t.sysUser.headUrl,alt:""}}):a("img",{attrs:{src:"https://wx.qlogo.cn/mmopen/vi_32/9fcFhCxx3sxFwOtNJTsfkn2Us0pDbFv4f88ThciaCRHoSnTjHqXM35USNwv7LLBZliceVvMic8wx9lQkDNNfWEDqA/132",alt:""}}),e._v(" "),a("div",[a("p",{staticClass:"weight"},[a("span",[e._v(e._s(t.sysUser.nickName))]),e._v(" \n                    "),a("span",{staticStyle:{color:"#ff7d41"}},[e._v(e._s(t.hotelMemberLevel.memberLevelTemplate.levelName))]),e._v("\n                     \n                    "),a("span",[e._v("积分:"+e._s(t.integral?t.integral:""))])]),e._v(" "),a("p",{staticClass:"weight"},[e._v("手机号:"+e._s(t.sysUser.phone))]),e._v(" "),a("p",{staticClass:"c_a6"},[a("span",{staticClass:"w60"},[e._v("消费金额："+e._s(t.consumeAmount)+"元")]),e._v(" "),a("span",{},[e._v("入住间夜："+e._s(t.consumeNum?t.consumeNum:"0")+"次")])]),e._v(" "),a("p",{staticClass:"c_a6"},[a("span",{staticClass:"w60"},[e._v("最近入住："+e._s(t.lastRoomTime?t.lastRoomTime.substr(0,10):""))])])])]):e._e()])}),0)],1):a("div",{attrs:{id:"left_nothing"}},[e._v("暂无数据")])],1),e._v(" "),a("van-tab",{attrs:{title:"批量发劵"}},[a("div",{staticClass:"scroll_1"},[a("div",{attrs:{id:"send"}},[a("h4",[e._v("批量发劵")]),e._v(" "),a("van-field",{attrs:{type:"digit",label:"发送面额",placeholder:"请输入面额"},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}}),e._v(" "),a("van-field",{attrs:{type:"digit",label:"使用门槛",placeholder:"满多少金额可使用"},model:{value:e.digit,callback:function(t){e.digit=t},expression:"digit"}}),e._v(" "),a("van-field",{attrs:{clickable:"",name:"calendar",value:e.date,label:"可用时间",placeholder:"点击选择日期"},on:{click:function(t){e.showCalendar=!0}}}),e._v(" "),a("van-calendar",{attrs:{type:"range"},on:{confirm:e.onConfirm},model:{value:e.showCalendar,callback:function(t){e.showCalendar=t},expression:"showCalendar"}})],1),e._v(" "),a("div",{attrs:{id:"range"}},[a("div",{staticClass:"receive"},[a("label",[e._v("领取范围")]),e._v(" "),e.memLevel.length?a("ul",e._l(e.memLevel,function(t,s){return a("li",{key:s},[a("van-checkbox",{attrs:{value:t.memberLevelTemplate.levelName,"checked-color":"#ff7d41"},on:{click:function(a){return e.chooseChange(t.id)}},model:{value:t.isChecked,callback:function(a){e.$set(t,"isChecked",a)},expression:"item.isChecked"}},[e._v(e._s(t.memberLevelTemplate.levelName))])],1)}),0):e._e()]),e._v(" "),a("div")]),e._v(" "),a("div",{attrs:{id:"range"}},[a("div",{staticClass:"receive"},[a("label",[e._v("使用范围")]),e._v(" "),e.ordertTypeAll.length?a("ul",e._l(e.ordertTypeAll,function(t,s){return a("li",{key:s},[a("van-checkbox",{attrs:{value:t.dictLabel,"checked-color":"#ff7d41"},on:{click:function(a){return e.chooseChange_ordertype(t.dictValue)}},model:{value:t.isChecked,callback:function(a){e.$set(t,"isChecked",a)},expression:"item.isChecked"}},[e._v(e._s(t.dictLabel))])],1)}),0):e._e()])]),e._v(" "),a("div",{staticClass:"m16"},[a("van-button",{attrs:{block:"",color:"#FF7D41","native-type":"submit"},on:{click:e.release}},[e._v("确定发布")])],1)])]),e._v(" "),a("van-tab",{attrs:{title:"会员设置"}},[a("div",{attrs:{id:"send"}},[a("div",{staticClass:"scroll"},[e._l(e.memSet,function(t,s){return a("div",{key:s},[a("div",{staticClass:"memSet_box",style:{backgroundImage:"url("+t.memberLevelTemplate.domainName+t.memberLevelTemplate.bgUrl+")",backgroundRepeat:"no-repeat",backgroundSize:"100%"}},[a("div",{staticClass:"left"},[a("p",[e._v("\n                    "+e._s(t.memberLevelTemplate.levelName)+"\n                    "),0==t.thresholdDay?a("span",{staticClass:"c_a6 f7"},[e._v("无门槛领取")]):a("span",{staticClass:"c_a6 f7"},[e._v("消费满"+e._s(t.thresholdDay)+"间夜达标")])]),e._v(" "),10*Number(t.levelDiscount)!=10?a("p",{staticClass:"c_a6 f8"},[e._v("订房"+e._s(10*Number(t.levelDiscount))+"折")]):a("p",{staticClass:"c_a6 f8"},[e._v("无折扣")]),e._v(" "),a("p",{staticClass:"c_a6 f8"},[e._v(e._s(1==t.depositUnpay?"免押金":" "))])]),e._v(" "),a("div",{staticClass:"right",on:{click:function(a){return e.memberEdit(t)}}},[e._v("编辑")])])])}),e._v(" "),a("div",{staticClass:"m16"},[e.memSet.length?a("van-button",{attrs:{plain:"",color:"#000",block:"",type:"primary"},on:{click:e.memberAdd}},[e._v("新增等级")]):a("van-button",{attrs:{plain:"",color:"#000",block:"",type:"primary"},on:{click:e.memberAddAll}},[e._v("一键新增")])],1)],2)])])],1)],1)])},staticRenderFns:[]};var p=a("k6Sl")(u,v,!1,function(e){a("GnIS")},"data-v-69335b34",null);t.default=p.exports}});
//# sourceMappingURL=84.dce6d2c6c02e10bb9ba91758782009845.js.map