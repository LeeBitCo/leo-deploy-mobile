webpackJsonp([86],{Mm2m:function(e,t){},WEGW:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("NpYV"),s=o("s/fh"),r=(o("xtMQ"),o("Gwi0")),a=o("tN5p"),n=o("RmFe"),l=o.n(n),c={data:function(){return{info:"",lifeCostBills:[],cooperLifeCostBills:[],rentalBills:[],cooperRentalBills:[],deposit:"",depositReason:"",payCount:"",currenTime:l()().format("YYYY-MM-DD"),input_deposit:"",remainElecAmount:"",lifeStatus:[],result:"",newData:"",newOrder:""}},created:function(){this.$store.commit("setHeader","退租结算"),this.$route.query.cooperOrderRoomId?this.getCooperRentCount(this.$route.query.cooperOrderRoomId):(this.info=JSON.parse(localStorage.getItem("rentCount_info")),this.getRentCount())},watch:{input_deposit:function(e,t){e>this.deposit&&(Object(i.Toast)({message:"不能超过"+this.deposit+"元",duration:900}),this.input_deposit="")}},methods:{clearNoNum:function(e){(e=(e=(e=(e=(e=e.toString()).replace(/[^\d.]/g,"")).replace(/\.{2,}/g,".")).replace(".","$#$").replace(/\./g,"").replace("$#$",".")).replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")).indexOf(".")<0&&""!=e&&(e=parseFloat(e)),this.input_deposit=e},getRentCount:function(){var e=this;Object(r.N)(this.info.id).done(function(t){e.getDeal(t)})},getCooperRentCount:function(e){var t=this;Object(a.h)({cooperOrderRoomId:e}).done(function(e){t.getDeal(e)})},getDeal:function(e){this.newData=e.data,this.deposit=e.data.deposit,this.remainElecAmount=e.data.remainElecAmount,this.lifeCostBills=e.order.lifeCostBills,this.lifeCount=0;for(var t=0;t<this.lifeCostBills.length;t++)this.lifeCount+=this.lifeCostBills[t].totalPrice,this.lifeCostBills[t].set_round=t,this.lifeCostBills[t].set_length=this.lifeCostBills.length;if(this.newOrder=e.order,this.rentCount=0,this.$route.query.cooperOrderRoomId){this.cooperRentalBills=e.order.cooperRentalBills;for(t=0;t<this.cooperRentalBills.length;t++)0==this.cooperRentalBills[t].payStatus&&(this.rentCount+=this.cooperRentalBills[t].roomPrice)}else{this.rentalBills=e.order.rentalBills;for(t=0;t<this.rentalBills.length;t++)0==this.rentalBills[t].payStatus&&(this.rentCount+=this.rentalBills[t].roomPrice)}this.payCount=(this.lifeCount+this.rentCount).toFixed(2)},goLife:function(e,t,o){var i=this;if(this.$route.query.cooperOrderRoomId){if(null==o.waterPrice||null==o.elecPrice||null==o.gasPrice)return void s.a.confirm({message:"存在未设置价格，是否跳转设置"}).then(function(){i.$router.push({path:"/business-pay-set",query:{cooperLifeCostBillId:o.cooperLifeCostBillId}})}).catch(function(){});o.waterPrice>0&&null==o.preWaterDegree||o.elecPrice>0&&null==o.preElecDegree||o.gasPrice>0&&null==o.preGasDegree?s.a.confirm({message:"存在未设置初始读数，是否跳转设置"}).then(function(){i.$router.push({path:"/business-pay-set",query:{cooperLifeCostBillId:o.cooperLifeCostBillId}})}).catch(function(){}):(localStorage.removeItem("life_fee"),this.$router.push({path:"/lifeFeetrans",query:{lifeCostBillId:o.id,set_length:e,set_round:t}}))}else localStorage.removeItem("life_fee"),this.$router.push({path:"/lifeFeetrans",query:{lifeCostBillId:o.id,set_length:e,set_round:t}})},goRoom:function(e){this.$route.query.cooperOrderRoomId?this.$router.push({path:"/roomFeeD",query:{cooperRentalBillId:e.id}}):this.$router.push({path:"/roomFeeD",query:{rentalBillId:e.id}})},rent:function(){var e=this;i.MessageBox.confirm("",{message:"退租后剩余租房押金将退回给租客，请谨慎操作！",title:"确定退租？",cancelButtonText:"取消",confirmButtonText:"确定"}).then(function(t){if("confirm"==t)if(e.$route.query.cooperOrderRoomId){var o={orderRoomId:e.newData.id,orderId:e.newData.cooperOrderId,depositCut:e.input_deposit,depositCutReason:e.depositReason};Object(a.E)(o).done(function(e){Object(i.Toast)({message:e.msg,duration:900}),setTimeout("window.history.go(-1)",900)})}else{var s={orderRoomId:e.info.id,orderId:e.info.orderId,depositCut:e.input_deposit,depositCutReason:e.depositReason};Object(r._55)(s).done(function(e){Object(i.Toast)({message:e.msg,duration:900}),setTimeout("window.history.go(-1)",900)})}}).catch(function(e){console.log(e)})}}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.newData?i("section",{staticClass:"f16 c000"},[i("div",{staticClass:"all"},[i("p",[e._v("房间信息")]),e._v(" "),e.$route.query.cooperOrderRoomId?i("p",[e._v(e._s(e.newData.roomSn))]):i("p",[e._v(e._s(e.newData&&e.newData.roomScale.scaleName?e.newData.roomScale.scaleName:"")+"-"+e._s(e.newData.roomSn))])]),e._v(" "),i("div",{staticClass:"all"},[i("p",[e._v("合约到期")]),e._v(" "),e.$route.query.cooperOrderRoomId?i("p",[e._v(e._s(e._f("dataFilter")(e.newData.cooperOrder.endTime)))]):i("p",[e._v(e._s(e._f("dataFilter")(e.newData.order.endTime)))])]),e._v(" "),i("div",{staticClass:"all"},[i("p",[e._v("退租日期")]),e._v(" "),i("p",[e._v(e._s(e.currenTime))])]),e._v(" "),e.remainElecAmount?i("div",{staticClass:"all t10"},[i("p",[e._v("剩余电费")]),e._v(" "),i("p",[e._v(e._s(e.remainElecAmount))])]):e._e(),e._v(" "),e.payCount?i("div",{staticClass:"all t10"},[i("p",[e._v("未缴费账单")]),e._v(" "),i("div",{staticClass:"payCount"},[e._v(e._s(e.payCount))])]):e._e(),e._v(" "),i("div",{staticStyle:{"overflow-y":"scroll",height:"calc(100vh - 300px)"}},[e._l(e.$route.query.cooperOrderRoomId?e.cooperRentalBills:e.rentalBills,function(t){return i("div",{key:t.id,staticClass:"all"},[i("div",{staticClass:"noPay"},[i("p",{staticClass:"all",staticStyle:{width:"40%",padding:"0",border:"0"}},[i("span",[e._v(e._s(e._f("dataFilter")(t.startTime,"MM-DD"))+"至"+e._s(e._f("dataFilter")(t.endTime,"MM-DD")))]),e._v(" "),i("span",{staticClass:"money"},[e._v("租金")])]),e._v(" "),i("div",{staticClass:"right",on:{click:function(o){return e.goRoom(t)}}},[i("p",[e._v(e._s(t.roomPrice))]),e._v(" "),i("img",{staticClass:"img",attrs:{src:o("JfLI"),alt:""}})])])])}),e._v(" "),e._l(e.lifeCostBills,function(t,s){return i("div",{key:s,staticClass:"all"},[i("div",{staticClass:"noPay"},[i("p",{staticClass:"all",staticStyle:{width:"40%",padding:"0",border:"0"}},[i("span",[e._v(e._s(e._f("dataFilter")(t.startTime,"MM-DD"))+"至"+e._s(e._f("dataFilter")(t.endTime,"MM-DD")))]),e._v(" "),i("span",{staticClass:"life"},[e._v("生活")])]),e._v(" "),0==t.status?i("p",{staticClass:"cf00",on:{click:function(o){return e.goLife(e.lifeCostBills.length,s,t)}}},[e._v("去抄表")]):i("div",{staticClass:"right",on:{click:function(o){return e.goLife(e.lifeCostBills.length,s,t)}}},[i("p",[e._v(e._s(t.totalPrice))]),e._v(" "),i("img",{staticClass:"img",attrs:{src:o("JfLI"),alt:""}})])])])}),e._v(" "),e.deposit?i("div",{staticClass:"all t10"},[i("p",[e._v("\n        扣除押金\n        "),i("span",{staticClass:"c"},[e._v("(¥"+e._s(e.deposit)+")")])]),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.input_deposit,expression:"input_deposit"}],attrs:{type:"number",placeholder:"请输入扣押金额"},domProps:{value:e.input_deposit},on:{keyup:function(t){return e.clearNoNum(e.input_deposit)},input:function(t){t.target.composing||(e.input_deposit=t.target.value)}}}),i("span",[e._v("元")])]):e._e(),e._v(" "),e.deposit?i("div",{staticClass:"all"},[i("p",[e._v("扣除押金原因 ")]),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.depositReason,expression:"depositReason"}],attrs:{type:"text",placeholder:"请输入扣押金额原因"},domProps:{value:e.depositReason},on:{input:function(t){t.target.composing||(e.depositReason=t.target.value)}}})]):e._e()],2),e._v(" "),i("mt-button",{attrs:{type:"primary",id:"bg"},on:{click:e.rent}},[e._v("退租")])],1):e._e()},staticRenderFns:[]};var u=o("k6Sl")(c,d,!1,function(e){o("Mm2m")},"data-v-64e7e54a",null);t.default=u.exports}});
//# sourceMappingURL=86.a38545f26f434fd24bcc1758782009845.js.map