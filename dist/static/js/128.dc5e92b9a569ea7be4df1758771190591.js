webpackJsonp([128],{ImKE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("HkQL"),l=a.n(o),c=a("s/fh"),i=a("UJbh"),s=a("Gwi0"),n=a("hdnP"),r={data:function(){return{accountInfo:null,platStatus:{},type:null,aaa:"zzz",bbb:"123123123",value:null,leftScale:null,scaleFirst:"请选择基础房型",proFirst:"请选择产品房型",allName:null,leftItem:null,dataForm:{hotelId:null,plat:null,otaScaleCode:null,hotelOtaCode:null,hotelName:null,scaleName:null,roomScaleId:null,virtualRoomScaleId:null},scaleList:[],scaleAll:[],proAll:[],show_confirm:!1,show_add_left_Scale:!1,show_add_right_Scale:!1,show_scale:!1,show_pro:!1,show_left_scale:!1}},created:function(){this.$store.commit("setHeader",this.$route.query.otaSourceName+"房型关联"),this.getType()},methods:{getType:function(){var t=this;Object(i.a)({dictType:"business_ota_relation_status"}).done(function(e){e.data.map(function(e){return t.platStatus[e.dictValue]=e.dictLabel}),t.getLeft()})},reload:function(){var t=this,e={hotelId:this.$route.query.hotelId,otaPlat:this.$route.query.otaSource};Object(n.h)(e).done(function(e){t.getType()})},getLeft:function(){var t=this;Object(n.b)({hotelOtaRelationId:this.$route.query.hotelOtaRelationId}).done(function(e){t.accountInfo=e.data,t.dataForm.hotelId=t.accountInfo.hotelId,t.dataForm.plat=t.accountInfo.otaSource,t.dataForm.hotelOtaCode=t.accountInfo.hotelOtaCode,t.scaleList=e.order,t.scaleList.length>0?t.getRight(t.scaleList):t.getScale()})},getRight:function(t){var e=this,a={hotelId:this.accountInfo.hotelId,plat:this.accountInfo.otaSource};Object(n.a)(a).done(function(a){localStorage.setItem("ota_scaleList",l()(a.data)),t.map(function(t){t.child=[],a.data.map(function(e){e.virtualRoomScale.roomScalePlatRelationId=e.id,e.virtualRoomScale.basicScaleName=e.roomScale.scaleName,e.virtualRoomScale.virtualRoomScaleId=e.virtualRoomScaleId,t.scaleName==e.scaleName&&t.child.push(e.virtualRoomScale)})}),e.getScale()})},getScale:function(){var t=this;Object(s._9)(this.accountInfo.hotelId).done(function(e){t.scaleAll=e.data.map(function(t){return t.scaleName}),t.scaleOldAll=e.data})},getPro:function(t){var e=this,a={hotelId:this.accountInfo.hotelId,roomScaleId:t};Object(s._21)(a).done(function(t){e.proAll=t.data.map(function(t){return t.scaleName}),e.proOldAll=t.data,"请选择基础房型"==e.scaleFirst?e.proFirst="请选择产品房型":e.proOldAll.length>0?(e.proFirst=e.proOldAll[0].scaleName,e.dataForm.virtualRoomScaleId=e.proOldAll[0].id):(e.proFirst="请选择产品房型",Object(c.c)("暂无产品房型"))})},addLeft:function(t){this.add_or_edit_left=t,this.show_add_left_Scale=!0,this.leftScale=null},showUp:function(t){this.type=t,"zh"==this.type?this.value=this.accountInfo.otaUserName:"mm"==this.type?this.value=this.accountInfo.otaPassWord:"xcId"==this.type&&(this.value=this.accountInfo.hotelOtaCode),this.show_confirm=!0},confirm:function(t,e){var a=this;if("confirm"==t){var o={id:this.accountInfo.id};if(!this.value)return Object(c.c)("请输入"+("zh"==this.type?"账号":"mm"==this.type?"密码":"OTA酒店id")),void e(!1);"zh"==this.type?o.otaUserName=this.value:"mm"==this.type?o.otaPassWord=this.value:"xcId"==this.type&&(o.hotelOtaCode=this.value),this.show_confirm=!1,Object(n.i)(o).done(function(t){e(!1),a.show_confirm=!1,a.getType()})}else"cancel"==t&&(e(!1),this.show_confirm=!1)},confirmAddLeftScale:function(t,e){var a=this;if("confirm"==t){if(!this.leftScale)return Object(c.c)("请输入"+this.$route.query.otaSourceName+"房型名称"),void e(!1);if(e(!1),"add"==this.add_or_edit_left){var o={hotelId:this.accountInfo.hotelId,otaPlat:this.accountInfo.otaSource,scaleName:this.leftScale};Object(n.e)(o).done(function(t){Object(c.c)(t.msg),e(!1),a.show_add_left_Scale=!1,a.getType()})}else{var l={otaRoomScaleId:this.leftItem.id,scaleName:this.leftScale};Object(n.f)(l).done(function(t){e(!1),a.show_add_left_Scale=!1,a.getType()})}}else"cancel"==t&&(e(!1),this.show_add_left_Scale=!1)},openAll:function(t){this.allName=t.basicScaleName+"-"+t.scaleName,this.NoOpen()},NoOpen:function(){c.a.confirm({message:""+this.allName,showCancelButton:!1})},openScale:function(){0==this.scaleAll.length?Object(c.c)("暂无基础房型"):this.show_scale=!0},openPro:function(){"请选择基础房型"==this.scaleFirst?Object(c.c)("请先选择基础房型"):0==this.proAll.length?Object(c.c)("暂无产品房型"):this.show_pro=!0},openRight:function(t){this.scaleFirst="请选择基础房型",this.proFirst="请选择产品房型",this.dataForm.otaScaleCode=t.otaScaleCode,this.leftScale=t.scaleName,this.dataForm.scaleName=t.scaleName,this.show_add_right_Scale=!0},onConfirmScale:function(t){this.scaleFirst=t,this.dataForm.roomScaleId=this.scaleOldAll.find(function(e){return e.scaleName==t}).id,this.getPro(this.dataForm.roomScaleId),this.show_scale=!1},onConfirmPro:function(t){this.proFirst=t,this.dataForm.virtualRoomScaleId=this.proOldAll.find(function(e){return e.scaleName==t}).id,this.show_pro=!1},confirmAddRightScale:function(t,e){var a=this;if("confirm"==t){if(0==this.scaleAll.length)return Object(c.c)("暂无基础房型"),void e(!1);if(this.scaleAll.length>0&&"请选择基础房型"==this.scaleFirst)return Object(c.c)("请先选择基础房型"),void e(!1);if(0==this.proAll.length)return Object(c.c)("暂无产品房型"),void e(!1);Object(n.l)(this.dataForm).done(function(t){e(!1),a.show_add_right_Scale=!1,a.getType()}).then(function(t){e(!1),a.show_add_right_Scale=!1})}else"cancel"==t&&(e(!1),this.show_add_right_Scale=!1)},openLeft:function(t){this.leftItem=t,this.show_left_scale=!0},onConfirmLeft:function(t,e){var a=this;this.show_left_scale=!1,"编辑"==t?(this.show_add_left_Scale=!0,this.add_or_edit_left="edit",this.leftScale=this.leftItem.scaleName):"房态房价"==t?this.$router.push({path:e,query:{sign:"ota",bookMonth:"5",pro_id:"20",scale_id:"2",virtualRoomScaleId:this.leftItem.child[0].virtualRoomScaleId,otaPlat:this.leftItem.otaPlat,scaleName:this.leftItem.scaleName,hotelId:this.$route.query.hotelId}}):c.a.confirm({title:"提示",message:"确认删除"+this.leftItem.scaleName+"?"}).then(function(){Object(n.g)({otaRoomScaleId:a.leftItem.id}).done(function(t){a.getType()})}).catch(function(){})},removeRight:function(t){var e=this;c.a.confirm({title:"确认删除?",message:t.basicScaleName+"-"+t.scaleName}).then(function(){Object(n.m)({roomScalePlatRelationId:t.roomScalePlatRelationId}).done(function(t){Object(c.c)(t.msg),e.getType()})}).catch(function(){})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"scroll"}},[t.accountInfo?a("div",{staticStyle:{margin:"10px 0"}},[a("van-cell",{attrs:{title:t.$route.query.otaSourceName+"账号","is-link":"",value:t.accountInfo.otaUserName,"title-style":"color:#89868A;","value-class":"c_000"},on:{click:function(e){return t.showUp("zh")}}}),t._v(" "),a("van-cell",{attrs:{title:"登陆密码","is-link":"",value:t.accountInfo.otaPassWord,"title-style":"color:#89868A;","value-class":"c_000"},on:{click:function(e){return t.showUp("mm")}}}),t._v(" "),"19"==t.$route.query.otaSource?a("van-cell",{attrs:{title:"OTA酒店id","is-link":"",value:t.accountInfo.hotelOtaCode,"title-style":"color:#89868A;","value-class":"c_000"},on:{click:function(e){return t.showUp("xcId")}}}):t._e(),t._v(" "),t.platStatus?a("van-cell",{attrs:{"value-class":"qwqwqw"},scopedSlots:t._u([{key:"title",fn:function(){return[a("div",[a("span",[t._v("对接状态")]),t._v(" "),"0"==t.accountInfo.status?a("span",{staticClass:"f12"},[t._v("(请联系小住客服人工处理)")]):t._e()]),t._v(" "),a("div",{staticClass:"c_ff"},[t._v(t._s(t.platStatus[t.accountInfo.status]))])]},proxy:!0}],null,!1,934199453)}):t._e()],1):t._e(),t._v(" "),a("div",[a("table",{staticClass:"table",attrs:{width:"100%",borderColor:"#cecece",cellSpacing:"0",align:"center",bgColor:"#ffffff",border:"1",cellpadding:"0","border-spacing":"0",id:"plice_table"}},[a("thead",[a("th",{staticClass:"aaa"},[t._v(t._s(t.$route.query.otaSourceName)+"房型名称\n          "),t.accountInfo&&t.accountInfo.hotelOtaCode?a("van-icon",{staticClass:"refresh rotate",attrs:{name:"replay",color:"#2E7BF7"},on:{click:t.reload}}):t._e()],1),t._v(" "),a("th",{staticClass:"bbb"},[t._v("预留本地房型名称")])]),t._v(" "),t._l(t.scaleList,function(e,o){return a("tbody",{key:o},[a("tr",[a("td",{staticStyle:{color:"#8A888B"}},[a("div",{staticClass:"td_left",on:{click:function(a){return t.openLeft(e)}}},[a("div",[t._v(t._s(e.scaleName))]),t._v(" "),a("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),a("td",[t._l(e.child,function(e,o){return a("div",{key:o,staticClass:"right_scale",on:{click:function(a){return t.openAll(e)}}},[a("div",{staticClass:"flex"},[a("div",{staticClass:"area"},[t._v(" "+t._s(o+1))]),t._v(" "),a("div",{staticClass:"center"},[t._v(t._s(e.basicScaleName)+"-"+t._s(e.scaleName))]),t._v(" "),a("van-icon",{attrs:{name:"cross"},on:{click:function(a){return a.stopPropagation(),t.removeRight(e)}}})],1)])}),t._v(" "),e.scaleName&&e.otaScaleCode&&e.child&&0==e.child.length||e.scaleName&&!e.otaScaleCode?a("div",{staticClass:"plus_style",on:{click:function(a){return t.openRight(e)}}},[a("van-icon",{staticStyle:{"vertical-align":"middle"},attrs:{name:"plus",color:"#999699"}})],1):t._e()],2)])])})],2)]),t._v(" "),a("van-dialog",{attrs:{"before-close":t.confirm,"show-cancel-button":""},model:{value:t.show_confirm,callback:function(e){t.show_confirm=e},expression:"show_confirm"}},[a("van-field",{attrs:{"title-style":"color:red;line-height:40px;",placeholder:"请输入"+("zh"==t.type?"账号":"密码")},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),a("van-dialog",{attrs:{"before-close":t.confirmAddLeftScale,"show-cancel-button":""},model:{value:t.show_add_left_Scale,callback:function(e){t.show_add_left_Scale=e},expression:"show_add_left_Scale"}},[a("van-field",{attrs:{placeholder:"请准确填写"+t.$route.query.otaSourceName+"房型名称"},model:{value:t.leftScale,callback:function(e){t.leftScale=e},expression:"leftScale"}})],1),t._v(" "),a("van-dialog",{attrs:{title:"关联房型","before-close":t.confirmAddRightScale,"show-cancel-button":""},model:{value:t.show_add_right_Scale,callback:function(e){t.show_add_right_Scale=e},expression:"show_add_right_Scale"}},[a("van-field",{attrs:{label:t.$route.query.otaSourceName+"房型",readonly:""},model:{value:t.leftScale,callback:function(e){t.leftScale=e},expression:"leftScale"}}),t._v(" "),a("van-field",{attrs:{label:"本地基础房型",readonly:"","right-icon":"arrow-down"},on:{click:t.openScale},model:{value:t.scaleFirst,callback:function(e){t.scaleFirst=e},expression:"scaleFirst"}}),t._v(" "),a("van-field",{attrs:{label:"产品房型",readonly:"","right-icon":"arrow-down"},on:{click:t.openPro},model:{value:t.proFirst,callback:function(e){t.proFirst=e},expression:"proFirst"}})],1),t._v(" "),a("van-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.show_scale,callback:function(e){t.show_scale=e},expression:"show_scale"}},[a("van-picker",{attrs:{title:"本地基础房型","show-toolbar":"",columns:t.scaleAll},on:{confirm:t.onConfirmScale,cancel:function(e){t.show_scale=!1}}})],1),t._v(" "),a("van-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.show_pro,callback:function(e){t.show_pro=e},expression:"show_pro"}},[a("van-picker",{attrs:{title:"产品房型","show-toolbar":"",columns:t.proAll},on:{confirm:t.onConfirmPro,cancel:function(e){t.show_pro=!1}}})],1),t._v(" "),a("van-popup",{staticClass:"common",attrs:{position:"bottom"},model:{value:t.show_left_scale,callback:function(e){t.show_left_scale=e},expression:"show_left_scale"}},[a("div",{staticClass:"border_bottom",on:{click:function(e){return t.onConfirmLeft("编辑")}}},[t._v("编辑")]),t._v(" "),"19"==t.$route.query.otaSource&&t.leftItem&&t.leftItem.otaScaleCode&&1==t.leftItem.child.length?a("div",{staticClass:"border_bottom",on:{click:function(e){return t.onConfirmLeft("房态房价","otaState-page")}}},[t._v("房态房价")]):t._e(),t._v(" "),a("div",{staticClass:"border_bottom",staticStyle:{color:"red"},on:{click:function(e){return t.onConfirmLeft("删除")}}},[t._v("删除")]),t._v(" "),a("div",{staticStyle:{height:"10px",background:"#F1EEF4"}}),t._v(" "),a("div",{staticClass:"border_bottom",on:{click:function(e){t.show_left_scale=!1}}},[t._v("取消")])])],1)},staticRenderFns:[]};var h=a("k6Sl")(r,d,!1,function(t){a("P9h7")},"data-v-25bf620c",null);e.default=h.exports},P9h7:function(t,e){}});
//# sourceMappingURL=128.dc5e92b9a569ea7be4df1758771190591.js.map