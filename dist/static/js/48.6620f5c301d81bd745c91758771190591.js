webpackJsonp([48],{gGpD:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("RmFe"),n=a.n(o),i=a("UJbh"),s=a("tN5p"),c=a("s/fh"),r={data:function(){return{listData:[],listLoading:!1,finishedList:!1,pullLoading:!1,dataForm:{hotelPayeeAccountId:this.$route.query.id,pageNum:0,pageSize:10,createTime:null},btnFormData:{hotelPayeeAccountId:this.$route.query.id,targetAccountId:null,accountAmount:null,remark:null},users:[],businessHotelPayeeRecordType:[],hotelPayeeRecordType_obj:{},myRadio:"1",minDate:null,maxDate:null,currentDate:null,d_createTime:null,typeTitle:null,patargetAccountLabel:null,show_time:!1,payeeAccount_show:!1,charge_refund_show:!1}},watch:{"btnFormData.accountAmount":{handler:function(){return"转出"==this.typeTitle&&this.btnFormData.accountAmount>this.$route.query.accountAmount?(Object(c.c)({message:"转出金额不大于"+this.$route.query.accountAmount,duration:900}),void(this.btnFormData.accountAmount=null)):"转入"==this.typeTitle&&this.btnFormData.accountAmount>this.c_accountAmount?(Object(c.c)({message:"转入金额不大于"+this.c_accountAmount,duration:900}),void(this.btnFormData.accountAmount=null)):void 0}}},created:function(){this.maxDate=new Date(n()()),this.minDate=new Date(n()().subtract(3,"year")),this.d_createTime=n()().format("YYYY年MM月"),this.currentDate=new Date(n()()),this.dataForm.createTime=n()().format("YYYY-MM"),this.$store.commit("setHeader",this.$route.query.accountName),this.getType()},methods:{getType:function(){var t=this;Object(s.q)({hotelId:this.$route.query.hotelId}).done(function(e){t.userOldAll=e.data,t.users=e.data.filter(function(e){return e.id!=t.$route.query.id}).map(function(t){return t.accountName}),Object(i.a)({dictType:"business_hotel_payee_record_type"}).done(function(e){t.hotelPayeeRecordType_obj={},t.businessHotelPayeeRecordType=e.data.map(function(e){t.hotelPayeeRecordType_obj[e.dictValue]=e.dictLabel})})})},formatter:function(t,e){return"year"==t?e+"年":"month"===t?e+"月":e},onConfirmTime:function(t){this.show_time=!1,this.currentDate=this.d_createTime=n()(t).format("YYYY年MM月"),this.dataForm.createTime=n()(t).format("YYYY-MM"),this.listData=[],this.dataForm.pageNum=0,this.onLoadList()},openShow:function(t){this.btnFormData.accountAmount=null,this.btnFormData.targetAccountId=null,this.patargetAccountLabel=null,this.typeTitle=t,"0"!=this.$route.query.accountAmount||"转出"!=this.typeTitle?this.charge_refund_show=!0:Object(c.c)({message:"当前账户余额不足",duration:1e3})},onConfirmUser:function(t){this.btnFormData.accountAmount=null,this.patargetAccountLabel=t,this.btnFormData.targetAccountId=this.userOldAll.find(function(e){return e.accountName==t}).id,this.c_accountAmount=this.userOldAll.find(function(e){return e.accountName==t}).accountAmount,this.payeeAccount_show=!1,"0"!=this.c_accountAmount||"转入"!=this.typeTitle||Object(c.c)({message:"转入账户余额不足，请重新选择",duration:1e3})},onPullRefresh:function(){this.listData=[],this.dataForm.pageNum=0,this.finishedList=!1},onLoadList:function(){var t=this;Object(s.s)(this.dataForm).done(function(e){t.listData=t.listData.concat(e.data),t.listLoading=t.pullLoading=!1,e.total==t.listData.length?t.finishedList=!0:e.total>t.listData.length&&(t.finishedList=!1)}),this.dataForm.pageNum++},myCommit:function(){var t=this,e=null;"转入"==this.typeTitle&&!this.btnFormData.targetAccountId||"转出"==this.typeTitle&&!this.btnFormData.targetAccountId?Object(c.c)("请选择"+this.typeTitle+"账户"):("调整"==this.typeTitle?(e=s.S,this.btnFormData.accountAmount="1"==this.myRadio?this.btnFormData.accountAmount:"-"+this.btnFormData.accountAmount,delete this.btnFormData.targetAccountId):"转入"==this.typeTitle?e=s.O:"转出"==this.typeTitle&&(e=s.P),this.btnFormData.accountAmount?e(this.btnFormData).done(function(e){t.$route.query.accountAmount=e.data.accountAmount,t.charge_refund_show=!1,Object(c.c)(e.msg),t.listData=[],t.dataForm.pageNum=0,t.onLoadList()}):Object(c.c)("请输入"+this.typeTitle+"金额"))},goNext:function(t){this.$router.push({path:"/payeeDetailPage",query:{billType:this.hotelPayeeRecordType_obj[t.billType],createTime:t.createTime,person:t.creator,amount:Number(t.amount),leftAmount:Number(t.leftAmount)}})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"black"},[t.$route.query.accountAmount>0?a("div",{staticClass:"f22"},[t._v(t._s(t._f("point")(t.$route.query.accountAmount,2)))]):a("div",{staticClass:"f22"},[t._v("0")]),t._v(" "),a("div",{staticClass:"m18"},[t._v("账户余额(元)")]),t._v(" "),a("div",{staticClass:"flex"},[a("div",{staticClass:"button",on:{click:function(e){return t.openShow("转入")}}},[t._v("转入")]),t._v(" "),a("div",{staticClass:"button",on:{click:function(e){return t.openShow("转出")}}},[t._v("转出")]),t._v(" "),a("div",{staticClass:"button",on:{click:function(e){return t.openShow("调整")}}},[t._v("调整")])])]),t._v(" "),a("div",{staticClass:"f16"},[t._v("账户明细")]),t._v(" "),a("div",{staticClass:"f16 time_flex",on:{click:function(e){t.show_time=!0}}},[t._v(t._s(t.d_createTime)+"\n    "),a("van-icon",{staticStyle:{"vertical-align":"middle"},attrs:{name:"arrow-down"}})],1),t._v(" "),t._m(0),t._v(" "),a("van-pull-refresh",{staticClass:"overflow",attrs:{"success-text":"刷新成功"},on:{refresh:t.onPullRefresh},model:{value:t.pullLoading,callback:function(e){t.pullLoading=e},expression:"pullLoading"}},[a("van-list",{attrs:{offset:30,finished:t.finishedList,"finished-text":"没有更多了"},on:{load:t.onLoadList},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},t._l(t.listData,function(e,o){return a("div",{key:o,staticClass:"data_box"},[a("div",{staticClass:"w1"},[t._v(t._s(t._f("dataFilter")(e.createTime,"MM-DD")))]),t._v(" "),t.hotelPayeeRecordType_obj?a("div",{staticClass:"w2"},[t._v(t._s(t.hotelPayeeRecordType_obj[e.billType]))]):t._e(),t._v(" "),a("div",{staticClass:"w3",class:e.amount>0?"bc6c":"ff5"},[t._v(t._s(e.amount>0?"+":"-")+"¥"+t._s(t._f("point")(Math.abs(e.amount))))]),t._v(" "),a("div",{staticClass:"w4"},[t._v(t._s(t._f("point")(e.leftAmount)))]),t._v(" "),a("div",{staticClass:"ff4",on:{click:function(a){return t.goNext(e)}}},[t._v("查看")])])}),0)],1),t._v(" "),a("van-popup",{staticStyle:{width:"100%"},attrs:{"close-on-click-overlay":!1,position:"bottom"},model:{value:t.show_time,callback:function(e){t.show_time=e},expression:"show_time"}},[a("van-datetime-picker",{attrs:{type:"year-month",title:"选择年月","min-date":t.minDate,"max-date":t.maxDate,formatter:t.formatter},on:{confirm:t.onConfirmTime,cancel:function(e){t.show_time=!1}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),t._v(" "),a("van-popup",{staticClass:"show-box",model:{value:t.charge_refund_show,callback:function(e){t.charge_refund_show=e},expression:"charge_refund_show"}},[a("div",{staticClass:"show-box-content"},[a("p",{staticClass:"fw"},[t._v(t._s(t.typeTitle)+"金额")]),t._v(" "),"调整"==t.typeTitle?a("div",{staticClass:"pay-room none"},[a("div",[t._v("调整方式")]),t._v(" "),a("van-radio-group",{attrs:{direction:"horizontal","checked-color":"#ff7d41"},model:{value:t.myRadio,callback:function(e){t.myRadio=e},expression:"myRadio"}},[a("van-radio",{attrs:{name:"1"}},[t._v("调增")]),t._v(" "),a("van-radio",{attrs:{name:"2"}},[t._v("调减")])],1)],1):t._e(),t._v(" "),"调整"!=t.typeTitle?a("div",{staticClass:"pay-room none"},[a("div",[t._v(t._s(t.typeTitle)+"账户")]),t._v(" "),a("div",{staticClass:"border display",on:{click:function(e){t.payeeAccount_show=!0}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.patargetAccountLabel,expression:"patargetAccountLabel"}],staticClass:"center",attrs:{readonly:"",placeholder:"请选择账户",type:"text"},domProps:{value:t.patargetAccountLabel},on:{input:function(e){e.target.composing||(t.patargetAccountLabel=e.target.value)}}}),t._v(" "),a("van-icon",{attrs:{name:"arrow-down"}})],1)]):t._e(),t._v(" "),a("div",{staticClass:"pay-room none"},[a("div",[t._v(t._s(t.typeTitle)+"金额")]),t._v(" "),a("div",{staticClass:"border display"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.btnFormData.accountAmount,expression:"btnFormData.accountAmount"}],staticClass:"center",attrs:{placeholder:"请输入金额",type:"text"},domProps:{value:t.btnFormData.accountAmount},on:{input:function(e){e.target.composing||t.$set(t.btnFormData,"accountAmount",e.target.value)}}})])]),t._v(" "),"调整"==t.typeTitle?a("div",{staticClass:"pay-room none"},[a("span",[t._v(t._s(t.typeTitle)+"原因")]),t._v(" "),a("div",{staticClass:"border display"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.btnFormData.remark,expression:"btnFormData.remark"}],staticClass:"center",attrs:{placeholder:"请输入原因",type:"text"},domProps:{value:t.btnFormData.remark},on:{input:function(e){e.target.composing||t.$set(t.btnFormData,"remark",e.target.value)}}})])]):t._e(),t._v(" "),a("van-button",{staticClass:"show-button",on:{click:t.myCommit}},[t._v("确定"+t._s(t.typeTitle))])],1)]),t._v(" "),a("van-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.payeeAccount_show,callback:function(e){t.payeeAccount_show=e},expression:"payeeAccount_show"}},[a("van-picker",{attrs:{"show-toolbar":"",columns:t.users},on:{confirm:t.onConfirmUser,cancel:function(e){t.payeeAccount_show=!1}}})],1)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"data_box",staticStyle:{background:"#fafafa"}},[a("div",{staticClass:"w1"},[t._v("日期")]),t._v(" "),a("div",{staticClass:"w2"},[t._v("项目")]),t._v(" "),a("div",{staticClass:"w3"},[t._v("收支金额")]),t._v(" "),a("div",{staticClass:"w4"},[t._v("账户结余")]),t._v(" "),a("div",[t._v("操作")])])}]};var l=a("k6Sl")(r,u,!1,function(t){a("hYqR")},"data-v-fa215b2a",null);e.default=l.exports},hYqR:function(t,e){}});
//# sourceMappingURL=48.6620f5c301d81bd745c91758771190591.js.map