webpackJsonp([62],{FrDI:function(e,t){},"kf+y":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("nfjU"),o=n.n(a),i=n("NpYV"),r=n("RmFe"),s=n.n(r),c=n("iClD"),u=n("UJbh"),l=n("Gwi0"),d=n("tN5p"),p={data:function(){var e;return e={currenInfo:"",startTime:"",endTime:"",finishTime:"",payment_label:"",paymentType:"",roomPrice:"",day:"",reason:"",room_fee:"",payStatus:"",payTime:"",minDate:null,maxDate:null,payForm:{payment:"",payeeAccountId:"",payTime:"",payeeAccountIdValue:""},showPayed:!1,timeShow:!1,payeeAccountIdValueShow:!1},o()(e,"minDate",new Date),o()(e,"currentDate",new Date),o()(e,"changeDate",new Date),o()(e,"payments",[]),o()(e,"users",[]),o()(e,"first_room",!1),o()(e,"is_businessPayOffline",!0),o()(e,"aaa",""),o()(e,"deleteRemarks",null),e},created:function(){this.$store.commit("setHeader","账单明细"),this.is_businessPayOffline=Object(c.isPermission)("business:pay:offline"),this.minDate=new Date(s()().subtract(6,"month")),this.maxDate=new Date(s()().add(6,"month")),this.$route.query.cooperRentalBillId?this.getCurrenCooperInfo(this.$route.query.cooperRentalBillId):(this.rentalBillId=this.$route.query.rentalBillId,this.first_room=localStorage.getItem("isFirst_room"),this.getCurrenInfo())},mounted:function(){this.timeFormat(new Date),1==this.currenInfo.payStatus&&(document.getElementById("inp_day").style.display="none")},methods:{getCurrenInfo:function(){var e=this;Object(l.U)(this.rentalBillId).done(function(t){e.currenInfo=t.data,e.getPayment()})},getCurrenCooperInfo:function(e){var t=this;Object(d.l)({cooperRentalBillId:e}).done(function(e){t.currenInfo=e.data,t.getPayment()})},getPayment:function(){var e=this;Object(u.a)({dictType:"business_payment_offline"}).done(function(t){e.paymentsAll=t.data,e.payments=t.data.map(function(e){return e.dictLabel})}),Object(u.a)({dictType:"business_payment"}).done(function(t){"1"==e.currenInfo.payStatus&&(e.payment_label=t.data.find(function(t){return t.dictValue==e.currenInfo.payment}).dictLabel)}),Object(u.a)({dictType:"business_payment_method"}).done(function(t){for(var n=0;n<t.data.length;n++)t.data[n].dictValue==e.currenInfo.paymentMethod&&(e.paymentType=t.data[n].dictLabel)}),Object(d.q)({hotelId:this.currenInfo.hotelId}).done(function(t){e.userAll=t.data.filter(function(e){return e.payment>="5"||e.account}),e.users=t.data.filter(function(e){return e.payment>="5"||e.account}).map(function(e){return e.accountName}),e.payForm.payeeAccountIdValue=e.users.length>0?null:"暂无"})},changeFn:function(){this.changeDate=this.currentDate},timeFormat:function(e){var t=e.getFullYear(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()<10?"0"+e.getDate():e.getDate();return this.setTime=t+"-"+n+"-"+a,t+"年"+n+"月"+a+"日"},keep:function(){var e={id:this.currenInfo.id,delayDay:this.diffday,delayReason:this.reason};Object(l._71)(e).done(function(e){Object(i.Toast)({message:e.msg,duration:900})})},goEdit:function(e){this.$router.push({path:"/add_bill",query:{title:"房租账单",startTime:e.startTime,endTime:e.endTime,rentalBillId:e.id,roomPrice:Number(e.roomPrice-e.deposit).toFixed(2),deposit:e.deposit,orderId:e.orderId,origin:e.origin}})},getCode:function(){this.$router.push({path:"/roomCode-page",query:{roomPrice:this.currenInfo.roomPrice,billSn:this.currenInfo.rentalBillSn,payStatus:this.currenInfo.payStatus}})},onConfirmTime:function(e){this.timeShow=!1,this.payForm.payTime=s()(e).format("YYYY-MM-DD")},onConfirm:function(e){this.payForm.payeeAccountIdValue=e+">",this.payForm.payeeAccountId=this.userAll.find(function(t){return t.accountName==e}).id,this.payeeAccountIdValueShow=!1},collPrice:function(e){0==e&&(this.showPayed=!0,this.payForm.payTime=s()().format("YYYY-MM-DD"))},confirmPayed:function(){var e=this;this.payForm.payeeAccountIdValue?(delete this.payForm.paymentValue,delete this.payForm.payeeAccountIdValue,Object(l._72)(this.currenInfo.id,this.payForm).done(function(t){e.showPayed=!1,Object(i.Toast)({message:t.msg,duration:900}),e.$route.query.cooperRentalBillId?e.getCurrenCooperInfo(e.$route.query.cooperRentalBillId):(e.rentalBillId=e.$route.query.rentalBillId,e.getCurrenInfo())})):Object(i.Toast)({message:"请选择收款账户",duration:900})}},watch:{}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"background-color":"#F6F6F6",position:"fixed",top:"50px",bottom:"0",left:"0",right:"0","font-size":"16px",color:"#000"}},[n("div",{staticClass:"box_1"},[n("div",{staticClass:"box_1_1"},[n("div",[e._v("账单状态")]),e._v(" "),n("div",{class:0==e.currenInfo.payStatus?"payS_r":"payS_g"},[e._v(e._s(0==e.currenInfo.payStatus?"未支付":"已支付"))])]),e._v(" "),n("div",{staticClass:"box_1_1"},[n("div",[e._v("缴费周期")]),e._v(" "),n("div",[e._v(e._s(e.currenInfo.startTime?e.currenInfo.startTime.substr(0,10):"")+" 至 "+e._s(e.currenInfo.endTime?e.currenInfo.endTime.substr(0,10):""))])])]),e._v(" "),e.currenInfo.roomPrice?n("div",{staticClass:"box_2",staticStyle:{margin:"10px 0 0 0"}},[n("div",[e._v("租金")]),e._v(" "),n("div",{staticClass:"day"},[e._v(e._s(Number(e.currenInfo.roomPrice-e.currenInfo.deposit).toFixed(2))+"元")])]):e._e(),e._v(" "),e.currenInfo.deposit?n("div",{staticClass:"box_2"},[n("div",[e._v("押金")]),e._v(" "),n("div",{staticClass:"day"},[e._v(e._s(Number(e.currenInfo.deposit).toFixed(2))+"元")])]):e._e(),e._v(" "),n("div",{staticClass:"box_1"},[e.currenInfo.payTime?n("div",{staticClass:"box_1_1"},[n("div",[e._v("到账时间")]),e._v(" "),n("div",[e._v(e._s(e.currenInfo.payTime))])]):e._e(),e._v(" "),1==e.currenInfo.payStatus?n("div",{staticClass:"box_1_1"},[n("div",[e._v("支付方式")]),e._v(" "),n("div",{staticClass:"day"},[e._v(e._s(e.payment_label))])]):e._e(),e._v(" "),e.currenInfo.payment>"5"&&e.currenInfo.payeeAccount?n("div",{staticClass:"box_1_1"},[n("div",[e._v("收款账户")]),e._v(" "),n("div",{staticClass:"day"},[e._v(e._s(e.currenInfo.payeeAccount))])]):e._e(),e._v(" "),"1"==e.currenInfo.payStatus&&"0"!=e.currenInfo.paymentMethod?n("div",{staticClass:"box_1_1"},[n("div",[e._v("支付类型")]),e._v(" "),n("div",{staticClass:"day"},[e._v(e._s(e.paymentType))])]):e._e()]),e._v(" "),n("div",{staticClass:"box_2 position"},[n("div",{staticClass:"leftTile"},[n("div",{staticClass:"price"},[n("span",{staticClass:"f12"},[e._v("费用总计")]),e._v(" "),n("br"),e._v(" "),n("span",{staticClass:"t_price"},[e._v("¥"+e._s(e.currenInfo.roomPrice?e.currenInfo.roomPrice.toFixed(2):"0"))])])]),e._v(" "),"0"==e.currenInfo.payStatus&&"true"==e.first_room?n("van-button",{staticClass:"button",staticStyle:{"border-color":"#989898",color:"#989898","margin-right":"8px",width:"20%"},on:{click:function(t){return e.goEdit(e.currenInfo)}}},[e._v("编辑")]):e._e(),e._v(" "),"0"==e.currenInfo.payStatus?n("van-button",{staticClass:"button code_s",attrs:{type:"primary"},on:{click:e.getCode}},[e._v("收款码")]):e._e(),e._v(" "),1==e.is_businessPayOffline?n("van-button",{staticClass:"button",class:"0"==e.currenInfo.payStatus?"payS_r":"payS_w",attrs:{type:"primary"},on:{click:function(t){return e.collPrice(e.currenInfo.payStatus)}}},[e._v(e._s("0"==e.currenInfo.payStatus?"线下收款":"已到账"))]):e._e()],1),e._v(" "),n("van-popup",{staticStyle:{width:"90%"},attrs:{round:"","bind:close":"onClose"},model:{value:e.showPayed,callback:function(t){e.showPayed=t},expression:"showPayed"}},[n("h3",[e._v("到账")]),e._v(" "),n("van-cell-group",[n("van-field",{attrs:{readonly:"",label:"到账日期",placeholder:"点击选择到账日期",rules:[{required:!0,message:"请选择到账日期"}]},on:{click:function(t){e.timeShow=!0}},model:{value:e.payForm.payTime,callback:function(t){e.$set(e.payForm,"payTime",t)},expression:"payForm.payTime"}}),e._v(" "),n("van-field",{attrs:{readonly:"",label:"收款账户",placeholder:"请选择收款账户"},on:{click:function(t){e.users.length>0&&(e.payeeAccountIdValueShow=!0)}},model:{value:e.payForm.payeeAccountIdValue,callback:function(t){e.$set(e.payForm,"payeeAccountIdValue",t)},expression:"payForm.payeeAccountIdValue"}}),e._v(" "),n("van-button",{staticClass:"payedColor",on:{click:e.confirmPayed}},[e._v("确定收款")])],1)],1),e._v(" "),n("van-calendar",{staticStyle:{width:"100%"},attrs:{"min-date":e.minDate,"max-date":e.maxDate},on:{close:function(t){e.timeShow=!1},confirm:e.onConfirmTime},model:{value:e.timeShow,callback:function(t){e.timeShow=t},expression:"timeShow"}}),e._v(" "),n("van-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:e.payeeAccountIdValueShow,callback:function(t){e.payeeAccountIdValueShow=t},expression:"payeeAccountIdValueShow"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:e.users},on:{confirm:e.onConfirm,cancel:function(t){e.payeeAccountIdValueShow=!1}}})],1)],1)},staticRenderFns:[]};var y=n("k6Sl")(p,m,!1,function(e){n("FrDI")},"data-v-a5e132e0",null);t.default=y.exports}});
//# sourceMappingURL=62.a145e31c63e7aa0193c71758771190591.js.map