webpackJsonp([99],{UDJ3:function(t,e){},"cw7/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("UJbh"),n=a("tN5p"),o=a("wWbh"),s=a("NpYV"),c=a("RmFe"),l=a.n(c),r={name:"index",data:function(){return{businessList:[],key:0,listArr:[],item:"",statu:!1,options:{},s:"",priceAll:{},refuseAll:{},selected:"1",contentKey:0,day:14,timecheckValue:null,currentMounth:null,outBill:null,reducePrice:null,payedTotelPrice:null,num:"1",showRoomPayed:!1,showPayed:!1,value:"0",actived:"0",topValue:["未收款账单","已收款账单"],payedAll:[],roomStyle:"circle",myAllCheckedStyle:"circle",myLookMoreStyle:"arrow",chooseMinDate:new Date(l()().subtract(2,"year")),chooseMaxDate:new Date(l()().subtract(1,"day").format("YYYY-MM-DD")),c_date:null,roomPrice:0,timeShow:!1,payeeAccountIdValueShow:!1,show_date:!1,paymentShow:!1,minDate:null,maxDate:null,choosedTime:null,paymentObj:null,users:[],payments:[],checkAllList:[],dataForm:{billMonth:"",cooperId:""},payForm:{billSn:"",payTime:"",paymentValue:"",payment:"",totalPrice:0,username:null,remark:""},checkedCount:0}},filters:{PriceF:function(t){return Number(t).toFixed(2)}},watch:{checkAllList:function(t){0==t.length&&(this.myAllCheckedStyle="circle")},listArr:function(t){t.map(function(t){var e=void 0;1==t.statu_month&&(e=t.itemList.reduce(function(t,e){return t+e.totalPrice},0)),t.priceTotle=e})}},created:function(){this.$store.commit("setHeader",this.$route.query.cooperationName),this.choosedTime=l()().format("YYYY年MM月"),this.minDate=new Date(l()().subtract(6,"month")),this.maxDate=new Date(l()().add(6,"month")),this.dataForm.cooperId=this.$route.query.cooperId,this.getPayment()},methods:{getPayment:function(){var t=this;Object(i.a)({dictType:"business_payment"}).done(function(e){t.payForm.username=JSON.parse(localStorage.getItem("current_user")).realName||JSON.parse(localStorage.getItem("current_user")).nickName,t.paymentObj={},e.data.map(function(e){t.paymentObj[e.dictValue]=e.dictLabel}),t.paymentsAll=e.data.filter(function(t){return t.dictValue>=5}),t.payments=e.data.filter(function(t){return t.dictLabel&&t.dictValue>=5}).map(function(t){return t.dictLabel}),t.getUnpayInfo()})},getUnpayInfo:function(){var t=this;delete this.dataForm.billMonth,Object(o.e)(this.dataForm).done(function(e){if(t.listArr=e.data,t.listArr.length>0){t.listArr.map(function(t){t.isCheck="",t.isOpen=!1,t.title="L"==t.billSn.charAt(0)?"生活":"租金",t.startM=l()(t.startTime).format("MM")});for(var a=[],i=0;i<t.listArr.length;i++){var n=a.length,o=t.listArr[i].startM;if(n>0&&a[n-1].date&&a[n-1].date==o)a[n-1].itemList.push(t.listArr[i]);else{var s={date:o,statu_month:!0,priceTotle:null,itemList:[]};s.itemList.push(t.listArr[i]),s.itemList,a.push(s)}}++t.contentKey,t.listArr=a.reverse()}})},getPayInfo:function(){var t=this;Object(o.d)(this.dataForm).done(function(e){t.payedAll=e.data,e.data.map(function(t){t.isOpen=!1,t.title="L"==t.billSn.charAt(0)?"生活":"租金"}),t.payedTotelPrice=e.data.reduce(function(t,e){return t+e.totalPrice},0),++t.contentKey})},checkValue:function(t){this.actived=t,0==t?(delete this.dataForm.billMonth,this.checkAllList=[],this.myAllCheckedStyle="circle",this.getUnpayInfo()):(this.dataForm.billMonth=this.choosedTime=l()().format("YYYY-MM"),this.c_date=new Date(l()().format("YYYY-MM")),this.getPayInfo())},openMonth:function(t){t.statu_month=!t.statu_month},isChoosed:function(t){t.isCheck?(t.isCheck="",this.checkAllList=this.checkAllList.filter(function(e){return e.billSn!=t.billSn}),this.payForm.totalPrice=this.payForm.totalPrice-t.totalPrice):(t.isCheck="checked",this.checkAllList.push(t),this.payForm.totalPrice=this.checkAllList.reduce(function(t,e){return t+e.totalPrice},0)),this.contentKey++},isAllChecked:function(){var t=this;this.checkAllList=[],"circle"==this.myAllCheckedStyle?(this.myAllCheckedStyle="checked",this.listArr.map(function(e){1==e.statu_month&&e.itemList.map(function(e){t.checkAllList.push(e),e.isCheck="checked"})}),this.payForm.totalPrice=this.checkAllList.reduce(function(t,e){return t+e.totalPrice},0)):(this.myAllCheckedStyle="circle",this.listArr.map(function(e){e.itemList.map(function(t){t.isCheck=""}),t.payForm.totalPrice=0,t.checkAllList=[]}))},onInputBeforeDate:function(t){this.choosedTime=l()(t).format("YYYY年MM月"),this.dataForm.billMonth=l()(t).format("YYYY-MM"),this.getPayInfo(),this.show_date=!1},btnGo:function(){0!=this.checkAllList.length?this.showPayed=!0:Object(s.Toast)({message:"请选择账单",darution:900})},onConfirmTime:function(t){this.timeShow=!1,this.payForm.payTime=this.formatDate(t)},formatDate:function(t){return(t=new Date(t)).getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())},getType:function(){var t=this;Object(n.q)({hotelId:this.$route.query.hotelId}).done(function(e){t.userAll=e.data,t.users=e.data.map(function(t){return t.accountName}),t.payForm.payeeAccountId=t.userAll[0].id,t.payForm.payeeAccountIdValue=t.userAll[0].accountName+">"})},onConfirm:function(t){this.payForm.payeeAccountIdValue=t+">",this.payForm.payeeAccountId=this.userAll.find(function(e){return e.accountName==t}).id,this.payeeAccountIdValueShow=!1},onConfirmPayment:function(t){this.payForm.paymentValue=t+">",this.payForm.payment=this.paymentsAll.find(function(e){return e.dictLabel==t}).dictValue,this.paymentShow=!1},confirmPayed:function(){var t=this;delete this.payForm.payeeAccountIdValue,delete this.payForm.username,delete this.payForm.paymentValue,this.payForm.billSn=this.checkAllList.map(function(t){return t.billSn}).join(","),Object(o.f)(this.payForm).done(function(e){t.showPayed=!1,t.payForm.totalPrice=null,Object(s.Toast)({message:e.msg,duration:900}),setTimeout("window.history.go(0)",900)})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-tabs",{attrs:{"title-active-color":"#ff6623",color:"#ff6623"},on:{change:t.checkValue}},[a("van-tab",{attrs:{title:"未收款账单",name:"0"}}),t._v(" "),a("van-tab",{attrs:{title:"已收款账单",name:"1"}})],1),t._v(" "),t.listArr.length>0&&0==t.actived?a("div",{key:t.contentKey,staticClass:"agreementScroll",style:{height:0==t.actived?"calc(100vh - 150px)":"calc(100vh - 110px)"}},t._l(t.listArr,function(e,i){return a("div",{key:i},[0==t.actived?a("div",{staticClass:"noPaid-time",on:{click:function(a){return t.openMonth(e)}}},[a("div",[a("span",{staticClass:"time-title"},[t._v(t._s(e.date)+"月账单")]),t._v(" "),a("span",{staticClass:"time-price"},[t._v(" 总金额 "+t._s(t._f("PriceF")(e.priceTotle))+"元 ")])]),t._v(" "),a("div",[a("van-icon",{attrs:{name:e.statu_month?"arrow-down":"arrow"}})],1)]):t._e(),t._v(" "),1==e.statu_month?a("div",[a("ul",t._l(e.itemList,function(e,i){return a("li",{key:i,staticClass:"my-li"},[a("div",{staticClass:"day-content content-top mr10"},[a("div",{staticClass:"day-content w100"},[a("van-icon",{style:{color:e.isCheck?"#ff7d41":"#9a9b9c"},attrs:{name:"checked"==e.isCheck?"passed":"circle",size:"16px"},on:{click:function(a){return t.isChoosed(e)}}}),t._v(" "),a("div",{staticClass:"content-left"},[a("div",{staticClass:"my-color-000"},[a("div",{staticStyle:{"max-width":"40%","font-weight":"bold"}},[t._v(t._s(e.roomSn||""))]),t._v(" "),a("div",{class:"租金"==e.title?"db":"ff"},[t._v(t._s(e.title))])]),t._v(" "),a("div",{staticStyle:{"white-space":"nowrap"}},[t._v(t._s(t._f("dataFilter")(e.startTime))+"~"+t._s(t._f("dataFilter")(e.endTime)))])])],1),t._v(" "),a("div",{staticClass:"my-van-icon",on:{click:function(a){t.contentKey++,e.isOpen=!e.isOpen}}},[a("span",{staticClass:"my-color-000",staticStyle:{"font-weight":"bold"}},[t._v(t._s(t._f("PriceF")(e.totalPrice))+"元")]),t._v(" "),a("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),e.isOpen?a("div",[a("div",{staticClass:"day-content m40"},[a("div",[t._v("缴费周期")]),t._v(" "),a("div",[t._v(t._s(t._f("dataFilter")(e.startTime))+"至"+t._s(t._f("dataFilter")(e.endTime)))])]),t._v(" "),e.payTime?a("div",{staticClass:"day-content m40 content-top"},[a("div",[t._v("收款日期")]),t._v(" "),a("div",[t._v(t._s(t._f("dataFilter")(e.payTime)))])]):t._e(),t._v(" "),a("div",{staticClass:"day-content m40 content-top"},[a("div",[t._v("备注")]),t._v(" "),a("div",[t._v(t._s(t.paymentObj[e.payment]))])]),t._v(" "),a("div",{staticClass:"p10",on:{click:function(a){t.contentKey--,e.isOpen=!1}}},[a("span",[t._v("收起")]),t._v(" "),a("van-icon",{attrs:{name:"arrow-up"}})],1)]):t._e()])}),0)]):t._e()])}),0):t._e(),t._v(" "),1==t.actived?a("div",{key:t.contentKey,staticClass:"payed_box"},[a("div",{staticClass:"payed_top"},[a("div",{staticClass:"top_l",on:{click:function(e){t.show_date=!0}}},[a("div",[t._v(t._s(t.choosedTime))]),t._v(" "),a("van-icon",{attrs:{name:"arrow-down"}})],1),t._v(" "),a("div",{staticStyle:{"font-size":"0.7rem"}},[t._v("总金额 "+t._s(t.payedTotelPrice)+"元")])]),t._v(" "),t._l(t.payedAll,function(e,i){return a("div",{key:i,staticClass:"my-li"},[a("div",{staticClass:"day-content content-top mr10"},[a("div",{staticClass:"day-content w100"},[a("div",{staticClass:"content-left"},[a("div",{staticClass:"my-color-000"},[a("div",{staticStyle:{"max-width":"40%","font-weight":"bold"}},[t._v(t._s(e.roomSn))]),t._v(" "),a("div",{staticClass:"my-li",class:"租金"==e.title?"db":"ff"},[t._v(t._s(e.title))])]),t._v(" "),a("div",{staticStyle:{"white-space":"nowrap",color:"#B5B5B5"}},[t._v(t._s(t._f("dataFilter")(e.startTime))+"~"+t._s(t._f("dataFilter")(e.endTime)))])])]),t._v(" "),a("div",{staticClass:"my-van-icon",on:{click:function(a){t.contentKey++,e.isOpen=!e.isOpen}}},[a("span",{staticClass:"my-color-000",staticStyle:{"font-weight":"bold"}},[t._v(t._s(e.totalPrice)+"元")]),t._v(" "),a("van-icon",{attrs:{name:t.myLookMoreStyle}})],1)]),t._v(" "),e.isOpen?a("div",[a("div",{staticClass:"day-content m30"},[a("div",[t._v("缴费周期")]),t._v(" "),a("div",[t._v(t._s(t._f("dataFilter")(e.startTime))+"至"+t._s(t._f("dataFilter")(e.endTime)))])]),t._v(" "),e.payTime?a("div",{staticClass:"day-content m30 content-top"},[a("div",[t._v("收款日期")]),t._v(" "),a("div",[t._v(t._s(t._f("dataFilter")(e.payTime)))])]):t._e(),t._v(" "),a("div",{staticClass:"day-content m30 content-top"},[a("div",[t._v("备注")]),t._v(" "),a("div",[t._v(t._s(t.paymentObj[e.payment]))])]),t._v(" "),a("div",{staticClass:"p10",on:{click:function(a){t.contentKey--,e.isOpen=!1}}},[a("span",[t._v("收起")]),t._v(" "),a("van-icon",{attrs:{name:"arrow-up"}})],1)]):t._e()])})],2):t._e(),t._v(" "),0==t.actived?a("div",{staticClass:"bottom-allPrice"},[a("div",{staticClass:"bottom-left",on:{click:t.isAllChecked}},[a("van-icon",{style:{color:"checked"==t.myAllCheckedStyle?"#ff7d41":"#9a9b9c"},attrs:{name:t.myAllCheckedStyle}}),t._v(" 全选\n    ")],1),t._v(" "),a("div",{staticClass:"bottom-center"},[t._v("\n      总计"),a("label",[t._v("\n        ¥ "),a("span",[t._v(t._s(t._f("PriceF")(t.payForm.totalPrice)))])])]),t._v(" "),a("van-button",{staticClass:"bottom-right",on:{click:t.btnGo}},[t._v("到账")])],1):t._e(),t._v(" "),a("van-popup",{attrs:{round:"","bind:close":"onClose"},model:{value:t.showPayed,callback:function(e){t.showPayed=e},expression:"showPayed"}},[a("h3",[t._v("到账")]),t._v(" "),a("van-cell-group",[a("van-form",{on:{submit:t.confirmPayed}},[a("van-field",{attrs:{readonly:"",label:"到账日期",placeholder:"点击选择到账日期",rules:[{required:!0,message:"请选择到账日期"}]},nativeOn:{click:function(e){t.timeShow=!0}},model:{value:t.payForm.payTime,callback:function(e){t.$set(t.payForm,"payTime",e)},expression:"payForm.payTime"}}),t._v(" "),a("van-field",{attrs:{readonly:"",label:"支付方式",placeholder:"请选择",rules:[{required:!0,message:"请选择支付方式"}]},on:{click:function(e){t.paymentShow=!0}},model:{value:t.payForm.paymentValue,callback:function(e){t.$set(t.payForm,"paymentValue",e)},expression:"payForm.paymentValue"}}),t._v(" "),a("van-field",{attrs:{readonly:"",label:"到账金额"},model:{value:t.payForm.totalPrice,callback:function(e){t.$set(t.payForm,"totalPrice",e)},expression:"payForm.totalPrice"}}),t._v(" "),a("van-field",{attrs:{label:"确认人",readonly:""},model:{value:t.payForm.username,callback:function(e){t.$set(t.payForm,"username",e)},expression:"payForm.username"}}),t._v(" "),a("van-field",{attrs:{label:"备注",placeholder:"请输入备注"},model:{value:t.payForm.remark,callback:function(e){t.$set(t.payForm,"remark",e)},expression:"payForm.remark"}}),t._v(" "),a("van-button",{staticClass:"payedColor"},[t._v("确定收款")])],1)],1)],1),t._v(" "),a("mt-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.show_date,callback:function(e){t.show_date=e},expression:"show_date"}},[a("van-datetime-picker",{attrs:{type:"year-month",title:"选择开始日期","min-date":t.chooseMinDate,"max-date":t.chooseMaxDate},on:{cancel:function(e){t.show_date=!1},confirm:t.onInputBeforeDate},model:{value:t.c_date,callback:function(e){t.c_date=e},expression:"c_date"}})],1),t._v(" "),a("van-calendar",{staticStyle:{width:"100%"},attrs:{"min-date":t.minDate,"max-date":t.maxDate},on:{close:function(e){t.timeShow=!1},confirm:t.onConfirmTime},model:{value:t.timeShow,callback:function(e){t.timeShow=e},expression:"timeShow"}}),t._v(" "),a("van-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.paymentShow,callback:function(e){t.paymentShow=e},expression:"paymentShow"}},[a("van-picker",{attrs:{"show-toolbar":"",columns:t.payments},on:{confirm:t.onConfirmPayment,cancel:function(e){t.paymentShow=!1}}})],1),t._v(" "),a("van-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.payeeAccountIdValueShow,callback:function(e){t.payeeAccountIdValueShow=e},expression:"payeeAccountIdValueShow"}},[a("van-picker",{attrs:{"show-toolbar":"",columns:t.users},on:{confirm:t.onConfirm,cancel:function(e){t.payeeAccountIdValueShow=!1}}})],1)],1)},staticRenderFns:[]};var m=a("k6Sl")(r,d,!1,function(t){a("UDJ3")},"data-v-5451fb3c",null);e.default=m.exports}});
//# sourceMappingURL=99.045fd2d17d6d057f60991758771190591.js.map