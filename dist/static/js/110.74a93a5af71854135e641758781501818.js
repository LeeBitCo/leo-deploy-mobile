webpackJsonp([110],{"1Mkc":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("RmFe"),r=o.n(s),i=o("tN5p"),n=o("UJbh"),a=o("Gwi0"),l=o("TKTC"),c={data:function(){return{new_list:[],rooms:[],top_rooms:[],show_info:!1,rents:[],roomStatus:[],sorts:[],bedInfoAll:[],newData:{hotelId:"0",landlord:this.$route.query.landlord},rent:"租赁类型",infoBox:"",liveInfo:"",currentRole:"",toDay:"",show_left:!1,dome:[],domeName:"",leftName:"全部酒店",show_center:!1,center_1:"租赁类型",show_center_2:!1,center_2:"房间状态",show_right:!1,a:"",more_box:!1,more:"",password_show:!1,ROLE_MANAGER:!1,ROLE_HOTEL_OWNER:!1,pass_phone:"",login_info:null,hotelType:null}},created:function(){var t=this;this.$store.commit("setHeader","实时房态"),this.hotelId=this.$route.query.hotelId,"1"==JSON.parse(localStorage.getItem("current_user")).id?this.ROLE_MANAGER=!0:(this.roles=JSON.parse(localStorage.getItem("roles")),this.roles.some(function(e){return"ROLE_MANAGER"==e.name?t.ROLE_MANAGER=!0:t.ROLE_MANAGER=!1}),"ROLE_HOTEL_OWNER"==this.roles[0].name&&(this.ROLE_HOTEL_OWNER=!0)),this.hotelType=localStorage.getItem("c_hotelType"),this.param={hotelId:this.hotelId},this.topList(),this.getTop();var e=new Date,o=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,s=e.getDate()<10?"0"+e.getDate():e.getDate();this.toDay=e.getFullYear()+"-"+o+"-"+s;var r=e.getHours()<10?"0"+e.getHours():e.getHours(),i=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),n=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();this.a=this.toDay+" "+r+":"+i+":"+n},computed:{computerWidth:function(){return(window.innerWidth-40)/3+"px"}},methods:{getTop:function(){var t=this;Object(n.a)({dictType:"business_order_type"}).done(function(e){t.rents=e.data}),Object(n.a)({dictType:"business_room_status"}).done(function(e){t.roomStatus=e.data})},topList:function(){var t=this;if(this.$route.query.accountUnitId){var e={hotelId:this.$route.query.hotelId,accountUnitId:this.$route.query.accountUnitId};Object(l.k)(e).done(function(e){for(var o=e.data.sort(t.objectArraySort("roomSn")).reverse(),s=[],r=[],i=0,n=0,a=0;a<o.length;a++)-1==s.indexOf(o[a].buildNum)&&(s[i]=o[a].buildNum,i++),-1==r.indexOf(o[a].floor)&&(r[n]=o[a].floor,n++);var l=[];for(a=0;a<s.length;a++){for(var c=[],d=0,u=0;u<o.length;u++)s[a]==o[u].buildNum&&(c[d]=o[u],d++);for(var _=0,f=0;f<r.length;f++){var v=[],h=0;for(u=0;u<c.length;u++)c[u].floor==r[f]&&(v[h]=c[u],h++);if(v.length>0){var m={floor:r[f],children:v};p[_]=m,_++}}var p=p.sort(t.objectArraySort("floor"));if(p.reverse(),p.length>0){var b={buildNum:s[a],sum:c.length,children:p};l[a]=b}}l.sort(t.objectArraySort("buildNum")),t.rooms=l.reverse(),t.top_rooms=l,t.top_rooms=l})}else{var o={hotelId:"0",landlord:this.$route.query.landlord};Object(a._4)(o).done(function(e){for(var o=e.data.sort(t.objectArraySort("roomSn")).reverse(),s=[],i=[],n=0,a=0,l=0;l<o.length;l++)t.isBeforeTime=r()(o[l].endTime).isBefore(r()()),"2"==o[l].status&&"3"==o[l].roomType&&1==t.isBeforeTime||"2"==o[l].status&&"4"==o[l].roomType&&1==t.isBeforeTime?o[l].show_dao=!0:o[l].show_dao=!1,-1==s.indexOf(o[l].buildNum)&&(s[n]=o[l].buildNum,n++),-1==i.indexOf(o[l].floor)&&(i[a]=o[l].floor,a++);var c=[];for(l=0;l<s.length;l++){for(var d=[],u=0,_=0;_<o.length;_++)s[l]==o[_].buildNum&&(d[u]=o[_],u++);for(var f=[],v=0,h=0;h<i.length;h++){var m=[],p=0;for(_=0;_<d.length;_++)d[_].floor==i[h]&&(m[p]=d[_],p++);if(m.length>0){var b={floor:i[h],children:m};f[v]=b,v++}}if((f=f.sort(t.objectArraySort("floor"))).reverse(),f.length>0){var g={buildNum:s[l],sum:d.length,children:f};c[l]=g}}c=c.sort(t.objectArraySort("buildNum")),t.rooms=c.reverse(),t.top_rooms=c})}},findList:function(){var t=this;Object(a._4)().done(function(e){for(var o=e.data.sort(t.objectArraySort("roomSn")).reverse(),s=[],r=[],i=0,n=0,a=0;a<o.length;a++)-1==s.indexOf(o[a].buildNum)&&(s[i]=o[a].buildNum,i++),-1==r.indexOf(o[a].floor)&&(r[n]=o[a].floor,n++);var l=[];for(a=0;a<s.length;a++){for(var c=[],d=0,u=0;u<o.length;u++)s[a]==o[u].buildNum&&(c[d]=o[u],d++);for(var _=[],f=0,v=0;v<r.length;v++){var h=[],m=0;for(u=0;u<c.length;u++)c[u].floor==r[v]&&(h[m]=c[u],m++);if(h.length>0){var p={floor:r[v],children:h};_[f]=p,f++}}if((_=_.sort(t.objectArraySort("floor"))).reverse(),_.length>0){var b={buildNum:s[a],sum:c.length,children:_};l[a]=b}}l=l.sort(t.objectArraySort("buildNum")),t.rooms=l.reverse()})},objectArraySort:function(t){return function(e,o){var s=e[t],r=o[t];return s<r?1:s>r?-1:0}},btnInfo:function(t){this.infoBox=t,"4"==this.hotelType?this.getBedInfo(t.id):t.cooperId>0||1==t.cleanCooper?this.getCooperInfo(t.id):(this.liveInfo="",2!=this.infoBox.status&&3!=this.infoBox.status||this.getInfo()),this.show_info=!0},getBedInfo:function(t){var e=this;Object(l.l)({roomId:t}).done(function(t){e.bedInfoAll=t.data})},getCooperInfo:function(t){var e=this;Object(i.g)({roomId:t}).done(function(t){e.liveInfo=t.data})},getInfo:function(){var t=this;Object(a.L)(this.infoBox.id).done(function(e){var o=new Date(e.data.order.startTime),s=new Date;s.setTime(o.getTime()+864e5);var r=s.getFullYear()<10?"0"+s.getFullYear():s.getFullYear(),i=s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1,n=s.getDate()<10?"0"+s.getDate():s.getDate();e.data.next_day=r+"-"+i+"-"+n+" 08:00:00",t.liveInfo=e.data})},getMoreList:function(){var t=this;this.show_info=!1,this.liveInfo.id&&Object(a.J)(this.liveInfo.id).done(function(e){t.more=e.data}),this.more_box=!0},btnALL:function(){this.show_left=!0},btnRent:function(){this.show_center=!0},btnStatus:function(){this.show_center_2=!0},choosed_all:function(t){this.leftName=t,"全部酒店"!=t?this.newData.buildNum=t:delete this.newData.buildNum,this.show_left=!1,this.findList()},choosed_rent:function(t){"租赁类型"!=t?(this.center_1=t.dictLabel,this.newData.roomType=t.dictValue):(this.center_1=t,delete this.newData.roomType),this.show_center=!1,this.findList()},choosed_statu:function(t){"房间状态"!=t?(this.center_2=t.dictLabel,this.newData.status=t.dictValue):(this.center_2=t,delete this.newData.status),this.show_center_2=!1,this.findList()},historyIncome:function(){this.$router.push({path:"/owner-order",query:{roomId:this.infoBox.id}})}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{attrs:{id:"top"}},[s("div",{staticClass:"topbox",on:{click:t.btnALL}},[s("div",[t._v("\n        "+t._s("全部酒店"==t.leftName?t.leftName:t.leftName+"栋")+"\n        "),s("img",{attrs:{src:o("dD+a"),alt:""}})])]),t._v(" "),s("div",{staticClass:"topbox",on:{click:t.btnRent}},[s("div",[t._v("\n        "+t._s(t.center_1)+"\n        "),s("img",{attrs:{src:o("dD+a"),alt:""}})])]),t._v(" "),s("div",{staticClass:"topbox",on:{click:t.btnStatus}},[s("div",[t._v("\n        "+t._s(t.center_2)+"\n        "),s("img",{attrs:{src:o("dD+a"),alt:""}})])])]),t._v(" "),s("div",{attrs:{id:"bottom"}},t._l(t.rooms,function(e,r){return s("div",{key:r},[s("div",{staticClass:"buildNum"},[s("p",[t._v("\n          "+t._s("99"!=e.buildNum&&e.buildNum?e.buildNum+"栋":"其他")+"\n          (共"+t._s(e.sum)+"间)\n        ")])]),t._v(" "),t._l(e.children,function(e,r){return s("div",{key:r,staticClass:"floor"},[s("div",[s("p"),t._v(" "),s("p",[t._v(t._s(e.floor+"楼"))]),t._v(" "),s("p")]),t._v(" "),s("div",{staticClass:"room_box"},t._l(e.children,function(e,r){return s("div",{key:r,staticClass:"bigbox"},[s("div",{staticClass:"roomdiv",class:e.cooperId>0?"c21":"c"+e.status+("0"==e.isRoomCheck?"0":"1"),on:{click:function(o){return t.btnInfo(e)}}},[s("p",{staticClass:"num"},[s("label",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis"}},[t._v(t._s(e.roomSn))]),t._v(" "),e.endTime&&t.toDay==e.endTime.substring(0,10)?s("img",{attrs:{src:o("Q3pm"),alt:""}}):t._e()]),t._v(" "),s("div",{staticClass:"imgBox"},[s("div",{staticStyle:{"-border":"1px solid green"}},[2==e.status&&"4"==t.hotelType?s("div",[t._v(t._s(e.bedIn||"0")+"/"+t._s(e.bedNum||"0"))]):t._e(),t._v(" "),3==e.status&&0!=e.isRoomCheck?s("img",{attrs:{src:o("pi7s"),alt:""}}):t._e(),t._v(" "),3==e.status&&0==e.isRoomCheck?s("img",{attrs:{src:o("0w6M"),alt:""}}):t._e(),t._v(" "),e.show_dao?s("img",{attrs:{src:o("Oi7W"),alt:""}}):t._e()]),t._v(" "),s("div",{staticStyle:{"-border":"1px solid red"}},[1==e.status?s("img",{attrs:{src:o("U87x"),alt:""}}):t._e(),t._v(" "),2==e.status&&"4"!=t.hotelType?s("img",{attrs:{src:o("PkA4"),alt:""}}):t._e(),t._v(" "),4==e.status?s("img",{attrs:{src:o("CCcR"),alt:""}}):t._e(),t._v(" "),5==e.status?s("img",{attrs:{src:o("5v8K"),alt:""}}):t._e(),t._v(" "),2==e.status&&1==e.roomType?s("img",{attrs:{src:o("YI80"),alt:""}}):t._e(),t._v(" "),2==e.status&&2==e.roomType?s("img",{attrs:{src:o("3M+C"),alt:""}}):t._e(),t._v(" "),2==e.status&&3==e.roomType||2==e.status&&"4"==t.hotelType?s("img",{attrs:{src:o("05mR"),alt:""}}):t._e()])])])])}),0)])})],2)}),0),t._v(" "),s("mt-popup",{staticStyle:{"border-radius":"5px",width:"90%","text-align":"left","font-size":"0.7rem",color:"#888"},attrs:{"popup-transition":"popup-fade",position:"center"},model:{value:t.show_info,callback:function(e){t.show_info=e},expression:"show_info"}},[s("div",{attrs:{id:"showbox"}},[s("p",[s("span",[t._v(t._s(t.infoBox.roomSn))])]),t._v(" "),t.bedInfoAll.length>0?s("p",[s("span",{staticClass:"open_img"},[s("img",{attrs:{src:o("4+oD")}}),t._v(" "),s("span",{staticStyle:{"padding-left":"4px"}},[s("span",{staticStyle:{color:"#02bc1fc4"}},[t._v(t._s(t.infoBox.bedIn||"0"))]),t._v(" "),s("span",[t._v("/"+t._s(t.infoBox.bedNum||"0"))])])]),t._v(" "),s("span",{staticClass:"open_img"},[s("img",{attrs:{src:o("sD9W")}}),t._v(" "),t._l(t.bedInfoAll,function(e,o){return s("span",{key:o,staticStyle:{"padding-left":"4px"}},[s("span",[t._v(t._s(e.order.roomUser)+"；")])])})],2)]):t._e(),t._v(" "),s("p",{staticClass:"bottomBox"},[t.liveInfo?s("span",[1==t.infoBox.roomType?s("img",{attrs:{src:o("2llB"),alt:""}}):t._e(),t._v(" "),2==t.infoBox.roomType?s("img",{attrs:{src:o("w4cF"),alt:""}}):t._e(),t._v(" "),3==t.infoBox.roomType&&t.infoBox.cooperId<=0?s("img",{attrs:{src:o("Metz"),alt:""}}):t._e(),t._v(" "),3==t.liveInfo.orderType?s("span",[s("span",[t._v(t._s(t.liveInfo.order.startTime.substr(5,5))+" 至 "+t._s(t.liveInfo.order.endTime.substr(5,5)))]),t._v(" "),s("span",[t._v("共"+t._s(12*(t.liveInfo.order.endTime.substr(0,4)-t.liveInfo.order.startTime.substr(0,4))+(t.liveInfo.order.endTime.substr(5,2)-t.liveInfo.order.startTime.substr(5,2)))+"月")])]):s("span",[t._v(t._s(t.liveInfo.order.startTime.substr(5,5))+"至"+t._s(t.liveInfo.order.endTime.substr(5,5))+"  共"+t._s(t.liveInfo.order.diffDay)+t._s(2==t.liveInfo.orderType?"小时":"晚"))]),t._v(" "),s("span",[t._v("房费:¥"+t._s(3==t.liveInfo.orderType||4==t.liveInfo.orderType?t.liveInfo.order.price:0==t.liveInfo.isCon?(t.liveInfo.roomPrice-t.liveInfo.deposit).toFixed(2):t.liveInfo.roomPrice))])]):t._e(),t._v(" "),3==t.infoBox.status&&0!=t.infoBox.isRoomCheck?s("span",{staticClass:"cleaning"},[1==t.infoBox.roomType?s("img",{attrs:{src:o("nBqX"),alt:""}}):t._e(),t._v(" "),s("span",[t._v("房间需要清洁，清洁完成后才能分房")])]):t._e(),t._v(" "),3==t.infoBox.status&&0==t.infoBox.isRoomCheck?s("span",{staticClass:"cleaning"},[1==t.infoBox.roomType?s("img",{attrs:{src:o("nQHL"),alt:""}}):t._e(),t._v(" "),s("span",[t._v("顾客正在等待您退押，请完成查房")])]):t._e(),t._v(" "),t.liveInfo?s("label",[s("img",{attrs:{src:o("sD9W"),alt:""}}),t._v(" "),"1"==t.liveInfo.order.orderSource?s("span",[t._v(t._s(null!=t.liveInfo.sysUser?t.liveInfo.sysUser.realName:t.liveInfo.order.roomUser))]):s("span",[t._v(t._s(t.liveInfo.order.roomUser?t.liveInfo.order.roomUser:"未录入"))])]):t._e()]),t._v(" "),t.bedInfoAll.length>0?s("div",[s("mt-button",{staticClass:"boxBottom",attrs:{name:"idMoreBox"}},[t._v("查看详情")])],1):1==t.ROLE_HOTEL_OWNER?s("div",[s("mt-button",{staticClass:"boxBottom",on:{click:t.historyIncome}},[t._v("历史记录")])],1):t._e()])]),t._v(" "),s("mt-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.show_left,callback:function(e){t.show_left=e},expression:"show_left"}},[s("div",{staticClass:"type_box",on:{click:function(e){return t.choosed_all("全部酒店")}}},[t._v("全部酒店")]),t._v(" "),t._l(t.top_rooms.filter(function(t){return t.buildNum}),function(e,o){return s("div",{key:o,staticClass:"type_box",on:{click:function(o){return t.choosed_all(e.buildNum)}}},[s("span",[t._v(t._s(e.buildNum+"栋"))])])})],2),t._v(" "),s("mt-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.show_center,callback:function(e){t.show_center=e},expression:"show_center"}},[s("div",{staticClass:"type_box",on:{click:function(e){return t.choosed_rent("租赁类型")}}},[t._v("租赁类型")]),t._v(" "),t._l(t.rents,function(e,o){return s("div",{key:o,staticClass:"type_box",on:{click:function(o){return t.choosed_rent(e)}}},[s("span",[t._v(t._s(e.dictLabel))])])})],2),t._v(" "),s("mt-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.show_center_2,callback:function(e){t.show_center_2=e},expression:"show_center_2"}},[s("div",{staticClass:"type_box",on:{click:function(e){return t.choosed_statu("房间状态")}}},[t._v("房间状态")]),t._v(" "),t._l(t.roomStatus,function(e,o){return s("div",{key:o,staticClass:"type_box",on:{click:function(o){return t.choosed_statu(e)}}},[s("span",[t._v(t._s(e.dictLabel))])])})],2),t._v(" "),s("mt-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.more_box,callback:function(e){t.more_box=e},expression:"more_box"}})],1)},staticRenderFns:[]};var u=o("k6Sl")(c,d,!1,function(t){o("us/i")},"data-v-428e2f51",null);e.default=u.exports},"us/i":function(t,e){}});
//# sourceMappingURL=110.74a93a5af71854135e641758781501818.js.map