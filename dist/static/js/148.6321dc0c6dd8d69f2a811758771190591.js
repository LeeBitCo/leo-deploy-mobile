webpackJsonp([148],{FHUr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("HkQL"),n=i.n(s),a=i("Gwi0"),l=i("RmFe"),r=i.n(l),o={components:{},data:function(){return{key:0,listArr:[],item:"",statu:!1,options:{},s:"",priceAll:{},refuseAll:{},selected:"1",contentKey:0,timeaaa:null,outBill:null,num:"1"}},created:function(){for(var t=this,e=JSON.parse(localStorage.getItem("c_hotelAll")).filter(function(e){return e.id==t.$route.query.hotelId})[0].createTime,i=r()(e).format("YYYY-MM"),s=r()().format("YYYY-MM"),n=[],a=0;a<100;a++){r()(i).add(a,"month").unix()<=r()(s).unix()&&n.push(r()(i).add(a,"month"))}this.$store.commit("setHeader","经营日报");for(var l=new Date,o=l.getFullYear(),c=l.getMonth()+1<10?"0"+(l.getMonth()+1):l.getMonth()+1,h=0;h<n.length;h++){var d=c-h,u=o;if(d<=0){var m=Math.abs(d);d=12-m%12,u-=parseInt(m/12)+1}this.listArr.push({y:u,m:d<10?"0"+d:d,statu:0==h})}var p={};this.listArr.forEach(function(t){p[t.y]?p[t.y].push(t):p[t.y]=[t]});var v=[];for(var y in p){var f={};f.year=y,f.child=p[y],v.push(f)}this.listArr=v.reverse(),this.toggle(this.listArr[0].child[0],1)},methods:{btnSearch:function(t){(new Date).getFullYear();this.num=t,this.priceAll={},this.options=[],this.toggle(this.listArr[0].child[0],1)},toggle:function(t,e){this.item=t,t.statu=1==e||!t.statu,2==this.num?1==t.statu&&this.getprice_long(t.y,t.m):1==t.statu&&this.getprice(t.y,t.m)},getprice:function(t,e){var i=this;this.hotelId=this.$route.query.hotelId;var s={billTime:this.item.y+"-"+this.item.m};this.timeaaa=s.billTime,Object(a.c)(this.hotelId,s).done(function(s){i.outBill=s.order,i.options[t+"-"+e]=[],i.options[t+"-"+e]=s.data,i.func(i.options[t+"-"+e],t+"-"+e),++i.contentKey})},getprice_long:function(t,e){var i=this;this.hotelId=this.$route.query.hotelId;var s={billTime:this.item.y+"-"+this.item.m};this.timeaaa=s.billTime,Object(a.D)(this.hotelId,s).done(function(s){i.options[t+"-"+e]=[],i.options[t+"-"+e]=s.data,i.func(i.options[t+"-"+e],t+"-"+e),++i.contentKey})},func:function(t,e){for(var i=0,s=0,n=0;n<t.length;n++)2!=this.num?(t[n].new_startTime=t[n].startTime.substr(5,5),t[n].new_endTime=t[n].endTime.substr(5,5),i+=t[n].totalPrice,this.priceAll[e]=i.toFixed(2),s+=t[n].refuseAmount,this.refuseAll[e]=s.toFixed(2),++this.key):(i+=t[n].totalPrice,this.priceAll[e]=i.toFixed(2),++this.key),0==t[n].status||1==t[n].status?t[n].status_name="已结算待转账":2==t[n].status?t[n].status_name="已转账":3==t[n].status&&(t[n].status_name="转账失败")},goPaid:function(t,e){1==this.selected?this.$router.push({name:"OutRecord",query:{hotelId:this.hotelId,billRecordId:t.id,selected:this.selected,time:t.billStartTime,type:e.type,isshow:"1"}}):(t.selected=this.selected,this.$router.push({name:"OutRecord",query:{monthBillRecordId:t.id,time:t.billTime,selected:this.selected,type:e.type,isshow:"1"}}),localStorage.setItem("list",n()(t)))},goMonth:function(t){this.$router.push({name:"OutRecord",query:{billMonth:t,hotelId:this.hotelId,type:"Paid",selected:this.selected}})}}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{padding:"15px 0",position:"fixed",top:"50px",bottom:"0",left:"0",right:"0","overflow-y":"scroll","background-color":"#F6F6F6","font-size":"0.8rem"}},[s("div",{staticClass:"arrive"},[s("mt-navbar",{model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[s("mt-tab-item",{attrs:{id:"1"},nativeOn:{click:function(e){return t.btnSearch(1)}}},[s("span",[t._v("日租")])]),t._v(" "),s("mt-tab-item",{attrs:{id:"2"},nativeOn:{click:function(e){return t.btnSearch(2)}}},[s("span",[t._v("长租")])])],1)],1),t._v(" "),t._m(0),t._v(" "),s("div",{key:t.contentKey},t._l(t.listArr,function(e,n){return s("div",{key:n},[s("div",{staticClass:"yearBill",on:{click:function(i){return t.goMonth(e.year)}}},[t._v("查看"+t._s(e.year)+"年度\n        "),s("van-icon",{attrs:{name:"arrow"}})],1),t._v(" "),t._l(e.child,function(e,n){return s("div",{key:n},[s("div",{staticClass:"all",on:{click:function(i){return t.toggle(e)}}},[s("span",{staticStyle:{"margin-left":"20px",display:"flex","align-items":"center"},on:{click:function(i){return i.stopPropagation(),t.goMonth(e.y+"-"+e.m)}}},[t._v(t._s(e.y)+"年"+t._s(e.m)+"月\n            "),s("van-icon",{attrs:{name:"arrow"}})],1),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:0==e.statu,expression:"item.statu==false"}]},[s("img",{staticStyle:{width:"20px",height:"20px","vertical-align":"middle"},attrs:{src:i("JfLI"),alt:""}})]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.statu,expression:"item.statu==true"}]},[s("img",{staticStyle:{width:"20px",height:"20px","vertical-align":"middle"},attrs:{src:i("M2uH"),alt:""}})]),t._v(" "),t.priceAll[e.y+"-"+e.m]?s("span",{staticClass:"money",on:{click:function(i){return i.stopPropagation(),t.goMonth(e.y+"-"+e.m)}}},[s("span",{staticStyle:{display:"inline-block","-width":"122px","text-align":"left"}},[t._v("\n              总收入 ¥\n              "),s("span",{staticStyle:{color:"#888"}},[t._v(t._s(t.priceAll[e.y+"-"+e.m]))])]),t._v(" \n          ")]):t._e()]),t._v(" "),s("div",[s("ul",{directives:[{name:"show",rawName:"v-show",value:e.statu,expression:"item.statu"}],key:t.key,staticStyle:{"margin-bottom":"10px"}},t._l(t.options[e.y+"-"+e.m],function(e,n){return s("li",{key:n,staticClass:"other_box",on:{click:function(i){return t.goPaid(e,{type:"Paid"})}}},[s("span",{staticClass:"li-box"},[s("span",{staticStyle:{display:"inline-block",width:"32%","margin-left":"1rem"}},[t._v("\n                  "+t._s(1==t.selected?e.billStartTime:e.billTime))]),t._v(" "),s("span",{staticStyle:{display:"inline-block",width:"30%",color:"#000"}},[t._v(t._s(e.status_name))]),t._v(" "),s("span",{staticStyle:{display:"inline-block",width:"30%",color:"#000"}},[t._v("¥"+t._s(e.totalPrice))]),t._v(" "),s("img",{staticStyle:{width:"20px",height:"20px",padding:"8px 7px 0px 0px",color:"#000"},attrs:{src:i("JfLI"),alt:""}}),t._v(" \n              ")])])}),0)])])})],2)}),0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"status_box"}},[e("span",{staticStyle:{display:"inline-block",width:"35%","-border":"1px solid red","text-align":"left"}},[this._v("账单日")]),this._v(" "),e("span",{staticStyle:{display:"inline-block",width:"10%","-border":"1px solid red"}},[this._v("状态")]),this._v(" "),e("span",{staticStyle:{display:"inline-block",width:"27%","-border":"1px solid red","margin-left":"30px"}},[this._v("金额")])])}]};var h=i("k6Sl")(o,c,!1,function(t){i("Qv9M")},"data-v-0c5d6229",null);e.default=h.exports},Qv9M:function(t,e){}});
//# sourceMappingURL=148.6321dc0c6dd8d69f2a811758771190591.js.map