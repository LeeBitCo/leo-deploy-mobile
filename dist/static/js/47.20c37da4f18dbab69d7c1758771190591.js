webpackJsonp([47],{"0HOB":function(t,e){},Zsi2:function(t,e,a){"use strict";(function(t){var n=a("s/F+"),i=a.n(n),r=a("yrbl"),o=a.n(r),c=a("44Rm"),s=a("+h5c"),u=a("T6yf"),l=a("s/fh");Object({NODE_ENV:"production",IMG_URL:"//qiniu.aiyoyoufang.com/"})||t.env_test||t.env_production;e.a={data:function(){return{payTitle:"请扫码支付",currentInfo:null,status:"0",price:null,code:null,uploader:null,photos:[],dataForm:{auditApprovalId:this.$route.query.auditApprovalId,payerName:null,payImage:null}}},mounted:function(){"online"==this.$route.query.type&&(this.timer=setInterval(this.getIsPay,1e4))},beforeDestroy:function(){clearInterval(this.timer)},created:function(){this.$store.commit("setHeader",""+this.$route.query.type=="online"?"扫码付款":"对公转账"),"online"==this.$route.query.type?this.getCode():"pay"==this.$route.query.type&&this.getInfo()},methods:{getCode:function(){var t=this;Object(u.g)({auditApprovalId:this.$route.query.auditApprovalId}).done(function(e){t.code="data:image/png;base64,"+e.order,t.price=e.data})},getIsPay:function(){var t=this;Object(u.f)({auditApprovalId:this.$route.query.auditApprovalId}).done(function(e){t.statusInfo=e.data,e.data.payment>0&&(clearInterval(t.timer),t.payTitle="已支付")})},getInfo:function(){var t=this;Object(u.r)().done(function(e){t.currentInfo=e.data,t.getqiniu()})},getqiniu:function(){var t=this;Object(c.d)().done(function(e){t.token=e.data})},upLoadToQiniu:function(t){var e=this;return o()(i.a.mark(function a(){var n,r,o,c,u,l;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.dataForm.payImage=t.content,e.photos.push(t),n={headers:{"Content-Type":"multipart/form-data"},domain:""},"","image/png"==t.file.type?"png":"jpg",r=e.token,(o=new FormData).append("file",t.file),o.append("token",r),c=e,u={next:function(t){},error:function(t){},complete:function(t){c.dataForm.payImage=t.key}},l=s.a(t.file,"hotel/install/pay/"+(new Date).getTime()+".png",r,n),l.subscribe(u);case 13:case"end":return a.stop()}},a,e)}))()},commitApplay:function(){var t=this;return this.dataForm.payerName?this.dataForm.payImage?void Object(u.q)(this.dataForm).done(function(e){console.log("门锁工单对公转账",e),l.c.success(e.msg),setTimeout(function(){t.$router.go(-1)},900)}):(Object(l.c)("请添加付款截图"),!1):(Object(l.c)("请输入付款方名称"),!1)}}}}).call(e,a("4y+j"))},u4KV:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Zsi2"),i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"pay_box"}},["online"==t.$route.query.type&&"0"==t.status?a("div",{staticStyle:{margin:"20px",background:"#fff"}},[a("div",[a("div",{staticClass:"online_title"},[t._v(t._s(t.payTitle))]),t._v(" "),a("div",{staticStyle:{"font-weight":"bold","margin-top":"10px","font-size":"1rem"}},[t._v("¥"+t._s(t._f("point")(Number(t.price))))]),t._v(" "),a("img",{staticStyle:{width:"100%"},attrs:{src:t.code,alt:""}}),t._v(" "),t._m(0)])]):"online"==t.$route.query.type&&"1"==t.status?a("div",{staticStyle:{background:"#f6f6f6","margin-top":"20%"}},[a("div",[a("van-icon",{attrs:{name:"checked",size:"40px",color:"#7CD862"}}),t._v(" "),a("div",[t._v("支付完成")])],1),t._v(" "),a("van-button",{staticClass:"pay_button"},[t._v("确定")])],1):"pay"==t.$route.query.type&&t.currentInfo?a("div",{staticStyle:{margin:"0"}},[a("van-field",{staticStyle:{"margin-top":"10px"},attrs:{readonly:"",label:"付款方式",value:"对公转账","input-align":"right"}}),t._v(" "),a("van-field",{attrs:{readonly:"",label:"公司名称","input-align":"right"},model:{value:t.currentInfo.companyName,callback:function(e){t.$set(t.currentInfo,"companyName",e)},expression:"currentInfo.companyName"}}),t._v(" "),a("van-field",{attrs:{readonly:"",label:"开户行","input-align":"right"},model:{value:t.currentInfo.bankAccountName,callback:function(e){t.$set(t.currentInfo,"bankAccountName",e)},expression:"currentInfo.bankAccountName"}}),t._v(" "),a("van-field",{attrs:{readonly:"",label:"银行账号","input-align":"right"},model:{value:t.currentInfo.bankAccount,callback:function(e){t.$set(t.currentInfo,"bankAccount",e)},expression:"currentInfo.bankAccount"}}),t._v(" "),a("van-field",{staticStyle:{"margin-top":"10px"},attrs:{label:"付款方名称","input-align":"right"},model:{value:t.dataForm.payerName,callback:function(e){t.$set(t.dataForm,"payerName",e)},expression:"dataForm.payerName"}}),t._v(" "),a("div",{staticClass:"url_box"},[a("div",[t._v("付款截图")]),t._v(" "),a("div",{staticStyle:{display:"flex","align-items":"center"}},[t._l(t.photos,function(t,e){return a("div",{key:e,staticStyle:{"margin-right":"2px"}},[a("img",{staticStyle:{width:"70px",height:"70px"},attrs:{src:t.content}})])}),t._v(" "),a("van-uploader",{staticClass:"picBox",attrs:{"after-read":t.upLoadToQiniu,"upload-text":"点击上传"}})],2)]),t._v(" "),a("van-button",{staticClass:"pay_button",on:{click:t.commitApplay}},[t._v("提交审核")])],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{display:"flex",padding:"0px 40px","justify-content":"space-between"}},[e("img",{staticClass:"w50",attrs:{src:a("UWzS"),alt:""}}),this._v(" "),e("img",{staticClass:"w50",attrs:{src:a("r9Ng"),alt:""}})])}]};var r=function(t){a("0HOB")},o=a("k6Sl")(n.a,i,!1,r,"data-v-86840ad0",null);e.default=o.exports}});
//# sourceMappingURL=47.20c37da4f18dbab69d7c1758771190591.js.map