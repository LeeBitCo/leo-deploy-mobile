webpackJsonp([108],{i1uc:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("RmFe"),s=a.n(i),n=a("s/fh"),r=a("1Wd6"),l={data:function(){return{time_show:!1,price_show:!1,times:null,cYearM:"",currentDate:new Date,maxDate:new Date,listLoading:!1,finishedList:!1,pullLoading:!1,listData:[],comment_nums:"",totleNum:null,dataForm:{pageNum:0,pageSize:1e4,hotelId:this.$route.query.hotelId,userId:this.$route.query.userId,status:"2",endTime:""},editDataForm:{cleanAmount:null,remark:null,cleanOrderId:null,cleaningOrderId:null},allDataForm:{hotelId:this.$route.query.hotelId,endTime:""},refData:null,cleanOrderType:null,selected:"1",key:0,contentKey:0,priceAll:0}},filters:{filterAmount:function(e){return e?"￥"+e.toFixed(2):"￥0"}},created:function(){this.refData=this.userId||"",this.$store.commit("setHeader","保洁统计");var e=s()().valueOf(),t=s()(e).year(),a=s()(e).month()+1<10?"0"+(s()(e).month()+1):s()(e).month()+1;this.cYearM=t+"年"+a+"月",this.dataForm.endTime=t+"-"+a,this.getCurrentInfo()},methods:{getCurrentInfo:function(){var e=this,t=null;1==this.selected?(t=r.e,this.dataForm.pageNum=0):2==this.selected?(t=r.c,this.dataForm.pageNum=0):(this.allDataForm.endTime=this.dataForm.endTime,t=r.d),t(t==r.d?this.allDataForm:this.dataForm).done(function(t){e.listData=[],e.priceAll=0,e.totleNum=0,t.data.length>0&&(e.priceAll=t.data.reduce(function(e,t){return e+(t.cleanAmount||0)},0),e.totleNum=t.data.length,e.dealArr(t.data))}),this.dataForm.pageNum++},dealArr:function(e){if(0!=e.length){var t={};e.map(function(e){e.myendTime=s()(e.endTime).format("YYYY-MM-DD"),t[e.myendTime]?t[e.myendTime].push(e):t[e.myendTime]=[e]});var a=[];for(var i in t){var n={};n.time=i,n.child=t[i],n.status=!1,n.totlePrice=t[i].reduce(function(e,t){return e+(t.cleanAmount||0)},0),a.push(n)}++this.contentKey,a.find(function(e,t){return 0==t}).status=!0,this.listData=a}},dealTime:function(e){var t=s()(e).year(),a=s()(e).month()+1<10?"0"+(s()(e).month()+1):s()(e).month()+1;this.cYearM=t+"年"+a+"月",this.dataForm.endTime=t+"-"+a,this.getCurrentInfo()},confirmTime:function(e){this.dealTime(s()(e).valueOf()),this.time_show=!1},editPrice:function(e){this.editDataForm.cleanAmount=e.cleanAmount||0,this.editDataForm.cleanOrderId=e.id,this.editDataForm.remark=e.description,this.cleanOrderType=e.cleanOrderType,this.price_show=!0},confirmDepart:function(e,t){var a=this;if("confirm"==e){if(t(!1),!this.editDataForm.cleanAmount)return void Object(n.c)("请输入保洁金额");var i=null;"0"==this.selected?"1"==this.cleanOrderType?(i=r.m,delete this.editDataForm.cleanOrderId):(i=r.n,delete this.editDataForm.cleaningOrderId):"1"==this.selected?(i=r.n,delete this.editDataForm.cleaningOrderId):"2"==this.selected&&(i=r.m,delete this.editDataForm.cleanOrderId),i(this.editDataForm).done(function(e){Object(n.c)(e.msg),a.getCurrentInfo()}),this.price_show=!1}else"cancel"==e&&(t(!1),this.price_show=!1)}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{style:{top:e.$route.query.userId?"50px":"103px"},attrs:{id:"cleaningTaskTop"}},[a("div",[a("div",{staticClass:"task-top"},[a("div",{staticClass:"top-left",on:{click:function(t){e.time_show=!0}}},[a("span",[e._v(e._s(e.cYearM))]),e._v(" "),a("van-icon",{attrs:{name:"arrow-down"}})],1),e._v(" "),a("div",[a("mt-navbar",{nativeOn:{click:function(t){return e.getCurrentInfo()}},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[e.$route.query.userId?e._e():a("mt-tab-item",{attrs:{id:"0"}},[a("span",[e._v("全部")])]),e._v(" "),a("mt-tab-item",{attrs:{id:"1"}},[a("span",[e._v("退房打扫")])]),e._v(" "),a("mt-tab-item",{attrs:{id:"2"}},[a("span",[e._v("续住打扫")])])],1)],1)]),e._v(" "),a("div",{staticClass:"totleAll"},[a("div",[e._v("\n        共完成"),a("span",{staticClass:"c_00 f18"},[e._v(e._s(e.totleNum))]),e._v("单"+e._s("清洁")+"任务，合计收入\n      ")]),e._v(" "),a("div",{staticClass:"c_00 f20"},[e._v(e._s(e._f("filterAmount")(e.priceAll||0)))])]),e._v(" "),a("div",{key:e.contentKey,staticClass:"task-list"},[a("div",e._l(e.listData,function(t,i){return a("div",{key:i},[a("div",{staticClass:"task",on:{click:function(e){t.status=!t.status}}},[a("div",{staticClass:"task-left"},[a("div",{staticClass:"g_fw",staticStyle:{"font-size":"15px"}},[e._v(e._s(e._f("dataFilter")(t.time,"MM月DD日")))]),e._v(" "),a("div",{staticClass:"f12"},[e._v(e._s("共完成"+t.child.length+"单"))])]),e._v(" "),a("div",{staticClass:"task-right task-right-top"},[a("div",[e._v(e._s(e._f("filterAmount")(t.totlePrice)))]),e._v(" "),a("van-icon",{staticStyle:{"margin-left":"5px"},attrs:{name:0==t.status?"arrow":"arrow-down"}})],1)]),e._v(" "),t.status?a("div",{key:e.key},e._l(t.child,function(t,i){return a("div",{key:i,staticClass:"task"},[a("div",{staticClass:"task-left"},[a("div",[e._v(e._s(t.roomScale.scaleName)+" "+e._s(t.roomSn)+" "),e.$route.query.userId||"0"!=e.selected?e._e():a("span",{class:1==t.cleanOrderType?"go":"back",staticStyle:{"font-size":"12px"}},[e._v(e._s(1==t.cleanOrderType?"续住":"退房"))])]),e._v(" "),a("div",{staticClass:"f12"},[e._v(e._s(t.endTime.substr(11))+" "),!e.$route.query.userId&&t.sysUser?a("span",[e._v(e._s(t.sysUser.realName))]):e._e()])]),e._v(" "),a("div",{staticClass:"task-right",on:{click:function(a){return e.editPrice(t)}}},[a("div",[a("div",[e._v(e._s(e._f("filterAmount")(t.cleanAmount)))]),e._v(" "),t.description?a("div",{staticClass:"f12"},[e._v("备注："+e._s(t.description))]):e._e()]),e._v(" "),a("van-icon",{staticStyle:{"margin-left":"5px"},attrs:{name:"arrow"}})],1)])}),0):e._e()])}),0)])]),e._v(" "),a("van-popup",{attrs:{position:"bottom"},model:{value:e.time_show,callback:function(t){e.time_show=t},expression:"time_show"}},[a("van-datetime-picker",{staticClass:"timeBox",attrs:{type:"year-month","max-date":e.maxDate},on:{cancel:function(t){e.time_show=!1},confirm:e.confirmTime},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1),e._v(" "),a("van-dialog",{attrs:{title:"0"==e.selected?0==e.cleanOrderType?"清洁金额":"保洁金额":"1"==e.selected?"清洁金额":"保洁金额","show-cancel-button":"","before-close":e.confirmDepart},model:{value:e.price_show,callback:function(t){e.price_show=t},expression:"price_show"}},[a("van-cell-group",[a("van-field",{attrs:{label:"0"==e.selected?0==e.cleanOrderType?"清洁金额":"保洁金额":"1"==e.selected?"清洁金额":"保洁金额",placeholder:"0"==e.selected?0==e.cleanOrderType?"请输入清洁金额":"请输入保洁金额":"1"==e.selected?"清洁金额":"保洁金额"},model:{value:e.editDataForm.cleanAmount,callback:function(t){e.$set(e.editDataForm,"cleanAmount",t)},expression:"editDataForm.cleanAmount"}}),e._v(" "),a("van-field",{attrs:{label:"备注",placeholder:"请输入备注"},model:{value:e.editDataForm.remark,callback:function(t){e.$set(e.editDataForm,"remark",t)},expression:"editDataForm.remark"}})],1)],1)],1)},staticRenderFns:[]};var c=a("k6Sl")(l,o,!1,function(e){a("ibEJ")},"data-v-4545b99e",null);t.default=c.exports},ibEJ:function(e,t){}});
//# sourceMappingURL=108.1b1d17622ee0c6c405d01758782009845.js.map