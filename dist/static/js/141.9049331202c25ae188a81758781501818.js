webpackJsonp([141],{"3Qc5":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("UJbh"),s=i("T6yf"),o=i("s/fh"),l={components:{},data:function(){return{listLoading:!1,finishedList:!1,pullLoading:!1,showReject:!1,showPay:!1,applyList:[],auditApprovalType:{},statusAll:{0:"申请中",1:"被驳回",2:"申请通过",3:"已取消"},dataForm:{pageNum:0,pageSize:10},auditFailReason:null,selected:"1",roles:[]}},filters:{filterAmount:function(t){return t.toFixed(2)}},created:function(){this.$store.commit("setHeader","申请列表"),this.getType()},methods:{getType:function(){var t=this;Object(a.a)({dictType:"business_audit_approval_type"}).done(function(e){e.data.map(function(e){t.auditApprovalType[e.dictValue]=e.dictLabel}),t.onLoadList()})},chooseSelected:function(){this.applyList=[],this.dataForm.pageNum=0,this.onLoadList()},onPullRefresh:function(){this.applyList=[],this.dataForm.pageNum=0,this.finishedList=!1,this.onLoadList()},onLoadList:function(){var t=this;1==this.selected?(Object(s.d)(this.dataForm).done(function(e){t.applyList=t.applyList.concat(e.data),t.listLoading=t.pullLoading=!1,e.total==t.applyList.length?t.finishedList=!0:e.total>t.applyList.length&&(t.finishedList=!1)}),this.dataForm.pageNum++):(Object(s.b)(this.dataForm).done(function(e){t.applyList=t.applyList.concat(e.data),t.listLoading=t.pullLoading=!1,e.total==t.applyList.length?t.finishedList=!0:e.total>t.applyList.length&&(t.finishedList=!1)}),this.dataForm.pageNum++)},btnReject:function(t){this.showReject=!0,this.rejectInfo=t},confirmReject:function(t,e){var i=this;if("confirm"==t){if(!this.auditFailReason)return Object(o.c)("请输入驳回原因"),void e(!1);var a={auditApprovalId:this.rejectInfo.id,auditFailReason:this.auditFailReason};Object(s.j)(a).done(function(t){o.c.success(t.msg),i.showReject=!1,e(!1),i.getType(),setTimeout(function(){i.$router.go(0)},900)}).then(function(t){i.showReject=!1,i.auditFailReason=null,e(!1)})}else"cancel"==t&&(e(!1),this.auditFailReason=null,this.showReject=!1)},passApply:function(t){var e=this;o.a.confirm({title:"通过申请"}).then(function(){Object(s.i)({auditApprovalId:t.id}).done(function(t){o.c.success(t.msg),e.getType(),setTimeout(function(){e.$router.go(0)},900)})}).catch(function(){console.log("不通过")})},goNext:function(t,e){"2"==this.selected?this.$router.push({path:t,query:{auditApprovalId:e.auditApprovalId,applyType:e.auditApproval.applyType}}):this.$router.push({path:t,query:{auditApprovalId:e.id,hotelId:this.$route.query.hotelId,applyHotelId:e.hotelId,role:e.role,applyType:e.applyType}})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("mt-navbar",{nativeOn:{click:function(e){return t.chooseSelected.apply(null,arguments)}},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[a("mt-tab-item",{attrs:{id:"1"}},[a("span",[t._v("待处理审批")])]),t._v(" "),a("mt-tab-item",{attrs:{id:"2"}},[a("span",[t._v("已处理审批")])])],1),t._v(" "),t.applyList.length>0?a("div",{staticClass:"scroll"},[a("van-pull-refresh",{attrs:{"success-text":"刷新成功"},on:{refresh:t.onPullRefresh},model:{value:t.pullLoading,callback:function(e){t.pullLoading=e},expression:"pullLoading"}},[a("van-list",{attrs:{offset:30,finished:t.finishedList,"finished-text":"没有更多了"},on:{load:t.onLoadList},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},t._l(t.applyList,function(e,i){return a("div",{key:i,staticStyle:{background:"#fff",padding:"10px 0","margin-bottom":"10px"},on:{click:function(i){return t.goNext("edit-or-see-apply",e)}}},[e.hotel?a("div",{staticClass:"info-hotel"},[a("div",{staticClass:"hotel-left"},[a("div",{staticStyle:{width:"80px","margin-right":"8px"}},[a("img",{staticClass:"left-img",attrs:{src:e.hotel.logo}})]),t._v(" "),a("div",{staticClass:"left-title"},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("div",{staticClass:"c_000"},[t._v(t._s(e.hotel.hotelName))]),t._v(" "),t.auditApprovalType?a("div",{staticStyle:{"font-size":"12px",border:"1px solid #E5E2E5",padding:"2px","margin-left":"8px"}},[t._v(t._s(t.auditApprovalType[e.applyType||e.auditApproval.applyType]))]):t._e()]),t._v(" "),a("div",{staticClass:"adr"},[t._v(t._s(e.hotel.location||"暂无"))]),t._v(" "),a("div",{staticStyle:{"font-size":"14px",color:"#888"}},[t._v(t._s(e.hotel.contacts||"暂无")+"\n                  ")])])]),t._v(" "),"1"==t.selected?a("div",{staticClass:"hotel-right"},[a("div",{style:{color:"0"==e.status||"2"==e.status?"#ff7d41":"red"}},[t._v(t._s(t.statusAll[e.status]))])]):a("div",{staticClass:"hotel-right"},[a("div",{style:{color:"0"==e.auditApproval.status||"2"==e.auditApproval.status?"#ff7d41":"red"}},[t._v(t._s(t.statusAll[e.auditApproval.status]))])])]):t._e(),t._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},["1"==t.selected&&"ROLE_AREA_GM"==e.role&&"1"!=e.status||"ROLE_AREA_MANAGER"==e.role&&"1"!=e.status?a("div",{staticClass:"edit-reason",on:{click:function(i){return i.stopPropagation(),t.btnReject(e)}}},[t._v("驳回申请")]):t._e(),t._v(" "),"ROLE_AREA_MANAGER"==e.role?a("div",{staticClass:"edit-reason",on:{click:function(i){return i.stopPropagation(),t.goNext("2"==e.applyType?"edit-or-see-apply":"add-equipment",e)}}},[t._v(t._s("2"==e.applyType?"查看申请":"线下查验"))]):t._e(),t._v(" "),"1"==t.selected&&"ROLE_AREA_GM"==e.role?a("div",{staticClass:"edit-reason",on:{click:function(i){return i.stopPropagation(),t.passApply(e)}}},[t._v("通过申请")]):t._e()])])}),0)],1)],1):a("div",{staticClass:"nothing"},[a("img",{attrs:{src:i("f6cR"),alt:""}}),t._v(" "),a("div",[t._v("没有待审核的酒店")])])],1),t._v(" "),a("van-dialog",{attrs:{"show-cancel-button":"","before-close":t.confirmReject},model:{value:t.showReject,callback:function(e){t.showReject=e},expression:"showReject"}},[a("van-field",{attrs:{rows:"3",type:"textarea",placeholder:"请简述驳回原因"},model:{value:t.auditFailReason,callback:function(e){t.auditFailReason=e},expression:"auditFailReason"}})],1)],1)},staticRenderFns:[]};var c=i("k6Sl")(l,n,!1,function(t){i("x0oi")},"data-v-13482950",null);e.default=c.exports},x0oi:function(t,e){}});
//# sourceMappingURL=141.9049331202c25ae188a81758781501818.js.map