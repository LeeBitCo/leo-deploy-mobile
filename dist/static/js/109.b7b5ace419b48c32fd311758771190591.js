webpackJsonp([109],{UdjD:function(t,a,o){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=o("vvmr"),i=o.n(e),n=o("4jgH"),r=o("s/fh"),c=o("Gwi0"),l=o("TKTC"),d=o("tN5p"),m=o("RmFe"),s=o.n(m),u=o("WjM/"),p=o.n(u);n.default.use(r.b),n.default.use(r.c);var v={name:"add",data:function(){return{stepper:1,dataForm:{cooperationName:null,accountAmount:null,hotelId:null,cooperationSn:null,contact:"",phone:"",cooperDiscount:1,billCycle:"1",accountLimit:"",bankAccount:"",taxAccount:"",location:"",bankName:"",cooperType:"2",lifeCost:"1"},exportForm:{cooperId:this.$route.query.accountUnitId,cooperName:null,exportDate:null,email:null},minDate:null,maxDate:null,currentDate:new Date,checked:!1,commitReadonly:!0,show_export:!1,show_time:!1,columns:[],columnsAll:[],commitTitle:"编辑"}},created:function(){this.commitTitle=this.$route.query.accountUnitId?"编辑":"添加",this.$store.commit("setHeader",(this.$route.query.accountUnitId?"编辑":"添加")+"协议单位"),this.dataForm.hotelId=this.$route.query.hotelId,this.maxDate=new Date(s()()),this.minDate=new Date(s()().subtract(3,"year")),this.exportForm.exportDate=s()().format("YYYY-MM"),this.$route.query.accountUnitId&&(this.dataForm.accountUnitId=this.$route.query.accountUnitId,this.getInfoById())},computed:{cooperDiscount:{get:function(){return 10*this.dataForm.cooperDiscount},set:function(t){this.dataForm.cooperDiscount=t/10}},billCycle:{get:function(){var t=this;if(this.columnsAll&&this.columnsAll.length)return this.columnsAll.find(function(a){return t.dataForm.billCycle==a.dictValue}).dictLabel+" ＞"},set:function(t){}}},methods:{goNext:function(t){this.$router.push({path:t,query:{cooperId:this.$route.query.accountUnitId,hotelId:this.dataForm.hotelId,accountAmount:this.dataForm.accountAmount}})},getInfoById:function(){var t=this;Object(d.n)({cooperationId:this.dataForm.accountUnitId}).done(function(a){t.dataForm=i()({},t.dataForm,a.data),t.checked="1"==t.dataForm.lifeCost})},validator:function(t){return/^1[3-9][0-9]\d{8}$/.test(t)},validatorEmail:function(t){return/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(t)},removeUnit:function(){var t=this;r.a.confirm({title:"确定删除?",message:this.dataForm.cooperationName}).then(function(){Object(l.j)({cooperationId:t.dataForm.accountUnitId}).done(function(a){r.c.success(a.msg),setTimeout(function(){t.$router.go(-1)},2e3)})}).catch(function(){})},formatter:function(t,a){return"year"==t?a+"年":"month"==t?a+"月":a},onConfirmTime:function(t){this.show_time=!1,this.exportForm.exportDate=s()(t).format("YYYY-MM")},confirmExport:function(){var t=this;this.exportForm.cooperName=this.dataForm.cooperationName,this.exportForm.exportDate=this.exportForm.exportDate||s()(this.currentDate).format("YYYY-MM"),this.exportForm.email?(Object(c._37)(this.exportForm).done(function(t){Object(r.c)({message:t.msg,duration:900})}),this.show_export=!1):p()({method:"post",url:"/api/business/life/cost/bill/cooper/export",params:this.exportForm,responseType:"arraybuffer"}).then(function(a){var o=a.data;t.show_export=!1;var e=window.URL.createObjectURL(new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),i=document.createElement("a");i.style.display="none",i.href=e,i.setAttribute("download","生活账单表"),document.body.appendChild(i),i.click(),document.body.removeChild(i)})},onSubmit:function(){var t=this;if("编辑"==this.commitTitle)return this.commitTitle="保存",void(this.commitReadonly=!1);this.dataForm.lifeCost=1==this.checked?"1":"0",this.dataForm.accountUnitId?Object(l.i)(this.dataForm).done(function(a){r.c.success(a.msg),setTimeout(function(){t.$router.go(-1)},2e3)}):Object(l.g)(this.dataForm).done(function(a){r.c.success(a.msg),setTimeout(function(){t.$router.go(-1)},2e3)})}}},h={render:function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("div",{staticClass:"group"},[o("van-form",{on:{submit:t.onSubmit}},[o("van-field",{attrs:{name:"cooperationName",label:"单位名称",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"请输入单位名称",rules:[{required:!0,message:"请填写请输入单位名称"}]},model:{value:t.dataForm.cooperationName,callback:function(a){t.$set(t.dataForm,"cooperationName",a)},expression:"dataForm.cooperationName"}}),t._v(" "),o("van-field",{attrs:{name:"cooperationSn",label:"单位编号",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"请输入单位编号",rules:[{required:!0,message:"请填写请输入单位编号"}]},model:{value:t.dataForm.cooperationSn,callback:function(a){t.$set(t.dataForm,"cooperationSn",a)},expression:"dataForm.cooperationSn"}}),t._v(" "),o("van-field",{attrs:{name:"contact",label:"联系人",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"请输入联系人",rules:[{required:!0,message:"请填写联系人"}]},model:{value:t.dataForm.contact,callback:function(a){t.$set(t.dataForm,"contact",a)},expression:"dataForm.contact"}}),t._v(" "),o("van-field",{attrs:{name:"phone",label:"联系电话",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",maxlength:"11",placeholder:"请输入联系电话",rules:[{required:!0,message:"请填写联系电话"},{validator:t.validator,message:"请填写正确的联系电话"}]},model:{value:t.dataForm.phone,callback:function(a){t.$set(t.dataForm,"phone",a)},expression:"dataForm.phone"}}),t._v(" "),o("van-field",{attrs:{name:"email",label:"电子邮箱",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"请输入电子邮箱",rules:[{validator:t.validatorEmail,message:"请填写正确格式的邮箱"}]},model:{value:t.dataForm.email,callback:function(a){t.$set(t.dataForm,"email",a)},expression:"dataForm.email"}}),t._v(" "),o("div",{staticClass:"switch",staticStyle:{"margin-top":"10px"},on:{click:function(a){return t.goNext("/account-balance")}}},[o("div",[t._v("账户余额")]),t._v(" "),o("div",{staticStyle:{display:"flex"}},[o("div",[t._v(t._s(t.dataForm.accountAmount))]),t._v(" "),o("van-icon",{attrs:{name:"arrow"}})],1)]),t._v(" "),o("div",{staticClass:"switch"},[o("div",[t._v("余额支付生活账单")]),t._v(" "),o("van-switch",{attrs:{"active-color":"#ff7d41",disabled:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),size:"20px"},model:{value:t.checked,callback:function(a){t.checked=a},expression:"checked"}})],1),t._v(" "),t.dataForm.id?o("div",{staticClass:"switch",staticStyle:{"margin-top":"10px"},on:{click:function(a){t.exportForm.email=null,t.show_export=!0}}},[o("div",[t._v("生活账单表")]),t._v(" "),o("div",{staticStyle:{display:"flex","align-items":"center"}},[o("div",[t._v("点击导出")]),t._v(" "),o("van-icon",{attrs:{name:"arrow"}})],1)]):t._e(),t._v(" "),o("van-field",{staticStyle:{"margin-top":"12px"},attrs:{name:"cooperDiscount",type:"number",label:"折扣",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"请输入折扣",rules:[{required:!0,message:"请填写请输入折扣"}]},model:{value:t.cooperDiscount,callback:function(a){t.cooperDiscount=a},expression:"cooperDiscount"}}),t._v(" "),o("van-field",{attrs:{name:"accountLimit",type:"number",label:"挂账额度",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"请输入挂账额度",rules:[{required:!0,message:"请填写挂账额度"}]},model:{value:t.dataForm.accountLimit,callback:function(a){t.$set(t.dataForm,"accountLimit",a)},expression:"dataForm.accountLimit"}}),t._v(" "),o("van-field",{staticStyle:{"margin-top":"13px",color:"#000000"},attrs:{readonly:"",label:"财务信息"}}),t._v(" "),o("van-field",{attrs:{name:"bankAccount",label:"银行账户",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"选填"},model:{value:t.dataForm.bankAccount,callback:function(a){t.$set(t.dataForm,"bankAccount",a)},expression:"dataForm.bankAccount"}}),t._v(" "),o("van-field",{attrs:{name:"bankName",label:"开户行",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"选填"},model:{value:t.dataForm.bankName,callback:function(a){t.$set(t.dataForm,"bankName",a)},expression:"dataForm.bankName"}}),t._v(" "),o("van-field",{attrs:{name:"taxAccount",label:"税号",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"选填"},model:{value:t.dataForm.taxAccount,callback:function(a){t.$set(t.dataForm,"taxAccount",a)},expression:"dataForm.taxAccount"}}),t._v(" "),o("van-field",{attrs:{name:"location",label:"公司地址",readonly:!(!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly),"input-align":!t.dataForm.id||t.dataForm.id&&0==t.commitReadonly?"left":"right",placeholder:"选填"},model:{value:t.dataForm.location,callback:function(a){t.$set(t.dataForm,"location",a)},expression:"dataForm.location"}}),t._v(" "),o("div",{staticStyle:{margin:"16px"}},[o("van-button",{staticClass:"submit-btn",attrs:{block:"","native-type":"submit"}},[t._v("\n        "+t._s(t.commitTitle)+"\n      ")])],1)],1),t._v(" "),t.$route.query.accountUnitId?o("van-button",{staticClass:"remove-btn",on:{click:t.removeUnit}},[t._v("删除协议单位")]):t._e(),t._v(" "),o("van-popup",{staticStyle:{width:"90%"},attrs:{round:""},model:{value:t.show_export,callback:function(a){t.show_export=a},expression:"show_export"}},[o("div",{staticClass:"f16"},[t._v("导出账单")]),t._v(" "),o("div",{staticClass:"flex_box",staticStyle:{"align-items":"center"}},[o("div",[t._v("选择月份")]),t._v(" "),o("div",{staticClass:"box_right",on:{click:function(a){t.show_time=!0}}},[o("div",[t._v(t._s(t.exportForm.exportDate))]),t._v(" "),o("van-icon",{attrs:{name:"arrow-down"}})],1)]),t._v(" "),o("div",{staticClass:"flex_box",staticStyle:{"margin-top":"30px"}},[o("div",[t._v("电子邮箱")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.exportForm.email,expression:"exportForm.email"}],staticClass:"box_right",staticStyle:{"text-indent":"1em"},attrs:{type:"email",placeholder:"请输入邮箱账号"},domProps:{value:t.exportForm.email},on:{input:function(a){a.target.composing||t.$set(t.exportForm,"email",a.target.value)}}})]),t._v(" "),o("van-button",{staticClass:"payedColor",on:{click:t.confirmExport}},[t._v("确定导出")])],1),t._v(" "),o("van-popup",{staticStyle:{width:"90%"},attrs:{"close-on-click-overlay":!1},model:{value:t.show_time,callback:function(a){t.show_time=a},expression:"show_time"}},[o("van-datetime-picker",{attrs:{type:"year-month",title:"选择年月","min-date":t.minDate,"max-date":t.maxDate,formatter:t.formatter},on:{confirm:t.onConfirmTime,cancel:function(a){t.show_time=!1}},model:{value:t.currentDate,callback:function(a){t.currentDate=a},expression:"currentDate"}})],1)],1)},staticRenderFns:[]};var f=o("k6Sl")(v,h,!1,function(t){o("VycG")},"data-v-44653984",null);a.default=f.exports},VycG:function(t,a){}});
//# sourceMappingURL=109.b7b5ace419b48c32fd311758771190591.js.map