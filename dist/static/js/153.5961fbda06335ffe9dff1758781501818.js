webpackJsonp([153],{"8ThH":function(a,o){},a1WL:function(a,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var l=t("vvmr"),e=t.n(l),d=t("s/fh"),s=t("UJbh"),r=t("44Rm"),i=t("Gwi0"),n={data:function(){return{readonly:!0,show_scale:!1,show_level:!1,show_lock:!1,show_person:!1,isRepeat:!1,ROLE_MANAGER:!1,scaleAll:[],levelAll:[],hotelLockTypeAll:[],lockInstallOldAll:[],doorTypeOldAll:[],personAll:[],hotelLockType:"0",lockInstall:null,roomLevel:null,scaleName:null,landlord:null,doorType:null,c_hotelType:null,buttonContent:"修改信息",dataForm:{hotelId:this.$route.query.hotelId,id:null,roomSn:null,roomScaleId:null,buildNum:null,unit:null,floor:null,hotelLockType:null,roomLevel:null,lockInstall:null,doorType:null,roomSort:null,bedNum:null,landlord:null,maCommission:null},roomSortRules:[{validator:function(a){return a<1e4},message:"分房排序不能大于10000",trigger:"onBlur"}],roomMaCommision:[{validator:function(a){return 0<a&&a<100},message:"管理提成须在0-100之间",trigger:"onBlur"}]}},created:function(){var a=this;this.$store.commit("setHeader","房间信息"),"1"==JSON.parse(localStorage.getItem("current_user")).id?this.ROLE_MANAGER=!0:(this.roles=JSON.parse(localStorage.getItem("roles")),this.roles.some(function(o){return"ROLE_MANAGER"==o.name?a.ROLE_MANAGER=!0:a.ROLE_MANAGER=!1})),this.c_hotelType=JSON.parse(localStorage.getItem("c_hotelType")),this.$route.query.id?this.getCurrentInfo():(this.readonly=!1,this.getType())},methods:{getCurrentInfo:function(){var a=this;Object(i._3)(this.$route.query.id).done(function(o){a.dataForm=e()({},a.dataForm,o.data),a.getType()})},getType:function(){var a=this;Object(s.a)({dictType:"business_room_level"}).done(function(o){a.levelOldAll=o.data,a.levelAll=o.data.map(function(a){return a.dictLabel}),a.dataForm.id?a.dataForm.roomLevel?a.roomLevel=a.levelOldAll.find(function(o){return o.dictValue==a.dataForm.roomLevel}).dictLabel:a.roomLevel="":(a.roomLevel=a.levelOldAll[0].dictLabel,a.dataForm.roomLevel=a.levelOldAll[0].dictValue)}),Object(s.a)({dictType:"business_lock_install_type"}).done(function(o){a.hotelLockTypeOldAll=o.data,a.hotelLockTypeAll=o.data.map(function(a){return a.dictLabel}),a.dataForm.id?a.dataForm.hotelLockType?a.hotelLockType=a.hotelLockTypeOldAll.find(function(o){return o.dictValue==a.dataForm.hotelLockType}).dictLabel:a.hotelLockType="":(a.hotelLockType=a.hotelLockTypeOldAll[0].dictLabel,a.dataForm.hotelLockType=a.hotelLockTypeOldAll[0].dictValue)}),Object(s.a)({dictType:"business_room_door_install"}).done(function(o){a.lockInstallOldAll=o.data,a.lockInstallAll=o.data.map(function(a){return a.dictLabel}),a.dataForm.id?a.dataForm.lockInstall?a.lockInstall=a.lockInstallOldAll.find(function(o){return o.dictValue==a.dataForm.lockInstall}).dictLabel:a.lockInstall="":(a.lockInstall=a.lockInstallOldAll[0].dictLabel,a.dataForm.lockInstall=a.lockInstallOldAll[0].dictValue)}),Object(s.a)({dictType:"business_room_door_type"}).done(function(o){a.doorTypeOldAll=o.data,a.dataForm.id?a.dataForm.doorType?a.doorType=a.doorTypeOldAll.find(function(o){return o.dictValue==a.dataForm.doorType}).dictLabel:a.doorType="":(a.dataForm.doorType=a.doorTypeOldAll[0].dictValue,a.doorType=a.doorTypeOldAll[0].dictLabel)}),this.HotelStateListGet()},HotelStateListGet:function(){var a=this;Object(r.h)({hotelId:this.$route.query.hotelId}).then(function(o){o.data.unshift({scaleName:"无",roomScaleId:"无",id:"0"}),a.scaleOldAll=o.data,a.scaleAll=o.data.map(function(a){return a.scaleName}),a.dataForm.id?a.scaleName=a.scaleOldAll.find(function(o){return o.id==a.dataForm.roomScaleId}).scaleName:(a.dataForm.roomScaleId=a.scaleOldAll[0].id,a.scaleName=a.scaleOldAll[0].scaleName)}).catch(function(a){console.log(a)}),"5"==this.c_hotelType&&this.getPersonList()},getPersonList:function(){var a=this;Object(i.u)(this.$route.query.hotelId,{role:"ROLE_HOTEL_OWNER"}).done(function(o){o.data.unshift({userId:"0",sysUser:{realName:"无"}}),a.personAll=o.data.map(function(a){return a.sysUser.realName}),a.personOldAll=o.data,a.$route.query.id?a.dataForm.landlord&&(a.landlord=a.personOldAll.find(function(o){return o.userId==a.dataForm.landlord}).sysUser.realName):(a.dataForm.landlord=a.personOldAll[0].userId,a.landlord=a.personOldAll[0].sysUser.realName)})},onConfirmLevel:function(a){this.roomLevel=a,this.dataForm.roomLevel=this.levelOldAll.find(function(o){return o.dictLabel==a}).dictValue,this.show_level=!1},onConfirmScale:function(a){this.scaleName=a,this.dataForm.roomScaleId=this.scaleOldAll.find(function(o){return o.scaleName==a}).id,this.show_scale=!1},onConfirmLock:function(a){this.hotelLockType=a,this.dataForm.hotelLockType=this.hotelLockTypeOldAll.find(function(o){return o.dictLabel==a}).dictValue,this.show_lock=!1},choosedDoor:function(a){this.dataForm.doorType=a.dictValue,this.doorType=a.dictLabel},onConfirmPenson:function(a){this.landlord=a,this.dataForm.landlord=this.personOldAll.find(function(o){return o.sysUser.realName==a}).userId,this.show_person=!1},removeRoom:function(){var a=this;d.a.confirm({title:"确定删除？",message:"房间号："+this.dataForm.roomSn}).then(function(){Object(r.x)({roomId:a.dataForm.id}).done(function(a){Object(d.c)(a.msg),setTimeout("window.history.go(-1)",900)})}).catch(function(){})},onSubmit:function(){var a=this;return 1!=this.isRepeat&&(1==this.readonly?(this.readonly=!1,this.$store.commit("setHeader","修改信息"),void(this.buttonContent="保存修改")):void(this.dataForm.roomSn?(this.dataForm.mac||(this.dataForm.lockInstall=this.lockInstallOldAll.find(function(o){return o.dictLabel==a.lockInstall}).dictValue),"无"==this.dataForm.roomScaleId&&delete this.dataForm.roomScaleId,this.dataForm.id?(this.dataForm_edit={hotelId:this.dataForm.hotelId,id:this.dataForm.id,roomSn:this.dataForm.roomSn,roomScaleId:this.dataForm.roomScaleId,buildNum:this.dataForm.buildNum,unit:this.dataForm.unit,floor:this.dataForm.floor,hotelLockType:this.dataForm.hotelLockType,roomLevel:this.dataForm.roomLevel,lockInstall:this.dataForm.lockInstall,doorType:this.dataForm.doorType,roomSort:this.dataForm.roomSort,landlord:this.dataForm.landlord,bedNum:this.dataForm.bedNum,maCommission:this.dataForm.maCommission},Object(r.w)(this.dataForm_edit).done(function(a){Object(d.c)(a.msg),setTimeout("window.history.go(-1)",900)})):(delete this.dataForm.id,this.dataForm.isGate=0,this.dataForm.roomName=this.dataForm.roomSn,"无"==this.landlord&&(delete this.dataForm.landlord,delete this.dataForm.maCommission),Object(r.v)(this.dataForm).done(function(o){a.isRepeat=!0,Object(d.c)(o.msg),setTimeout("window.history.go(-1)",900)}))):Object(d.c)("请输入房间编号")))}}},c={render:function(){var a=this,o=a.$createElement,t=a._self._c||o;return t("div",{attrs:{id:"addRooms_box"}},[t("van-form",{attrs:{id:"scroll-pro"},on:{submit:a.onSubmit}},[!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-field",{attrs:{maxlength:"20",readonly:!("1"!=a.dataForm.syn||!a.dataForm.id||!a.dataForm.mac||0!=a.ROLE_MANAGER),label:"房间号",placeholder:"请输入房间号"},model:{value:a.dataForm.roomSn,callback:function(o){a.$set(a.dataForm,"roomSn",o)},expression:"dataForm.roomSn"}}):t("div",{staticClass:"scale_box between"},[t("div",{staticClass:"w6"},[a._v("房间号")]),a._v(" "),t("div",{staticClass:"flex c_00"},[a._v(a._s(a.dataForm.roomSn))])]),a._v(" "),t("div",{staticClass:"scale_box",class:a.dataForm.id&&1==a.readonly?"between":""},[t("div",{staticClass:"w6"},[a._v("基础房型")]),a._v(" "),t("div",{staticClass:"flex c_00",on:{click:function(o){(!a.dataForm.id||a.dataForm.id&&0==a.readonly)&&(a.show_scale=!0)}}},[t("div",[a._v(a._s(a.scaleName))]),a._v(" "),!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-icon",{attrs:{name:"arrow"}}):a._e()],1)]),a._v(" "),!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-field",{staticStyle:{"margin-top":"10px"},attrs:{readonly:!("0"==a.dataForm.syn&&1==a.ROLE_MANAGER||!a.dataForm.id),maxlength:"5",label:"楼栋号",placeholder:"请输入楼栋号"},model:{value:a.dataForm.buildNum,callback:function(o){a.$set(a.dataForm,"buildNum",o)},expression:"dataForm.buildNum"}}):a._e(),a._v(" "),!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-field",{attrs:{readonly:!("0"==a.dataForm.syn&&1==a.ROLE_MANAGER||!a.dataForm.id),maxlength:"5",label:"单元号",placeholder:"请输入单元号"},model:{value:a.dataForm.unit,callback:function(o){a.$set(a.dataForm,"unit",o)},expression:"dataForm.unit"}}):a._e(),a._v(" "),!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-field",{attrs:{type:"number",readonly:!("0"==a.dataForm.syn&&1==a.ROLE_MANAGER||!a.dataForm.id),label:"楼层",placeholder:"请输入楼层"},model:{value:a.dataForm.floor,callback:function(o){a.$set(a.dataForm,"floor",o)},expression:"dataForm.floor"}}):t("div",{staticClass:"scale_box",class:a.dataForm.id?"between":"",staticStyle:{"margin-top":"10px"}},[t("div",{staticClass:"w6"},[a._v("房间地址")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.dataForm.buildNum)+"栋"+a._s(a.dataForm.unit)+"单元"+a._s(a.dataForm.floor)+"层")])])]),a._v(" "),t("div",{staticClass:"scale_box",class:a.dataForm.id&&1==a.readonly?"between":"",style:{"margin-top":a.dataForm.id?"10px":""},on:{click:function(o){(!a.dataForm.id||a.dataForm.id&&0==a.readonly)&&(a.show_level=!0)}}},[t("div",{staticClass:"w6"},[a._v("房间等级")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.roomLevel))]),a._v(" "),!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-icon",{attrs:{name:"arrow"}}):a._e()],1)]),a._v(" "),!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-field",{attrs:{type:"number",rules:a.roomSortRules,readonly:a.readonly,label:"分房排序",placeholder:"请输入数字，数字越小越优先分房"},model:{value:a.dataForm.roomSort,callback:function(o){a.$set(a.dataForm,"roomSort",o)},expression:"dataForm.roomSort"}}):t("div",{staticClass:"scale_box",class:a.dataForm.id&&1==a.readonly?"between":""},[t("div",{staticClass:"w6"},[a._v("分房排序")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.dataForm.roomSort))])])]),a._v(" "),"4"==a.c_hotelType?t("div",[!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-field",{attrs:{type:"number",rules:a.roomSortRules,readonly:a.dataForm.id&&0==a.readonly,label:"床位",placeholder:"请输入床位数量"},model:{value:a.dataForm.bedNum,callback:function(o){a.$set(a.dataForm,"bedNum",o)},expression:"dataForm.bedNum"}}):t("div",{staticClass:"scale_box",class:a.dataForm.id&&1==a.readonly?"between":""},[t("div",{staticClass:"w6"},[a._v("床位")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.dataForm.bedNum))])])])],1):a._e(),a._v(" "),!a.dataForm.id||a.dataForm.id&&!a.dataForm.mac&&0==a.readonly?t("div",{staticClass:"scale_box",class:a.dataForm.id&&1==a.readonly?"between":"",staticStyle:{"margin-top":"10px"}},[t("div",{staticClass:"w6"},[a._v("门锁类型")]),a._v(" "),t("div",{staticClass:"flex c_00",on:{click:function(o){(!a.dataForm.id||a.dataForm.id&&!a.dataForm.mac&&0==a.readonly)&&(a.show_lock=!0)}}},[t("div",[a._v(a._s(a.hotelLockType))]),a._v(" "),!a.dataForm.id||a.dataForm.id&&!a.dataForm.mac&&0==a.readonly?t("van-icon",{attrs:{name:"arrow"}}):a._e()],1)]):a.dataForm.id&&!a.dataForm.mac&&1==a.readonly?t("div",{staticClass:"scale_box between",staticStyle:{"margin-top":"10px"}},[t("div",{staticClass:"w6"},[a._v("门锁类型")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.hotelLockType))])])]):a._e(),a._v(" "),!a.dataForm.id||a.dataForm.id&&!a.dataForm.mac&&0==a.readonly?t("div",{staticClass:"scale_box"},[t("div",{staticClass:"w6"},[a._v("装锁方式")]),a._v(" "),a._l(a.lockInstallOldAll,function(o,l){return t("van-radio-group",{key:l,staticClass:"c_00",model:{value:a.lockInstall,callback:function(o){a.lockInstall=o},expression:"lockInstall"}},[t("van-radio",{attrs:{"checked-color":"#ff7d40",name:o.dictLabel}},[a._v(a._s(o.dictLabel))])],1)})],2):a.dataForm.id&&!a.dataForm.mac&&1==a.readonly?t("div",{staticClass:"scale_box between"},[t("div",{staticClass:"w6"},[a._v("装锁方式")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.lockInstall))])])]):a._e(),a._v(" "),!a.dataForm.id||a.dataForm.id&&!a.dataForm.mac&&0==a.readonly?t("div",{staticClass:"scale_box"},[t("div",{staticClass:"w6"},[a._v("开门方式")]),a._v(" "),t("div",{staticClass:"door_box"},a._l(a.doorTypeOldAll,function(o,l){return t("div",{key:l,staticClass:"door_content",class:a.doorType==o.dictLabel?"choosed":"",on:{click:function(t){return a.choosedDoor(o)}}},[t("div",[a._v(a._s(o.dictLabel))])])}),0)]):a.dataForm.id&&!a.dataForm.mac&&1==a.readonly?t("div",{staticClass:"scale_box between"},[t("div",{staticClass:"w6"},[a._v("开门方式")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.doorType))])])]):a._e(),a._v(" "),a.dataForm.id&&a.dataForm.mac&&1==a.readonly?t("div",{staticClass:"scale_box between",staticStyle:{"margin-top":"10px"}},[t("div",{staticClass:"w6"},[a._v("Mac地址")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.dataForm.mac))])])]):a._e(),a._v(" "),a.dataForm.id&&a.dataForm.lockSn&&1==a.readonly?t("div",{staticClass:"scale_box between"},[t("div",{staticClass:"w6"},[a._v("房间二维码")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.dataForm.lockSn))])])]):a._e(),a._v(" "),"5"==a.c_hotelType?t("div",{staticClass:"scale_box",class:a.dataForm.id&&1==a.readonly?"between":""},[t("div",{staticClass:"w6"},[a._v("所属业主")]),a._v(" "),t("div",{staticClass:"flex c_00",on:{click:function(o){(!a.dataForm.id||a.dataForm.id&&0==a.readonly)&&(a.show_person=!0)}}},[t("div",[a._v(a._s(a.landlord||"无"))]),a._v(" "),!a.dataForm.id||a.dataForm.id&&0==a.readonly?t("van-icon",{attrs:{name:"arrow"}}):a._e()],1)]):a._e(),a._v(" "),"无"!=a.landlord&&a.landlord?t("div",[!a.dataForm.id&&"5"==a.c_hotelType||a.dataForm.id&&0==a.readonly&&"5"==a.c_hotelType?t("van-field",{attrs:{type:"number",rules:a.roomMaCommision,readonly:a.readonly,label:"管理提成",placeholder:"请输入管理提成(0-100)"},model:{value:a.dataForm.maCommission,callback:function(o){a.$set(a.dataForm,"maCommission",o)},expression:"dataForm.maCommission"}}):t("div",{staticClass:"scale_box",class:a.dataForm.id&&1==a.readonly?"between":""},[t("div",{staticClass:"w6"},[a._v("管理提成")]),a._v(" "),t("div",{staticClass:"flex c_00"},[t("div",[a._v(a._s(a.dataForm.maCommission))])])])],1):a._e()],1),a._v(" "),a.dataForm.id?a._e():t("van-button",{staticClass:"add_box",attrs:{block:"","native-type":"submit"},on:{click:a.onSubmit}},[a._v("确定新增")]),a._v(" "),a.dataForm.id?t("van-button",{staticClass:"add_box",attrs:{block:"","native-type":"submit"},on:{click:a.onSubmit}},[a._v(a._s(a.buttonContent))]):a._e(),a._v(" "),a.dataForm.id&&!a.dataForm.mac?t("van-button",{staticClass:"add_box remove_box",attrs:{block:"","native-type":"submit"},on:{click:a.removeRoom}},[a._v("删除房间")]):a._e(),a._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:a.show_scale,callback:function(o){a.show_scale=o},expression:"show_scale"}},[t("van-picker",{attrs:{"show-toolbar":"",columns:a.scaleAll},on:{confirm:a.onConfirmScale,cancel:function(o){a.show_scale=!1}}})],1),a._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:a.show_level,callback:function(o){a.show_level=o},expression:"show_level"}},[t("van-picker",{attrs:{"show-toolbar":"",columns:a.levelAll},on:{confirm:a.onConfirmLevel,cancel:function(o){a.show_level=!1}}})],1),a._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:a.show_lock,callback:function(o){a.show_lock=o},expression:"show_lock"}},[t("van-picker",{attrs:{"show-toolbar":"",columns:a.hotelLockTypeAll},on:{confirm:a.onConfirmLock,cancel:function(o){a.show_lock=!1}}})],1),a._v(" "),t("van-popup",{attrs:{position:"bottom"},model:{value:a.show_person,callback:function(o){a.show_person=o},expression:"show_person"}},[t("van-picker",{attrs:{"show-toolbar":"",columns:a.personAll},on:{confirm:a.onConfirmPenson,cancel:function(o){a.show_person=!1}}})],1)],1)},staticRenderFns:[]};var m=t("k6Sl")(n,c,!1,function(a){t("8ThH")},"data-v-01611e12",null);o.default=m.exports}});
//# sourceMappingURL=153.5961fbda06335ffe9dff1758781501818.js.map