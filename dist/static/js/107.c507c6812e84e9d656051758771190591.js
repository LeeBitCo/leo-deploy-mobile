webpackJsonp([107],{NDYv:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("HkQL"),n=s.n(o),a=s("fdz6"),i=s.n(a),c=s("nfjU"),r=s.n(c),u=s("NpYV"),l=s("Gwi0"),m=s("UJbh"),d=s("P5P/"),h=s("RmFe"),p=s.n(h),v={data:function(){var e;return e={realName:"",phone:"",consumeAmount:"",createTime:"",integral:"",headUrl:"",nickName:""},r()(e,"realName",""),r()(e,"consumeNum",""),r()(e,"lastRoomTime",""),r()(e,"idenIds",""),r()(e,"coupons",[]),r()(e,"records",[]),r()(e,"sort",""),r()(e,"showEdit",!1),r()(e,"IdCord",""),r()(e,"showCoupon",!1),r()(e,"memName",""),r()(e,"number",""),r()(e,"price",""),r()(e,"date","选择有效时间段"),r()(e,"showTime",!1),r()(e,"ordertTypeAll",[]),r()(e,"ordertTypeShow",[]),r()(e,"isChecked",!1),r()(e,"selectedData",[]),r()(e,"today",""),r()(e,"scaleName",""),r()(e,"roomSn",""),r()(e,"diffDay",""),e},created:function(){this.$store.commit("setHeader","会员详情");var e=JSON.parse(localStorage.getItem("memberDetail_info"));this.hotelId=d.a.getCookie("currentID"),this.realName=e.sysUser.realName,this.phone=e.sysUser.phone,this.consumeAmount=e.consumeAmount,this.input_consumeAmount=e.consumeAmount,this.createTime=e.createTime,this.integral=e.integral,this.userId=e.userId,this.id=e.id,this.headUrl=e.sysUser.headUrl,this.nickName=e.sysUser.nickName,this.idenIds=e.sysUser.idenIds,this.consumeNum=e.consumeNum?e.consumeNum:"0",this.input_consumeNum=this.consumeNum,this.lastRoomTime=e.lastRoomTime,this.levelName=e.hotelMemberLevel.memberLevelTemplate.levelName,this.getUserCoupon()},methods:{getUserCoupon:function(){var e=this,t={userId:this.userId,hotelId:this.hotelId};Object(l._17)(t).done(function(t){e.getOrderType(),e.coupons=t.data,e.coupons.sort(function(e,t){return e.couponAmount<t.couponAmount?1:-1}),e.coupons.sort(function(e,t){return e.endTime<t.endTime?1:-1})});p()();this.today=p()().format("YYYY-MM-DD")},getOrderType:function(){var e=this;Object(m.a)({dictType:"business_order_type"}).done(function(t){e.ordertTypeAll=t.data;var s={};t.data.forEach(function(e){s[e.dictSort]=e.dictLabel});for(var o=0;o<e.coupons.length;o++)for(var n=e.coupons[o].orderType.split(","),a=0;a<n.length;a++)e.coupons[o].text?e.coupons[o].text+="、"+s[n[a]]:e.coupons[o].text=s[n[a]]})},getMemberRecord:function(){var e=this,t={userId:this.userId,hotelId:this.hotelId};Object(l._17)(t).done(function(t){e.records=t.data});p()();this.today=p()().format("YYYY-MM-DD")},formatDate:function(e){var t=e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate());return this.doble.push(t),this.startTime=this.doble[0],this.endTime=this.doble[1],t},onConfirm:function(e){var t=i()(e,2),s=t[0],o=t[1];this.showTime=!1,this.showCoupon=!0,this.doble=[],this.date=this.formatDate(s)+" 至 "+this.formatDate(o)},sendCouponShow:function(){this.showCoupon=!0,this.sendOrderType()},sendOrderType:function(){var e=this;Object(m.a)({dictType:"business_order_type"}).done(function(t){var s={};t.data.forEach(function(e){s[e.dictSort]=e.dictLabel}),e.ordertTypeAll=t.data})},chooseChange:function(e){this.selectedData.indexOf(e)>-1?this.removeByValue(this.selectedData,e):this.selectedData.push(e),this.selectedData.length<this.ordertTypeAll.total?this.AllChecked=!0:this.AllChecked=!1,this.orderType=this.selectedData.toString()},removeByValue:function(e,t){for(var s=0;s<e.length;s++)if(e[s]==t){e.splice(s,1);break}},checkAll:function(){var e=this,t=this.ordertTypeAll;this.AllChecked?(t.forEach(function(e){e.isChecked=!0}),this.selectedData=[]):t.forEach(function(t){t.isChecked=!1,e.selectedData.indexOf(t.name)<0&&e.selectedData.push(t.name)})},sendCoupon:function(){var e=this;if(!this.memName)return Object(u.Toast)({message:"请输入面额",duration:900}),!1;if(!this.number)return Object(u.Toast)({message:"请输入数量",duration:900}),!1;if(!this.price)return Object(u.Toast)({message:"请输入满减金额",duration:900}),!1;if(!this.startTime)return Object(u.Toast)({message:"请输选择有效时间段",duration:900}),!1;if(!this.orderType)return Object(u.Toast)({message:"请输选择领取范围",duration:900}),!1;var t={couponSource:"2",userId:this.userId,hotelId:this.hotelId,couponAmount:this.memName,fullAmount:this.price,couponNum:this.number,startTime:this.startTime,endTime:this.endTime,orderType:this.orderType};Object(l._84)(t).done(function(t){Object(u.Toast)({message:t.msg,duration:900}),e.getUserCoupon()}),this.showCoupon=!1},editMemberInfo:function(){var e=this;if(!this.input_consumeNum)return Object(u.Toast)({message:"请输入入住间夜",duration:900}),!1;if(!this.input_consumeAmount)return Object(u.Toast)({message:"请输入消费金额",duration:900}),!1;var t={id:this.id,consumeNum:this.input_consumeNum,consumeAmount:this.input_consumeAmount};Object(l._26)(t).done(function(s){Object(u.Toast)({message:s.msg,duration:900});var o=JSON.parse(localStorage.getItem("memberDetail_info"));e.consumeAmount=o.consumeAmount=t.consumeAmount,e.consumeNum=o.consumeNum=t.consumeNum,localStorage.setItem("memberDetail_info",n()(o)),e.showEdit=!1})}}},_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"mem"}},[s("div",{attrs:{id:"members"}},[s("div",{staticClass:"box1"},[s("div",{staticClass:"box1_left"},[s("img",{staticStyle:{width:"30px",height:"30px","margin-right":"10px","border-radius":"20px"},attrs:{src:e.headUrl,alt:""}}),e._v(" "),s("div",[s("p",[s("span",{staticClass:"c_00"},[e._v(e._s(e.nickName))]),e._v(" "),s("span",{staticClass:"c_f60"},[e._v(e._s(e.levelName))])]),e._v(" "),s("p",[s("span",[e._v("积分")]),e._v(" "),s("span",[e._v(e._s(e.integral))])])])]),e._v(" "),s("div",{on:{click:function(t){e.showEdit=!0}}},[e._v("修改>")]),e._v(" "),s("van-popup",{staticClass:"couponBox",model:{value:e.showEdit,callback:function(t){e.showEdit=t},expression:"showEdit"}},[s("div",[s("h2",[e._v("修改会员详情")]),e._v(" "),s("div",[s("van-field",{attrs:{type:"number",label:"入住间夜(天)",placeholder:"请输入入住间夜"},model:{value:e.input_consumeNum,callback:function(t){e.input_consumeNum=t},expression:"input_consumeNum"}}),e._v(" "),s("van-field",{attrs:{type:"number",label:"消费金额(元)",placeholder:"请输入消费金额"},model:{value:e.input_consumeAmount,callback:function(t){e.input_consumeAmount=t},expression:"input_consumeAmount"}})],1),e._v(" "),s("mt-button",{staticClass:"button",on:{click:e.editMemberInfo}},[e._v("保存")])],1)])],1),e._v(" "),s("div",[s("div",{staticClass:"mem_display"},[s("p",{staticClass:"w50"},[s("span",[e._v("真实姓名:")]),e._v(" "),s("span",{staticClass:"c_00"},[e._v(e._s(e.realName))])]),e._v(" "),s("p",{staticClass:"w59"},[s("span",[e._v("身份证号:")]),e._v(" "),s("span",{staticClass:"c_00"},[e._v(e._s(e.idenIds))])])]),e._v(" "),s("div",{staticClass:"mem_display"},[s("p",{staticClass:"w50"},[s("span",[e._v("手机号 :")]),e._v(" "),s("span",{staticClass:"c_00"},[e._v(e._s(e.phone))])]),e._v(" "),s("p",{staticClass:"w59"},[s("span",[e._v("办理时间:")]),e._v(" "),s("span",{staticClass:"c_00"},[e._v(e._s(e.createTime))])])]),e._v(" "),s("div",{staticClass:"mem_display"},[s("p",{staticClass:"w50"},[s("span",[e._v("消费金额(元):")]),e._v(" "),s("span",[e._v(e._s(e.consumeAmount))])]),e._v(" "),s("p",{staticClass:"w59"},[s("span",[e._v("入住间夜(天):")]),e._v(" "),s("span",[e._v(e._s(e.consumeNum))])])]),e._v(" "),s("div",{staticClass:"mem_display"},[s("p",{staticClass:"w50"},[s("span",[e._v("最近入住:")]),e._v(" "),s("span",[e._v(e._s(e.lastRoomTime?e.lastRoomTime:""))])])])])]),e._v(" "),s("div",{attrs:{id:"coupon"}},[s("div",{staticClass:"coupon"},[s("p",{staticClass:"weight"},[e._v("优惠券")]),e._v(" "),s("p",{staticClass:"botton",on:{click:e.sendCouponShow}},[e._v("发券")])]),e._v(" "),s("div",{staticClass:"couponList"},e._l(e.coupons,function(t,o){return s("div",{key:o,staticClass:"times"},[s("div",{staticStyle:{width:"20%"}},[s("span",{staticClass:"c_f60 f12",style:{color:t.endTime<e.today||0!=t.useDefault?"#fab6b6":"#f04d4e"}},[e._v("¥"+e._s(t.couponAmount))]),e._v(" "),s("br"),e._v(" "),t.endTime<e.today?s("span",{style:{color:t.endTime<e.today||0!=t.useDefault?"#b6b6b6":"#f04d4e"}},[e._v("已过期")]):s("span",[e._v(e._s(0==t.useDefault?"未使用":"已使用"))])]),e._v(" "),s("div",[s("span",{staticClass:"f11",style:{color:t.endTime<e.today||0!=t.useDefault?"#b6b6b6":"#2c3e50"}},[e._v("\n            满"+e._s(t.fullAmount)+"可用 \n            "),s("span",{staticClass:"scale",style:{color:t.endTime<e.today||0!=t.useDefault?"#b6b6b6":"#2c3e50"}},[e._v(e._s(t.text)+"可用")])]),e._v(" "),s("br"),e._v(" "),s("span",{style:{color:t.endTime<e.today||0!=t.useDefault?"#b6b6b6":"#2c3e50"}},[e._v(e._s(t.startTime)+" 至 "+e._s(t.endTime))])])])}),0),e._v(" "),s("van-popup",{staticClass:"couponBox",model:{value:e.showCoupon,callback:function(t){e.showCoupon=t},expression:"showCoupon"}},[s("div",[s("h2",[e._v("发送优惠券")]),e._v(" "),s("div",[s("van-field",{attrs:{label:"发送面额",type:"number",placeholder:"请输入面额"},model:{value:e.memName,callback:function(t){e.memName=t},expression:"memName"}}),e._v(" "),s("van-field",{attrs:{label:"发送数量",type:"number",placeholder:"请输入数量"},model:{value:e.number,callback:function(t){e.number=t},expression:"number"}}),e._v(" "),s("van-field",{attrs:{label:"使用门槛",type:"number",placeholder:"满多少金额可使用"},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}}),e._v(" "),s("van-cell",{attrs:{title:"有效期",placeholder:"选择有效时间段",value:e.date},on:{click:function(t){e.showTime=!0,e.showCoupon=!1}}}),e._v(" "),s("div",{attrs:{id:"range"}},[s("div",{staticClass:"receive"},[s("label",[e._v("使用范围")]),e._v(" "),e.ordertTypeAll.length?s("ul",e._l(e.ordertTypeAll,function(t,o){return s("li",{key:o},[s("van-checkbox",{attrs:{value:t.dictLabel,"checked-color":"#ff7d41"},on:{click:function(s){return e.chooseChange(t.dictValue)}},model:{value:t.isChecked,callback:function(s){e.$set(t,"isChecked",s)},expression:"item.isChecked"}},[e._v(e._s(t.dictLabel))])],1)}),0):e._e()])])],1),e._v(" "),s("mt-button",{staticClass:"button",nativeOn:{click:function(t){return e.sendCoupon.apply(null,arguments)}}},[e._v("确定")])],1)]),e._v(" "),s("van-calendar",{attrs:{type:"range"},on:{confirm:e.onConfirm},model:{value:e.showTime,callback:function(t){e.showTime=t},expression:"showTime"}})],1)])},staticRenderFns:[]};var f=s("k6Sl")(v,_,!1,function(e){s("PQg2")},"data-v-45c482e9",null);t.default=f.exports},PQg2:function(e,t){}});
//# sourceMappingURL=107.c507c6812e84e9d656051758771190591.js.map