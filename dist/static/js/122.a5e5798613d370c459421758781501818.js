webpackJsonp([122],{"VRz+":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("HkQL"),i=o.n(a),s=o("UJbh"),n=o("44Rm"),l=o("T6yf"),r=o("s/fh"),c=o("RmFe"),d=o.n(c),u={data:function(){return{lockInfo:[],devInfo:[],materialInfo:[],hotelPhotos:[],businessPhotos:[],idCordPhotos:[],allRooms:[],hotelInfo:null,address:null,value:null,machineType:"请选择型号",airEle:"请选择型号",totalPrice:null,showRooms:!1,allRoomsStatus:!1,showTime:!1,showReject:!1,show_pic:!1,auditFailReason:null,time:null,realAmount:null,dataInfo:null,orderInfo:null,otherInfo:null,role_area:null,c_role:null,open_pic:null,times:[],lockTypes:{},doorInstalls:[],doorTypes:[],addAllRooms:[]}},created:function(){this.$store.commit("setHeader",this.$route.query.type?"编辑申请单":"申请详情"),this.c_role=this.$route.query.role,this.getRoleArea()},methods:{getType:function(){var t=this;Object(s.a)({dictType:"business_lock_install_type"}).done(function(e){t.lockTypesAll=e.data,t.lockTypes={},e.data.map(function(e){t.lockTypes[e.dictValue]=e.dictLabel})}),this.time=d()().year();for(var e=d()().year(),o=0;o<=5;o++)this.times.push(e--)},getRoleArea:function(){var t=this;Object(l.a)({auditApprovalId:this.$route.query.auditApprovalId}).done(function(e){"2"==t.$route.query.applyType?t.orderInfo=e.order:"3"==t.$route.query.applyType&&(t.orderInfo=e.other||"",t.getLockInfo(),t.getType()),t.dataInfo=e.data;var o={auditApprovalId:t.$route.query.auditApprovalId,applyUser:t.dataInfo.applyUser.realName||t.dataInfo.applyUser.nickName||t.dataInfo.applyUser.userName,createTime:t.dataInfo.createTime};localStorage.setItem("auditApprovalInfo",i()(o)),t.role_area=t.orderInfo.contacts+" "+t.orderInfo.phone,t.address=t.orderInfo.province+t.orderInfo.city+t.orderInfo.county;var a={title:"前台照片",icon:t.orderInfo.receptionImage?t.orderInfo.domainName+t.orderInfo.receptionImage:""};t.hotelPhotos.push(a);var s={title:"门头照片",icon:t.orderInfo.frontDoorImage?t.orderInfo.domainName+t.orderInfo.frontDoorImage:""};t.hotelPhotos.push(s);var n={title:"门锁照片",icon:t.orderInfo.lockImage?t.orderInfo.domainName+t.orderInfo.lockImage:""};t.hotelPhotos.push(n);var l={title:"房间照片",icon:t.orderInfo.roomImage?t.orderInfo.domainName+t.orderInfo.roomImage:""};t.hotelPhotos.push(l);var r={title:"营业执照",icon:t.orderInfo.licenseImage?t.orderInfo.domainName+t.orderInfo.licenseImage:""};t.businessPhotos.push(r);var c={title:"消防许可证",icon:t.orderInfo.fireConImage?t.orderInfo.domainName+t.orderInfo.fireConImage:""};t.businessPhotos.push(c);var d={title:"特行证",icon:t.orderInfo.specialImage?t.orderInfo.domainName+t.orderInfo.specialImage:""};t.businessPhotos.push(d);var u={title:"身份证",icon:t.orderInfo.idFrontImage?t.orderInfo.domainName+t.orderInfo.idFrontImage:""};t.businessPhotos.push(u);var v={icon:t.orderInfo.idFrontImage?t.orderInfo.domainName+t.orderInfo.idFrontImage:""};t.idCordPhotos.push(v);var p={icon:t.orderInfo.idBackImage?t.orderInfo.domainName+t.orderInfo.idBackImage:""};t.idCordPhotos.push(p)})},getCurrentInfo:function(){var t=this;Object(n.a)({hotelId:this.$route.query.applyHotelId}).done(function(e){t.hotelInfo=e.data,t.address=t.hotelInfo.province+t.hotelInfo.city+t.hotelInfo.county,t.getLockInfo()})},getLockInfo:function(){var t=this;Object(l.f)({auditApprovalId:this.$route.query.auditApprovalId}).done(function(e){if(e.data){if(t.lockInfo=e.data.lockInfo?JSON.parse(e.data.lockInfo):"",t.lockInfo){var o=[],a=[];t.lockInfo.forEach(function(t){var e=o.indexOf(t.lockType);-1==e?(o.push(t.lockType),a.push({lockType:t.lockType,num:1,price:t.price})):a[e].num++}),t.lockInfo=a}t.devInfo=e.data.devInfo?JSON.parse(e.data.devInfo):"",t.materialInfo=e.data.materialInfo?JSON.parse(e.data.materialInfo):"",t.totalPrice=e.data.totalPrice,t.realAmount=t.$route.query.type?e.data.totalPrice:e.data.realAmount,t.lockInfoInstall={id:e.data.id,lockInfo:e.data.lockInfo,devInfo:e.data.devInfo,materialInfo:e.data.materialInfo,totalPrice:e.data.totalPrice,realAmount:t.realAmount}}})},onConfirmTime:function(t){this.time=t,this.showTime=!1},onConfirm:function(){},openShowRooms:function(){this.showRooms=!0},chooseAllRooms:function(){var t=this;this.addAllRooms.map(function(e){e.status=1!=t.allRoomsStatus}),this.allRoomsStatus=!this.allRoomsStatus},chooseRoom:function(t){this.addAllRooms.map(function(e){e.num==t.num&&(e.status=!e.status)})},choosedRooms:function(){if(0==this.addAllRooms.some(function(t){return 1==t.status}))Object(r.c)("至少选择一个房间号");else{var t=this.addAllRooms.filter(function(t){if(1==t.status)return t.lockType="锁类型",t.orderType="装锁方式",t.openType="开门类型",t});this.allRooms=this.allRooms.concat(t),this.showRooms=!1}},formatter:function(t){return t<0||t>99?(Object(r.c)("请输入0-99之间"),""):t.replace(/^(\-)*(\d+)\.(\d).*$/,"$1$2.$3")},confirmReject:function(t,e){var o=this;if("confirm"==t){if(!this.auditFailReason)return Object(r.c)("请输入驳回原因"),void e(!1);var a={auditApprovalId:this.$route.query.auditApprovalId,auditFailReason:this.auditFailReason};Object(l.j)(a).done(function(t){r.c.success(t.msg),o.showReject=!1,o.auditFailReason=null,setTimeout(function(){o.$router.go(-1)},900),e(!1)}).then(function(t){o.auditFailReason=null,o.showReject=!1,e(!1)})}else"cancel"==t&&(e(!1),this.auditFailReason=null,this.showReject=!1)},commitKeep:function(){},commitApply:function(){var t=this;if(this.$route.query.applyType,"2"==this.$route.query.applyType)this.$router.push({path:"/soft-use",query:{auditApprovalId:this.$route.query.auditApprovalId,hotelName:this.orderInfo.hotelName}});else if("3"==this.$route.query.applyType)if("ROLE_AREA_GM"==this.$route.query.role)Object(l.i)({auditApprovalId:this.$route.query.auditApprovalId}).done(function(e){r.c.success(e.msg),setTimeout(function(){t.$router.go(-1)},900)});else{if(!this.realAmount)return Object(r.c)("请输入合计支付"),!1;this.lockInfoInstall.realAmount=this.realAmount,Object(l.p)(this.lockInfoInstall).done(function(e){Object(l.i)({auditApprovalId:t.$route.query.auditApprovalId}).done(function(e){r.c.success(e.msg),setTimeout(function(){t.$router.go(-2)},900)})})}},seePic:function(t){this.open_pic=t.icon,this.show_pic=!0}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"addEquipment"}},[a("div",[!t.$route.query.type&&t.orderInfo?a("div",{staticClass:"hotel_box"},[a("div",{staticClass:"p10 weight",staticStyle:{"line-height":"30px"}},[t._v("酒店基本信息")]),t._v(" "),a("van-cell-group",[a("van-cell",{attrs:{title:"酒店名称",readonly:""},model:{value:t.orderInfo.hotelName,callback:function(e){t.$set(t.orderInfo,"hotelName",e)},expression:"orderInfo.hotelName"}}),t._v(" "),a("van-cell",{attrs:{title:"酒店地址",readonly:""},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}}),t._v(" "),a("van-cell",{attrs:{title:"美团hos指数",readonly:""},model:{value:t.orderInfo.otaHos,callback:function(e){t.$set(t.orderInfo,"otaHos",e)},expression:"orderInfo.otaHos"}}),t._v(" "),a("van-cell",{attrs:{title:"装修年限",readonly:""},model:{value:t.orderInfo.decorationPeriod,callback:function(e){t.$set(t.orderInfo,"decorationPeriod",e)},expression:"orderInfo.decorationPeriod"}})],1)],1):t._e(),t._v(" "),t.$route.query.type||"2"!=t.$route.query.applyType?t._e():a("div",{staticClass:"hotel_box"},[t.orderInfo?a("van-cell-group",[a("van-cell",{attrs:{title:"联系人",readonly:""},model:{value:t.orderInfo.contacts,callback:function(e){t.$set(t.orderInfo,"contacts",e)},expression:"orderInfo.contacts"}}),t._v(" "),a("van-cell",{attrs:{title:"手机号码",readonly:""},model:{value:t.orderInfo.phone,callback:function(e){t.$set(t.orderInfo,"phone",e)},expression:"orderInfo.phone"}}),t._v(" "),a("van-cell",{attrs:{title:"身份证照片","value-class":"qqqq"}},t._l(t.idCordPhotos,function(e,o){return a("div",{key:o},[a("img",{staticStyle:{width:"50px",height:"50px","margin-left":"10px"},attrs:{src:e.icon},on:{click:function(o){return t.seePic(e)}}})])}),0)],1):t._e()],1),t._v(" "),!t.$route.query.type&&t.hotelPhotos.length>0?a("div",{staticClass:"hotel_box"},[a("div",{staticClass:"p10 weight",staticStyle:{"line-height":"30px"}},[t._v("酒店照片\n      ")]),t._v(" "),a("div",{staticClass:"flex",staticStyle:{"justify-content":"space-around","text-align":"center",padding:"0 0 10px 0"}},t._l(t.hotelPhotos,function(e,i){return a("div",{key:i},[a("div",[e.icon?a("img",{staticClass:"icon60",attrs:{src:e.icon},on:{click:function(o){return t.seePic(e)}}}):a("img",{staticClass:"icon60",attrs:{src:o("1NMU")}}),t._v(" "),a("div",{staticStyle:{"font-size":"12px"}},[t._v(t._s(e.title))])])])}),0)]):t._e(),t._v(" "),!t.$route.query.type&&t.businessPhotos.length>0?a("div",{staticClass:"hotel_box"},[a("div",{staticClass:"p10 weight",staticStyle:{"line-height":"30px"}},[t._v("证件照片\n      ")]),t._v(" "),a("div",{staticClass:"flex",staticStyle:{"justify-content":"space-around","text-align":"center",padding:"0 0 10px 0"}},t._l(t.businessPhotos,function(e,i){return a("div",{key:i},[a("div",[e.icon?a("img",{staticClass:"icon60",attrs:{src:e.icon},on:{click:function(o){return t.seePic(e)}}}):a("img",{staticClass:"icon60",attrs:{src:o("1NMU")}}),t._v(" "),a("div",{staticStyle:{"font-size":"12px"}},[t._v(t._s(e.title))])])])}),0)]):t._e(),t._v(" "),"3"==t.$route.query.applyType&&t.lockInfo.length>0?a("div",{staticClass:"p10"},[t._m(0),t._v(" "),a("div",t._l(t.lockInfo,function(e,o){return a("div",{key:o},[a("div",{staticClass:"flex p10"},[a("div",{staticClass:"w40"},[a("div",[t._v(t._s(t.lockTypes[e.lockType]))]),t._v(" "),a("div",{staticClass:"c_98"},[t._v("¥"+t._s(e.price)+"/套")])]),t._v(" "),a("div",{staticClass:"c_98 w20"},[t._v("x"+t._s(e.num))]),t._v(" "),t.$route.query.type?a("div",{staticClass:"w40 right"},[t._v("¥"+t._s(e.price*e.num)+"\n            ")]):a("div",{staticClass:"w40 right"},[a("div",[t._v("¥"+t._s(e.price*e.num))])])])])}),0)]):t._e(),t._v(" "),"3"==t.$route.query.applyType&&t.devInfo.length>0?a("div",{staticClass:"p10"},[t._m(1),t._v(" "),a("div",t._l(t.devInfo,function(e,o){return a("div",{key:o},["无"!=e.devName?a("div",{staticClass:"flex p10"},[a("div",{staticClass:"w40"},[a("div",[t._v(t._s(e.devName))]),t._v(" "),a("div",{staticClass:"c_98"},[t._v("¥"+t._s(e.price)+"/套")])]),t._v(" "),a("div",{staticClass:"c_98 w20"},[t._v("x"+t._s(e.num))]),t._v(" "),t.$route.query.type?a("div",{staticClass:"w40 right"},[t._v("¥"+t._s(e.price*e.num)+"\n            ")]):a("div",{staticClass:"w40 right"},[a("div",[t._v("¥"+t._s(e.price*e.num))])])]):t._e()])}),0)]):t._e(),t._v(" "),"3"==t.$route.query.applyType&&t.materialInfo.length>0?a("div",{staticClass:"p10"},[t._m(2),t._v(" "),a("div",t._l(t.materialInfo,function(e,o){return a("div",{key:o},[e.price*e.num!="0"?a("div",{staticClass:"flex p10"},[a("div",{staticClass:"w40"},[a("div",[t._v(t._s(e.devName))]),t._v(" "),a("div",{staticClass:"c_98"},[t._v("¥"+t._s(e.price)+"/套")])]),t._v(" "),a("div",{staticClass:"c_98 w20"},[t._v("x"+t._s(e.num))]),t._v(" "),t.$route.query.type?a("div",{staticClass:"w40 right"},[t._v("¥"+t._s(e.price*e.num)+"\n            ")]):a("div",{staticClass:"w40 right"},[a("div",[t._v("¥"+t._s(e.price*e.num))])])]):t._e()])}),0)]):t._e()]),t._v(" "),"3"==t.$route.query.applyType&&t.lockInfo.length>0||t.devInfo.length>0||t.materialInfo.length>0?a("div",{staticClass:"flex totle_box"},[a("div"),t._v(" "),a("div",[t._v("合计: "),a("span",{staticStyle:{color:"red"}},[t._v("¥"+t._s(t.totalPrice))])])]):t._e(),t._v(" "),"3"==t.$route.query.applyType&&t.lockInfo.length>0||t.devInfo.length>0||t.materialInfo.length>0?a("van-field",{staticStyle:{margin:"10px 0 50px 0"},attrs:{type:"number",label:"合计支付",readonly:"ROLE_AREA_GM"==t.c_role,placeholder:"请输入合计金额"},model:{value:t.realAmount,callback:function(e){t.realAmount=e},expression:"realAmount"}}):t._e(),t._v(" "),"2"==t.$route.query.applyType&&t.dataInfo?a("van-cell",{staticStyle:{margin:"10px 0 50px 0"},attrs:{title:"提交时间",readonly:""},model:{value:t.dataInfo.createTime,callback:function(e){t.$set(t.dataInfo,"createTime",e)},expression:"dataInfo.createTime"}}):t._e(),t._v(" "),t.$route.query.role?a("div",{staticClass:"flex bottom_box",staticStyle:{"text-align":"center"}},[a("div",{staticClass:"bottom_l",on:{click:function(e){t.showReject=!0}}},[t._v("驳回")]),t._v(" "),a("div",{staticClass:"bottom_l bottom_r",on:{click:t.commitApply}},[t._v(t._s("2"==t.$route.query.applyType?"下一步":"ROLE_AREA_GM"==t.c_role?"通过申请":"提交区域审批"))])]):t._e(),t._v(" "),a("van-popup",{attrs:{round:"",position:"bottom"},model:{value:t.showTime,callback:function(e){t.showTime=e},expression:"showTime"}},[a("van-picker",{attrs:{title:"时间","show-toolbar":"",columns:t.times},on:{confirm:t.onConfirmTime,cancel:function(e){t.showTime=!1}}})],1),t._v(" "),a("van-popup",{staticStyle:{"line-height":"50px"},attrs:{position:"bottom"},model:{value:t.showRooms,callback:function(e){t.showRooms=e},expression:"showRooms"}},[t.addAllRooms.length>0?a("div",{staticClass:"flex",staticStyle:{"border-bottom":"4px solid #F6F3F6"}},[a("div",{staticClass:"flex",staticStyle:{"padding-left":"120px"}},[a("div",[t._v("选择房间号")]),t._v(" "),a("div",{staticClass:"flex",on:{click:t.chooseAllRooms}},[a("div",{staticStyle:{padding:"0 10px 0 60px"}},[t._v("全选")]),t._v(" "),1==t.allRoomsStatus?a("img",{staticClass:"chooseIcon",attrs:{src:o("g+nT")}}):a("img",{staticClass:"chooseIcon",staticStyle:{opacity:"0.2"},attrs:{src:o("SJ61")}})])])]):t._e(),t._v(" "),t.addAllRooms.length>0?a("div",{staticClass:"room_box_scroll"},t._l(t.addAllRooms,function(e,i){return a("div",{key:i,staticClass:"room_info",on:{click:function(o){return t.chooseRoom(e)}}},[a("div",{staticStyle:{"padding-right":"20px"}},[t._v(t._s(e.num))]),t._v(" "),1==e.status?a("img",{staticClass:"chooseIcon",attrs:{src:o("g+nT")}}):a("img",{staticClass:"chooseIcon",staticStyle:{opacity:"0.2"},attrs:{src:o("SJ61")}})])}),0):a("div",{staticStyle:{color:"red","line-height":"80px"}},[t._v("暂无房间,请帮助酒店新建房间号")]),t._v(" "),a("div",{staticClass:"flex",staticStyle:{"border-top":"4px solid #F6F3F6"}},[a("div",{staticClass:"border_eee",style:{width:t.addAllRooms.length>0?"50%":"100%"},on:{click:function(e){t.showRooms=!1}}},[t._v(t._s(t.addAllRooms.length>0?"取消":"确定"))]),t._v(" "),t.addAllRooms.length>0?a("div",{staticClass:"border_eee",staticStyle:{color:"#f60"},on:{click:t.choosedRooms}},[t._v("确定")]):t._e()])]),t._v(" "),a("van-dialog",{attrs:{"show-cancel-button":"","before-close":t.confirmReject},model:{value:t.showReject,callback:function(e){t.showReject=e},expression:"showReject"}},[a("van-field",{staticStyle:{"text-align":"left"},attrs:{rows:"3",type:"textarea",placeholder:"请简述驳回原因"},model:{value:t.auditFailReason,callback:function(e){t.auditFailReason=e},expression:"auditFailReason"}})],1),t._v(" "),a("van-popup",{staticStyle:{width:"90%",height:"50%"},model:{value:t.show_pic,callback:function(e){t.show_pic=e},expression:"show_pic"}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.open_pic}})])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"top_title"},[e("div",{staticClass:"title_left"},[e("div",{staticClass:"c_title"}),this._v(" "),e("div",{staticClass:"weight"},[this._v("智能门锁")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"top_title"},[e("div",{staticClass:"title_left"},[e("div",{staticClass:"c_title",staticStyle:{background:"#FF7A41"}}),this._v(" "),e("div",{staticClass:"weight"},[this._v("智慧设备")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"top_title"},[e("div",{staticClass:"title_left"},[e("div",{staticClass:"c_title",staticStyle:{background:"#05B96C"}}),this._v(" "),e("div",{staticClass:"weight"},[this._v("物料")])])])}]};var p=o("k6Sl")(u,v,!1,function(t){o("yK7a")},"data-v-2ff34314",null);e.default=p.exports},yK7a:function(t,e){}});
//# sourceMappingURL=122.a5e5798613d370c459421758781501818.js.map