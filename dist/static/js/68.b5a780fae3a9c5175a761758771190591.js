webpackJsonp([68],{BJaz:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("RmFe"),s=o.n(a),i=o("iClD"),n=o("UJbh"),c=o("tN5p"),l=o("TKTC"),r=o("s/fh"),u={data:function(){return{dataForm:{pageNum:0,pageSize:20,cooperId:this.$route.query.cooperId},showForm:{cooperId:this.$route.query.cooperId,amount:null,payeeAccountId:null,payTime:null},listLoading:!1,finishedList:!1,pullLoading:!1,isTurn:!0,listObj:{},listData:[],title:null,payeeAccountLabel:null,cooperRecordTypeAll:[],users:[],maxDate:new Date,minDate:new Date,charge_refund_show:!1,time_show:!1,payeeAccount_show:!1,is_cooperationCharge:!0}},created:function(){this.$store.commit("setHeader","账户余额"),this.is_cooperationCharge=Object(i.isPermission)("business:cooperation:charge")},methods:{arrowTest:function(t){this.listObj[t].isTurn=!this.listObj[t].isTurn},onPullRefresh:function(){this.listData=[],this.dataForm.pageNum=0,this.finishedList=!1,this.onLoadList()},onLoadList:function(){var t=this;Object(l.h)(this.dataForm).done(function(e){if(t.getType(),t.listData=t.listData.concat(e.data),t.listLoading=t.pullLoading=!1,e.total==t.listData.length?t.finishedList=!0:e.total>t.listData.length&&(t.finishedList=!1),t.listData.length>0){var o={};t.listData.sort(function(t,e){return Date.parse(e.payTime)-Date.parse(t.payTime)}),t.listData.map(function(t){var e=s()(t.payTime).format("YYYY-MM");o[e]?o[e].value.push(t):o[e]={value:[t],isTurn:!0}}),t.listObj=o}}),this.dataForm.pageNum++},getType:function(){var t=this;Object(n.a)({dictType:"business_cooper_record_type"}).done(function(e){t.cooperRecordTypeAll={},e.data.map(function(e){t.cooperRecordTypeAll[e.dictValue]=e.dictLabel}),Object(c.q)({hotelId:t.$route.query.hotelId}).done(function(e){t.userOldAll=e.data,t.users=e.data.map(function(t){return t.accountName})})})},openShow:function(t){this.showForm.amount=null,this.showForm.payeeAccountId=null,this.payeeAccountLabel=null,this.title=t,this.showForm.payTime=s()().format("YYYY-MM-DD"),this.minDate=new Date(s()().subtract(3,"month")),this.maxDate=new Date(s()().add(3,"month")),this.charge_refund_show=!0},onConfirmTime:function(t){this.showForm.payTime=s()(t).format("YYYY-MM-DD"),this.time_show=!1},onConfirmUser:function(t){this.payeeAccountLabel=t+">",this.showForm.payeeAccountId=this.userOldAll.find(function(e){return e.accountName==t}).id,this.payeeAccount_show=!1},myCommit:function(){var t=this;this.showForm.payeeAccountId?this.showForm.amount?("充值"==this.title?l.m:l.n)(this.showForm).done(function(e){t.charge_refund_show=!1,Object(r.c)({message:e.msg,duration:900}),t.$route.query.accountAmount=e.data.leftAmount,t.listData=[],t.listObj={},t.dataForm.pageNum=0,setTimeout(t.onLoadList(),1e3)}):Object(r.c)({message:"请输入预收金额",duration:900}):Object(r.c)({message:"请选择收款账户",duration:900})}}},d={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"accountBalance"}},[o("div",{staticClass:"black"},[t.$route.query.accountAmount>0?o("div",{staticClass:"f22"},[t._v(t._s(t._f("point")(t.$route.query.accountAmount,2)))]):o("div",{staticClass:"f22"},[t._v("0")]),t._v(" "),o("div",{staticClass:"f12"},[t._v("账户余额(元)")]),t._v(" "),1==t.is_cooperationCharge?o("div",{staticClass:"flex"},[o("div",{staticClass:"button",on:{click:function(e){return t.openShow("充值")}}},[t._v("充值")]),t._v(" "),o("div",{staticClass:"button",on:{click:function(e){return t.openShow("退款")}}},[t._v("退款")])]):t._e()]),t._v(" "),o("div",[o("van-pull-refresh",{attrs:{"success-text":"刷新成功"},on:{refresh:t.onPullRefresh},model:{value:t.pullLoading,callback:function(e){t.pullLoading=e},expression:"pullLoading"}},[o("van-list",{attrs:{offset:30,finished:t.finishedList,"finished-text":"没有更多了"},on:{load:t.onLoadList},model:{value:t.listLoading,callback:function(e){t.listLoading=e},expression:"listLoading"}},[o("div",{staticClass:"top-title"},[t._v("账户明细")]),t._v(" "),t._l(t.listObj,function(e,a){return o("div",{key:a},[o("div",[o("div",{staticClass:"time-style",on:{click:function(e){return t.arrowTest(a)}}},[o("div",[t._v(t._s(t._f("dataFilter")(a,"YYYY年MM月")))]),t._v(" "),o("van-icon",{attrs:{name:1==e.isTurn?"arrow":"arrow-down"}})],1),t._v(" "),1==e.isTurn?o("div",t._l(e.value,function(e,a){return o("div",{key:a,staticClass:"bb"},[t.cooperRecordTypeAll?o("div",{staticClass:"content-style"},[o("div",[t._v(t._s(t.cooperRecordTypeAll[e.billType])+" "+t._s(t._f("splitRoomSn")(e.roomInfo)))]),t._v(" "),o("div",{style:{color:"1"==e.billType?"#ff7d41":"#000"}},[t._v(t._s("1"==e.billType?"+":"-")+"¥"+t._s(t._f("point")(Math.abs(e.amount),2)))])]):t._e(),t._v(" "),o("div",{staticClass:"content-style c_98"},[o("div",[t._v(t._s(e.payTime))]),t._v(" "),o("div",[t._v("账户余额 "+t._s(t._f("point")(e.leftAmount,2)))])]),t._v(" "),o("div",{staticClass:"content-style c_98"},[o("div"),t._v(" "),o("div",[t._v(t._s(e.payeeAccount))])])])}),0):t._e()])])})],2)],1)],1),t._v(" "),o("van-popup",{staticClass:"show-box",model:{value:t.charge_refund_show,callback:function(e){t.charge_refund_show=e},expression:"charge_refund_show"}},[o("div",{staticClass:"show-box-content"},[o("p",{staticClass:"f16"},[t._v(t._s(t.title))]),t._v(" "),o("div",{staticClass:"pay-room none"},[o("span",[t._v(t._s("充值"==t.title?"到账日期":"退款日期"))]),t._v(" "),o("div",{staticClass:"border"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.showForm.payTime,expression:"showForm.payTime"}],staticClass:"center",attrs:{readonly:"",placeholder:"充值"==t.title?"请选择到账日期":"请选择退款日期",type:"text"},domProps:{value:t.showForm.payTime},on:{click:function(e){t.time_show=!0},input:function(e){e.target.composing||t.$set(t.showForm,"payTime",e.target.value)}}})])]),t._v(" "),o("div",{staticClass:"pay-room none"},[o("span",[t._v(t._s("充值"==t.title?"收款账户":"付款账户"))]),t._v(" "),o("div",{staticClass:"border display",on:{click:function(e){t.payeeAccount_show=!0}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.payeeAccountLabel,expression:"payeeAccountLabel"}],staticClass:"center",attrs:{readonly:"",placeholder:"充值"==t.title?"请选择收款账户":"请选择付款账户",type:"text"},domProps:{value:t.payeeAccountLabel},on:{input:function(e){e.target.composing||(t.payeeAccountLabel=e.target.value)}}}),t._v(" "),o("van-icon",{attrs:{name:"arrow-down"}})],1)]),t._v(" "),o("div",{staticClass:"pay-room none"},[o("span",[t._v(t._s("充值"==t.title?"预收金额":"退款金额"))]),t._v(" "),o("div",{staticClass:"border display"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.showForm.amount,expression:"showForm.amount"}],staticClass:"center",attrs:{placeholder:"充值"==t.title?"请输入预收金额":"请输入退款金额",type:"text"},domProps:{value:t.showForm.amount},on:{input:function(e){e.target.composing||t.$set(t.showForm,"amount",e.target.value)}}})])]),t._v(" "),o("van-button",{staticClass:"show-button",on:{click:t.myCommit}},[t._v("确定")])],1)]),t._v(" "),o("van-calendar",{attrs:{"max-date":t.maxDate,"min-date":t.minDate},on:{confirm:t.onConfirmTime},model:{value:t.time_show,callback:function(e){t.time_show=e},expression:"time_show"}}),t._v(" "),o("van-popup",{staticStyle:{width:"100%"},attrs:{position:"bottom"},model:{value:t.payeeAccount_show,callback:function(e){t.payeeAccount_show=e},expression:"payeeAccount_show"}},[o("van-picker",{attrs:{"show-toolbar":"",columns:t.users},on:{confirm:t.onConfirmUser,cancel:function(e){t.payeeAccount_show=!1}}})],1)],1)},staticRenderFns:[]};var m=o("k6Sl")(u,d,!1,function(t){o("kwoH")},"data-v-835e343c",null);e.default=m.exports},kwoH:function(t,e){}});
//# sourceMappingURL=68.b5a780fae3a9c5175a761758771190591.js.map