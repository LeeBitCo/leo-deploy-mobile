webpackJsonp([65],{"22GU":function(t,e){},IMsz:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("RmFe"),n=i.n(o),a=i("WjM/"),r=i.n(a),s={data:function(){return{show_report:!1,show_time:!1,maxDate:new Date,minDate:new Date,currentDate:new Date,myTime:n()().format("YYYY-MM"),yearsList:[],ymRadio:"1",createTime:null}},watch:{ymRadio:function(t){this.myTime="1"==t?n()().format("YYYY-MM"):n()().format("YYYY")}},created:function(){this.$store.commit("setHeader","报表下载"),localStorage.getItem("c_hotelAll")&&(this.createTime=JSON.parse(localStorage.getItem("c_hotelAll")).find(function(t){return t.id==localStorage.getItem("c_hotelId")}).createTime),this.minDate=new Date(this.createTime);for(var t=n()().diff(n()(this.createTime),"year"),e=0;e<t+1;e++)this.yearsList.push(Number(n()().format("YYYY"))-Number(e))},methods:{goNext:function(t){this.title=null,this.ymRadio="1",this.myTime=n()().format("YYYY-MM"),this.type=t,this.show_report=!0},goNextNoQuery:function(){this.title=null,this.toUrl("/api/business/finance/plat/deposit/export","","平台押金明细")},onConfirmYM:function(t){this.myTime=n()(t).format("YYYY-MM"),this.show_time=!1,this.show_report=!0},onConfirmOnlyY:function(t){this.myTime=t,this.show_time=!1,this.show_report=!0},confirmReport:function(t,e){if("confirm"==t){e(!1);var i=null,o=null,n={};"1"==this.type?(i="/api/business/finance/hotel/"+this.$route.query.hotelId+"/bill/export",o="日租账单下载",n.payTime=this.myTime):"2"==this.type?(i="/api/business/finance/hotel/"+this.$route.query.hotelId+"/month/bill/export",o="长短租账单下载",n.payTime=this.myTime):"3"==this.type?(i="/api/business/finance/hotel/"+this.$route.query.hotelId+"/deposit/export",o="在住押金明细下载",n.payTime=this.myTime):"4"==this.type&&(i="/api/business/finance/hotel/"+this.$route.query.hotelId+"/month/contract/export",o="长短租合同金额",n.orderTime=this.myTime),this.toUrl(i,n,this.myTime+" "+o),this.show_report=!1}else"cancel"==t&&(e(!1),this.show_report=!1)},toUrl:function(t,e,i){r()({method:"post",url:t,params:e,responseType:"arraybuffer"}).then(function(t){var e=t.data,o=window.URL.createObjectURL(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),n=document.createElement("a");n.style.display="none",n.href=o,n.setAttribute("download",i),document.body.appendChild(n),n.click(),document.body.removeChild(n)})}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.$route.query.hotelId?i("div",[i("van-cell",{staticStyle:{"margin-top":"10px"},attrs:{title:"日租账单下载","is-link":""},on:{click:function(e){return t.goNext("1")}}}),t._v(" "),i("van-cell",{attrs:{title:"长短租账单下载","is-link":""},on:{click:function(e){return t.goNext("2")}}}),t._v(" "),i("van-cell",{staticStyle:{"margin-top":"10px"},attrs:{title:"在住押金明细下载","is-link":""},on:{click:function(e){return t.goNext("3")}}}),t._v(" "),i("van-cell",{attrs:{title:"长短租合同金额","is-link":""},on:{click:function(e){return t.goNext("4")}}})],1):i("div",[i("van-cell",{staticStyle:{"margin-top":"10px"},attrs:{title:"平台押金明细","is-link":""},on:{click:t.goNextNoQuery}})],1),t._v(" "),i("van-dialog",{attrs:{title:"下载选择",confirmButtonText:"立即下载",confirmButtonColor:"#ff7d41","show-cancel-button":"","before-close":t.confirmReport},model:{value:t.show_report,callback:function(e){t.show_report=e},expression:"show_report"}},[i("div",{staticClass:"g_radio",staticStyle:{padding:"10px 25px"}},[i("div",{staticStyle:{color:"#646566",width:"70px","text-align":"left"}},[t._v("时间段")]),t._v(" "),i("van-radio-group",{attrs:{"checked-color":"#ff7d41",direction:"horizontal"},model:{value:t.ymRadio,callback:function(e){t.ymRadio=e},expression:"ymRadio"}},[i("van-radio",{attrs:{name:"1"}},[t._v("按月")]),t._v(" "),i("van-radio",{attrs:{name:"2"}},[t._v("按年")])],1)],1),t._v(" "),i("div",{staticClass:"g_radio",staticStyle:{padding:"10px 25px"},on:{click:function(e){t.show_report=!1,t.show_time=!0}}},[i("div",{staticStyle:{color:"#646566",width:"70px","text-align":"left"}},[t._v("日期范围")]),t._v(" "),i("div",[t._v(t._s(t.myTime))])])]),t._v(" "),i("van-popup",{attrs:{position:"bottom"},model:{value:t.show_time,callback:function(e){t.show_time=e},expression:"show_time"}},["1"==t.ymRadio?i("van-datetime-picker",{attrs:{type:"year-month",title:"选择年月","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.onConfirmYM,cancel:function(e){t.show_time=!1}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}}):i("van-picker",{attrs:{title:"选择年","show-toolbar":"",columns:t.yearsList},on:{confirm:t.onConfirmOnlyY,cancel:function(e){t.show_time=!1}}})],1)],1)},staticRenderFns:[]};var c=i("k6Sl")(s,l,!1,function(t){i("22GU")},"data-v-92259c48",null);e.default=c.exports}});
//# sourceMappingURL=65.69f526a2b4874db244e61758781501818.js.map